<html><head/><body>

<title>Chapter 2: Working with H2O Flow (H2O’s Web UI)</title>



<div><div><h1 class="chapter-number" id="_idParaDest-33"><a id="_idTextAnchor038"/> 2</h1>
<h1 id="_idParaDest-34"><a id="_idTextAnchor039"/>使用H2O流(H2O的网络用户界面)</h1>
<p><strong class="bold">机器学习</strong> ( <strong class="bold"> ML </strong>)不仅仅是代码。它包括从不同角度进行的大量观察。尽管实际的编码非常强大，但是在你编码的终端后面隐藏了很多信息。人类总是比文字更容易理解图片。类似地，尽管ML很复杂，但借助交互式用户界面<strong class="bold"/>(<strong class="bold">ui</strong>)的帮助，它可以非常容易和有趣地实现<a id="_idIndexMarker102"/>。当学习困难的主题时，在单调的黑白像素化终端上使用彩色用户界面总是有利的。</p>
<p><strong class="bold"> H2O流</strong>是由H2O.ai团队开发的基于网络的UI。这个<a id="_idIndexMarker103"/>接口与我们在<a href="B17298_01.xhtml#_idTextAnchor017"> <em class="italic">第一章</em> </a>、<em class="italic">了解H2O汽车基础知识</em>中了解到的后端是一样的。它只是一个包装在主H2O库上的web UI，传递输入，触发后端服务器上的函数，并通过将结果显示给用户来读取结果。</p>
<p>在这一章中，我们将学习如何使用H2O流。我们将执行ML管道的所有典型步骤，我们在第1章<a href="B17298_01.xhtml#_idTextAnchor017"><em class="italic"/></a>、<em class="italic">了解H2O AutoML基础知识</em>的<em class="italic">了解AutoML和H2O AutoML </em>部分中了解了这些步骤，从读取数据集到使用训练好的模型进行预测。此外，我们将探索一些指标和模型细节，以帮助我们稍后轻松进入更高级的主题。本章是实践操作，我们将在创建ML管道时了解H2O流程的各个部分。</p>
<p>本章结束时，你将能够导航和使用H2O流的各种功能。此外，您将能够训练您的ML模型并将其用于预测，而无需使用H2O流编写一行代码。</p>
<p>在本章中，我们将讨论以下主题:</p>
<ul>
<li>了解H2O流的基础知识</li>
<li>在H2O流中使用数据函数</li>
<li>在H2O流程中使用模型训练函数</li>
<li>在H2O流中使用预测函数</li>
</ul>
<h1 id="_idParaDest-35"><a id="_idTextAnchor040"/>技术要求</h1>
<p>您将需要以下内容:</p>
<ul>
<li>一个像样的网络浏览器(Chrome、Firefox或Edge)，您首选的网络浏览器的最新版本。</li>
</ul>
<h1 id="_idParaDest-36"><a id="_idTextAnchor041"/>了解H2O流程的基础知识</h1>
<p>H2O流是一个开源的web界面<a id="_idIndexMarker104"/>，它帮助用户在一个叫做<strong class="bold">流笔记本</strong>或简称<strong class="bold">流</strong>的页面上执行代码、绘制图表和显示<a id="_idIndexMarker105"/>数据帧。</p>
<p>Jupyter笔记本的用户会发现H2O流非常相似。您在单元格中编写可执行代码，当您执行该单元格时，代码的输出会显示在它的下方。然后，光标移动到下一个单元格。流最好的一点是，它可以很容易地在不同用户之间保存、导出和导入。这有助于许多数据科学家在各种利益相关者之间共享结果，因为他们只需要保存执行结果并共享流程。</p>
<p>在下面的小节中，我们将了解H2O流的基础知识。让我们从H2O流开始我们的旅程，首先，将它下载到我们的系统。</p>
<h2 id="_idParaDest-37"><a id="_idTextAnchor042"/>下载并启动H2O流量</h2>
<p>为了运行H2O流，您将<a id="_idIndexMarker106"/>需要首先将<a id="_idIndexMarker107"/>H2O流<strong class="bold"> Java归档</strong> ( <strong class="bold"> JAR </strong>)文件下载到您的系统上，然后在下载完成后运行<a id="_idIndexMarker108"/>JAR文件。</p>
<p>您可以使用以下步骤下载并启动H2O流程:</p>
<ol>
<li>你可以在<a href="https://h2o-release.s3.amazonaws.com/h2o/master/latest.xhtml">https://H2O-release . S3 . Amazon AWS . com/H2O/master/latest . XHTML</a>下载<a id="_idIndexMarker109"/> H2O流。</li>
<li>下载完ZIP文件后，打开终端，在下载ZIP文件的文件夹中运行以下命令:<pre><strong class="bold">unzip {name_of_the_h2o_zip_file}</strong></pre></li>
<li>要运行H2O流，在最近解压缩的<code>h2o</code>文件的文件夹中运行以下命令:<pre><strong class="bold">java -jar h2o.jar</strong></pre></li>
</ol>
<p>这将在<a href="http://localhost:54321"> http://localhost:54321 </a>上启动一个H2O Web UI。</p>
<p>现在我们已经下载了<a id="_idIndexMarker110"/>并启动了H2O流，让我们简单地探索一下它，让<a id="_idIndexMarker111"/>了解它所提供的功能。</p>
<h2 id="_idParaDest-38"><a id="_idTextAnchor043"/>探索H2O流</h2>
<p>H2O流是一个功能非常密集的<a id="_idIndexMarker112"/>应用。它几乎拥有创建ML管道所需的所有特性。考虑到ML管道中涉及的各种步骤，H2O流为所有这些步骤提供了大量的功能。这对很多人来说是难以承受的。因此，探索应用程序并一次关注一个应用程序的特定部分是值得的。</p>
<p>在下面的章节中，我们将详细了解所有这些部分；但是，有些函数可能太复杂，现阶段无法理解。我们将在接下来的章节中更好地理解它们。目前，我们将重点了解如何使用H2O流来创建ML管道。</p>
<p>因此，让我们从探索开始，首先，启动H2O流并在<a href="http://localhost:54321">http://localhost:54321</a>URL打开您的web浏览器。</p>
<p>以下屏幕截图显示了H2O流程UI的主页:</p>
<div><div><img alt="Figure 2.1 – The main page of the H2O Flow UI&#10;&#10;" height="913" src="img/B17298_02_001.jpg" width="1634"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.1–H2O流程用户界面的主页</p>
<p>如果您看到<a id="_idIndexMarker113"/>略有不同，请不要惊慌。这可能是因为您安装的版本可能与本书中显示的版本不同。然而，UI的基本设置应该是相似的。如你所见，有大量的交互选项可供选择。这一开始可能有点让人不知所措，所以让我们一点一点来。</p>
<p>在网页的最顶端，有各种ML对象操作，每一个都有自己的下拉函数列表。它们如下:</p>
<ul>
<li><strong class="bold">流程</strong>:该部分包含所有与流程笔记本相关的操作。</li>
<li><strong class="bold">单元格</strong>:此部分包含与笔记本中各个单元格相关的所有操作。</li>
<li><strong class="bold">数据</strong>:该部分包含所有与数据操作相关的操作。</li>
<li><strong class="bold">模型</strong>:该部分包含所有与模型训练和算法相关的操作。</li>
<li><strong class="bold">评分</strong>:该部分包含所有与评分和预测相关的操作。</li>
<li><strong class="bold">管理</strong>:此部分包含所有管理操作，如下载日志。</li>
<li><strong class="bold">帮助</strong>:此部分包含所有链接到H2O文档的其他详细信息。</li>
</ul>
<p>一旦我们稍后开始创建ML管道，我们将一步一步地更详细地研究它们。</p>
<p>以下截图显示了H2O流程UI的各种ML函数操作:</p>
<div><div><img alt="Figure 2.2 – The ML object operation toolbar&#10;&#10;" height="83" src="img/B17298_02_002.jpg" width="1337"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.2–ML对象操作工具栏</p>
<p>接下来是<strong class="bold">流程名称</strong>和<strong class="bold">流程工具栏</strong>设置。默认情况下，流名称将为<strong class="bold">无标题流</strong>。流程名称有助于识别整个流程，这样您就不会混淆不同的实验。<strong class="bold">流程工具栏</strong>部分是一个简单的工具栏，帮助您进行基本操作，如编辑和管理流程中的单元格。</p>
<p>下面的屏幕截图显示了主页上的流工具栏:</p>
<div><div><img alt="Figure 2.3 – The Flow Name and flow toolbar sections&#10;&#10;" height="138" src="img/B17298_02_003.jpg" width="1149"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.3–流程名称和流程工具栏部分</p>
<p><strong class="bold">单元格</strong>是代码执行行，您可以<a id="_idIndexMarker115"/>逐个执行。它们也可以用来做注释、标题，甚至是减价文本。</p>
<p>这些工具如下所列。我们将从左至右开始:</p>
<ul>
<li><strong class="bold">新建</strong>:新建一个流笔记本。</li>
<li><strong class="bold">打开</strong>:这将打开存储在您系统中的现有流程笔记本。</li>
<li><strong class="bold">保存</strong>:保存你当前的流量。</li>
<li><strong class="bold">插入单元格</strong>:在下方插入一个单元格。</li>
<li><strong class="bold">上移</strong>:将当前高亮显示的单元格上移至上述单元格之上。</li>
<li><strong class="bold">下移</strong>:将当前高亮显示的单元格移动到其下单元格的下方。</li>
<li><strong class="bold">剪切</strong>:剪切单元格并存储在剪贴板上。</li>
<li><strong class="bold">复制</strong>:复制当前高亮显示的单元格。</li>
<li><strong class="bold">粘贴</strong>:将之前复制的单元格粘贴到当前高亮显示的单元格下方。</li>
<li><strong class="bold">清除单元格</strong>:如果有单元格输出，则清除单元格输出。</li>
<li><strong class="bold">删除单元格</strong>:删除整个单元格。</li>
<li><strong class="bold">运行并选择下方</strong>:运行当前高亮显示的单元格，并在下方单元格处停止。</li>
<li><strong class="bold">运行</strong>:运行当前高亮显示的单元格。</li>
<li><strong class="bold">运行所有</strong>:从上到下逐一运行所有单元格。</li>
<li><strong class="bold">协助我</strong>:这执行一个协助命令，通过显示基本ML命令的链接来帮助你。</li>
</ul>
<p>在流程的右侧<a id="_idIndexMarker116"/>是帮助您管理工作流程的附加支持选项。你有<strong class="bold">大纲</strong>、<strong class="bold">流</strong>、<strong class="bold">剪辑</strong>、<strong class="bold">助</strong>。每个选项都有自己的功能详细信息栏。</p>
<p>以下屏幕截图显示了H2O流程UI的各种支持选项:</p>
<div><div><img alt="Figure 2.4 – Support options&#10;&#10;" height="57" src="img/B17298_02_004.jpg" width="571"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.4–支持选项</p>
<p><strong class="bold"> OUTLINE </strong>列显示了您执行的所有执行的列表。查看大纲有助于您快速检查创建ML管道时执行的所有步骤是否顺序正确，是否有任何重复，或者是否有任何不正确的步骤。</p>
<p>以下截图显示了<strong class="bold">概要</strong>支持选项部分:</p>
<div><div><img alt="Figure 2.5 – OUTLINE&#10;&#10;" height="160" src="img/B17298_02_005.jpg" width="409"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.5–轮廓</p>
<p><strong class="bold">流程</strong>栏显示<a id="_idIndexMarker117"/>您之前保存的所有流程。目前，您还没有，但是一旦您保存了一个流，它就会显示在这里，并带有一个打开它的快速链接。请注意，在H2O流程页面上，一次只能打开一个流程笔记本。如果您想要同时处理多个流，您可以通过打开另一个选项卡并在那里打开“流”记事本来实现。</p>
<p>以下截图显示了<strong class="bold">流程</strong>支持选项部分:</p>
<div><div><img alt="Figure 2.6 – Saved flows&#10;&#10;" height="256" src="img/B17298_02_006.jpg" width="359"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.6–保存的流量</p>
<p><strong class="bold">剪辑</strong>栏是你的剪贴板。如果有任何要执行的代码，您将在流程中运行多次，那么您可以编写一次，并通过选择单元格右侧的回形针图标将其保存到剪贴板。然后，您可以在需要时粘贴该单元格，而不需要在流程中搜索它。剪贴板还存储了一定数量的废纸篓。</p>
<p>以下截图显示了<strong class="bold">夹</strong>支持选项部分:</p>
<div><div><img alt="Figure 2.7 – Clipboard&#10;&#10;" height="711" src="img/B17298_02_007.jpg" width="359"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.7–剪贴板</p>
<p><strong class="bold">帮助</strong>栏显示各种<a id="_idIndexMarker118"/>资源，帮助用户使用H2O流。这包括快速入门视频、示例流程、一般使用示例以及官方文档的链接。请随意探索这些，以了解如何使用H2O流。</p>
<p>以下截图显示了<strong class="bold">帮助</strong>支持选项部分:</p>
<div><div><img alt="Figure 2.8 – The Help section&#10;&#10;" height="704" src="img/B17298_02_008.jpg" width="314"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.8–帮助部分</p>
<p>回到页面顶部，让我们探索一下<a id="_idIndexMarker119"/>前两个下拉列表。它们简单易懂。</p>
<p>下面的屏幕截图显示了操作的第一个下拉列表，即流对象操作:</p>
<div><div><img alt="Figure 2.9 – The Flow functions drop-down list&#10;&#10;" height="637" src="img/B17298_02_009.jpg" width="362"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.9–流函数下拉列表</p>
<p><strong class="bold">流程</strong>操作下拉列表具有流程笔记本的基本功能。您可以创建<a id="_idIndexMarker120"/>一个新的流，打开一个现有的流，保存、复制、运行流中的所有单元，清除输出，以及下载流。下载流是非常有用的，因为您可以很容易地将您的ML工作从流转移到其他系统。</p>
<p>右边是<strong class="bold">单元格</strong>对象操作下拉列表(如图<em class="italic">图2.10 </em>)。这个下拉列表也很容易理解。它具有操纵流中各种单元的基本功能。通常，它的目标是流笔记本中高亮显示的单元格。您可以通过点击来更改高亮显示的单元格:</p>
<div><div><img alt="Figure 2.10 – The Cell functions drop-down list&#10;&#10;" height="534" src="img/B17298_02_010.jpg" width="239"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.10–单元格功能下拉列表</p>
<p>我们将在开始ML管道工作时探索其他选项。</p>
<p>在本节中，我们了解了什么是H2O流，如何下载它，以及如何在本地启动它。此外，我们探索了<a id="_idIndexMarker121"/>H2O流程用户界面的各个部分及其提供的各种功能。现在我们已经熟悉了我们的环境，让我们更深入地研究并创建我们的ML管道。我们先从流水线的第一部分开始，也就是手<a id="_idTextAnchor044"/> <a id="_idTextAnchor045"/>凌数据。</p>
<h1 id="_idParaDest-39"><a id="_idTextAnchor046"/>在H2O流程中使用数据功能</h1>
<p>ML流水线总是从数据开始。当训练最高质量的模型时，您收集的数据量和数据质量<a id="_idIndexMarker123"/>起着非常关键的作用。如果数据的一部分与数据的另一部分没有关系，或者如果有许多对所述关系没有贡献的噪声数据，则模型的质量将相应地降低。因此，在训练任何模型之前，我们通常在将数据发送到模型训练之前对数据执行几个过程。H2O流程在其<strong class="bold">数据</strong>操作下拉列表中为所有这些流程提供接口。</p>
<p>当我们使用H2O流构建ML管道时，我们将逐步理解各种数据操作和输出结果。</p>
<p>因此，让我们开始创建ML管道，首先，导入一个数据集。</p>
<h2 id="_idParaDest-40"><a id="_idTextAnchor047"/>导入数据集</h2>
<p>我们将在本章中使用的数据集<a id="_idIndexMarker124"/>将是<code>Heart Failure Prediction</code>数据集。你可以在https://www.kaggle.com/fedesoriano/heart-failure-prediction的<a href="https://www.kaggle.com/fedesoriano/heart-failure-prediction">找到心力衰竭预测数据集的细节。</a></p>
<p>这是一个数据集，包含关于胆固醇、最大心率、胸痛和其他属性的个人的某些健康信息，这些属性是一个人是否可能经历心力衰竭的重要指标。</p>
<p>让我们了解一下数据集的内容:</p>
<ul>
<li><strong class="bold">年龄</strong>:患者的年龄，以年为单位</li>
<li><strong class="bold">性别</strong>:患者的性别；m代表男性，F代表女性</li>
<li><strong class="bold">chest paint type</strong>:<ul><li>这些类型如下所示:<ul><li><strong class="bold"> TA </strong>:典型心绞痛</li><li><strong class="bold"> ATA </strong>:非典型心绞痛</li><li><strong class="bold">午睡</strong>:非心绞痛</li><li>ASY:无症状</li></ul></li></ul></li>
<li><strong class="bold">静息血压</strong>:静息血压单位为[毫米汞柱]</li>
<li><strong class="bold">胆固醇</strong>:血清胆固醇[mm/dl]</li>
<li><strong class="bold">空腹血糖</strong>:空腹血糖，大于120 mg/dl为1，否则为0</li>
<li><strong class="bold">静息心电图</strong>:静息心电图结果<ul><li>这些类型如下所示:<ul><li><strong class="bold">正常</strong>:正常</li><li><strong class="bold">ST</strong>:ST-T波异常</li><li><strong class="bold"> LVH </strong>:根据Estes标准显示可能或明确的左心室肥大</li></ul></li></ul></li>
<li><strong class="bold"> MaxHR </strong>:达到的最大心率值，介于60和202之间</li>
<li><strong class="bold">运动性心绞痛</strong>:运动性心绞痛；y代表是，N代表否</li>
<li><strong class="bold"> Oldpeak </strong> : ST(在低压下测量的数值)</li>
<li><strong class="bold"> ST_Slope </strong>:运动ST段峰值的斜率<ul><li>这些类型如下:<ul><li><strong class="bold">向上</strong>:向上倾斜</li><li><strong class="bold">扁平</strong>:扁平</li><li><strong class="bold">向下</strong>:向下倾斜</li></ul></li></ul></li>
<li><strong class="bold">心脏病</strong>:输出类，1表示心脏病，0表示无心脏病</li>
</ul>
<p>我们将训练一个模型，通过使用这个数据集来尝试<a id="_idIndexMarker125"/>预测一个具有某些属性的人是否有可能面临心力衰竭。执行以下步骤:</p>
<ol>
<li value="1">首先，让我们从使用H2O流导入这个数据集开始。</li>
<li>在web UI的最顶端，您可以看到<strong class="bold">数据</strong>对象操作下拉列表。</li>
<li>单击它，web UI应该会显示类似于以下屏幕截图的输出:</li>
</ol>
<div><div><img alt="Figure 2.11 – The Data object drop-down list&#10;&#10;" height="448" src="img/B17298_02_011.jpg" width="347"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.11–数据对象下拉列表</p>
<p>下拉列表向<a id="_idIndexMarker126"/>您显示了您可以执行的各种操作的列表，以及与您将使用的数据相关的操作。</p>
<p>这些功能如下所示:</p>
<ul>
<li><strong class="bold">导入文件</strong>:该操作导入存储在您系统中的文件。它们可以是以<strong class="bold">逗号分隔值</strong> ( <strong class="bold"> CSV </strong>)格式或Excel格式编辑的任何可读文件。</li>
<li><strong class="bold">导入SQL表</strong>:如果您使用SQL数据库<a id="_idIndexMarker127"/>存储任何表格数据，此操作允许您导入存储在您的<strong class="bold">结构化查询语言</strong> ( <strong class="bold"> SQL </strong>)表中的数据。当您点击它时，系统会提示您将<strong class="bold">连接URL </strong>值输入到您的SQL数据库，同时输入其凭证、<strong class="bold">表</strong>名称、<strong class="bold">列</strong>名称，以及一个选择<strong class="bold">获取模式</strong>的选项，该模式可以是<strong class="bold">分布式</strong>或<strong class="bold">单个</strong>，如下面的截图所示:</li>
</ul>
<div><div><img alt="Figure 2.12 – Import SQL Table&#10;&#10;" height="354" src="img/B17298_02_012.jpg" width="763"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.12-导入SQL表</p>
<ul>
<li><strong class="bold">上传文件</strong>:该操作从您的系统上传一个文件<a id="_idIndexMarker128"/>并立即解析。</li>
<li><strong class="bold">分割帧</strong>:该操作将已经被H2O流导入并解析的数据帧分割成多个帧，可以用于多个实验。</li>
<li><strong class="bold">合并帧</strong>:该操作将多个帧合并为一帧。当你点击它的时候，会提示你选择右边和左边的框架以及它们各自的列。此外，您可以灵活地选择将哪个框架中的哪些行包含在合并中，如下面的屏幕截图所示:</li>
</ul>
<div><div><img alt="Figure 2.13 – Merge Frames&#10;&#10;" height="372" src="img/B17298_02_013.jpg" width="476"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.13–合并框架</p>
<ul>
<li><strong class="bold">列出帧</strong>:该操作列出了H2O当前导入并解析的所有帧。如果您想要在先前由您导入或拼接的不同数据集上运行管道，这将很有帮助。</li>
<li><strong class="bold">估算</strong>:估算是用平均值替换数据集中缺失值的过程，这样就不会引入任何最小值、最大值甚至空值的偏差。此操作允许您根据自己的喜好替换框架中的这些值。</li>
</ul>
<p>所以，首先，让我们导入<code>Heart Failure Prediction</code>数据集。</p>
<p>执行<a id="_idIndexMarker129"/>以下步骤:</p>
<ol>
<li value="1">点击<strong class="bold">数据</strong>操作下拉列表。</li>
<li>点击<strong class="bold">导入文件… </strong>。您应该看到对流程中的单元执行的操作，如下面的屏幕截图所示:</li>
</ol>
<div><div><img alt="Figure 2.14 – Import Files&#10;&#10;" height="220" src="img/B17298_02_014.jpg" width="536"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.14-导入文件</p>
<p>您也可以通过在单元格中键入<code>importFiles</code>并按下<em class="italic"> Shift </em> + <em class="italic"> Enter </em>来直接运行相同的命令，而不是使用下拉列表。</p>
<ol>
<li value="3">在搜索栏中，添加下载数据集的文件夹的位置。</li>
<li>点击最右侧的搜索按钮。这将显示文件夹中的所有文件，您可以选择要导入的文件。</li>
<li>选择<code>heart.csv</code>数据集，如下图所示:</li>
</ol>
<div><div><img alt="Figure 2.15 – Importing files with inputs&#10;&#10;" height="313" src="img/B17298_02_015.jpg" width="850"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.15–导入带有输入的文件</p>
<ol>
<li value="6">选择文件后，点击<strong class="bold">导入</strong>按钮。然后，H2O将导入数据集并向您显示输出，如下所示:</li>
</ol>
<div><div><img alt="Figure 2.16 – The imported files &#10;&#10;" height="196" src="img/B17298_02_016.jpg" width="1000"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.16–导入的文件</p>
<p>恭喜你！您现在已经成功地<a id="_idIndexMarker130"/>将您的数据集导入到H2O流中。下一步是将其解析成逻辑格式。让我们来了解一下什么是解析，以及如何在H2O流中进行解析。</p>
<h2 id="_idParaDest-41"><a id="_idTextAnchor048"/>解析数据集</h2>
<p><strong class="bold">解析</strong>是分析数据集中的信息字符串<a id="_idIndexMarker131"/>并将其加载到逻辑<a id="_idIndexMarker132"/>格式的过程，在本例中，是一个<strong class="bold">十六进制</strong>文件。十六进制文件是其<a id="_idIndexMarker133"/>内容以十六进制格式存储的文件。H2O在内部使用这种文件类型进行数据帧操作，并维护数据集的元数据。</p>
<p>让我们通过执行以下步骤来解析新导入的数据集:</p>
<ol>
<li value="1">导入数据集后，点击<strong class="bold">解析这些文件… </strong>按钮，如图<em class="italic">图2.16 </em>所示。</li>
</ol>
<p>下面的屏幕截图显示了您应该期望的输出:</p>
<div><div><img alt="Figure 2.17 – The dataset parsing inputs&#10;&#10;" height="443" src="img/B17298_02_017.jpg" width="1245"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.17–数据集解析输入</p>
<ol>
<li value="2">然后，会提示您输入<code>hex</code>文件。在解析过程中，您有以下配置可供选择:<ul><li><strong class="bold"> Sources </strong>:这个配置表示您将要解析的数据集的来源。</li><li><strong class="bold"> ID </strong>:该配置表示数据集的ID。您可以更改将要创建的十六进制文件的ID。</li><li><strong class="bold">解析器</strong>:这个配置设置用于解析数据集的解析器。您将使用不同的解析器来解析不同类型的数据集。例如，如果您正在解析一个拼花文件，那么您将需要选择拼花文件解析器。在我们的例子中，我们正在解析一个CSV文件；因此，选择<strong class="bold"> CSV </strong>解析器。您也可以将它设置为<strong class="bold"> AUTO </strong>，H2O会自动识别需要哪个解析器来解析指定的文件。</li><li><strong class="bold">分隔符</strong>:该配置用于指定分隔数据集中值的分隔符。让我们保留默认值，<strong class="bold">，:‘004’</strong>，这是一个非常常见的CSV分隔符值。</li><li><strong class="bold">转义字符</strong>:该配置用于指定数据集中使用的转义字符。让我们保留默认值。</li><li><strong class="bold">列头</strong>:该配置用于指定数据集的第一行是否包含列名。H2O将使用该信息来处理第一个<a id="_idIndexMarker135"/>行，或者将其用作列信息，或者自动生成列名并将第一行用作数据值。此外，您可以将值设置为<strong class="bold"> Auto </strong>，让H2O自行确定数据集的第一行是否包含列名。我们的数据集将第一行作为列名，所以我们选择<strong class="bold">第一行包含列名</strong>。</li><li><strong class="bold">选项</strong>:该配置包含如下附加操作:<ul><li><strong class="bold">启用单引号作为字段引用字符</strong>:该选项启用单引号作为字段引用字符。</li><li><strong class="bold">完成后删除</strong>:该选项在成功解析导入的数据集后将其删除。让我们勾选这个选项，因为一旦我们成功解析了导入的数据集，我们就不再需要它了。</li></ul></li></ul></li>
<li>在<strong class="bold">解析配置</strong>部分下面，有<strong class="bold">编辑列名和类型</strong>部分(参见<em class="italic">图2.18 </em>)。在解析数据集之前，H2O阅读了数据集，并向您展示了列名和它们提取的信息类型的简短摘要。这为您提供了编辑列名和类型的选项，以防它错误地解释了某些内容，或者如果您希望将列名更改为其他内容。</li>
</ol>
<p>以下屏幕截图显示了解析数据集时的列名和编辑列类型的选项:</p>
<div><div><img alt="Figure 2.18 – Editing the column types&#10;&#10;" height="479" src="img/B17298_02_018.jpg" width="1238"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.18–编辑列类型</p>
<p>现在，让我们简单了解一下<a id="_idIndexMarker136"/>列的类型，如前面的截图所示:</p>
<p>它们可以列举如下:</p>
<ul>
<li><strong class="bold">数字</strong>:表示该列中的值是数字。</li>
<li><strong class="bold">枚举</strong>:表示该列中的值是<strong class="bold">枚举类型</strong> ( <strong class="bold">枚举</strong>)。枚举是一组指定的<a id="_idIndexMarker137"/>值，它们本质上是非数字的和有限的。</li>
<li><strong class="bold"> Time </strong>:表示列中的值为datetime数据类型值。</li>
<li><strong class="bold"> UUID </strong>:表示<a id="_idIndexMarker138"/>列中的值是<strong class="bold">通用唯一标识符</strong>(<strong class="bold">uuid</strong>)。</li>
<li><strong class="bold">字符串</strong>:表示该列中的值为字符串值。</li>
<li><strong class="bold">无效</strong>:这表示该列中的值无效，意味着该列中的值存在一些问题。</li>
<li><strong class="bold">未知</strong>:这表示该列中的值是未知的，这意味着该列不包含任何值。</li>
</ul>
<p>在训练过程中，H2O根据数据帧的类型对数据帧的列进行不同的处理。有时，它会曲解<a id="_idIndexMarker139"/>列的值，并给列分配不正确的列类型。看一下数据集的列及其对应的类型。您可能会注意到，导入数据集后，我们的<strong class="bold"> HeartDisease </strong>输出列的类型是<strong class="bold"> Numeric </strong>。H2O读取1和0，并假设其类型为数字。但它实际上是一个<strong class="bold">枚举</strong>值，因为1表示心脏病，0表示没有心脏病。两者之间没有数值。我们在解析数据集时总是需要小心。在我们开始对数据集进行模型训练之前，我们需要确保H2O正确地解释了数据集。H2O流提供了一种简单的方法来在解析之前纠正这个问题。</p>
<p>接下来，让我们更正列类型:</p>
<ol>
<li value="1">选择<strong class="bold">心脏病</strong>栏名称旁边的下拉列表，并将其设置为<strong class="bold">枚举</strong>。</li>
<li>同样，<strong class="bold"> FastingBS </strong>会被设置为<strong class="bold">数值</strong>，但实际上根据其描述是一个<strong class="bold">枚举</strong>值。所以，我们把它设为<strong class="bold"> Enum </strong>。</li>
<li>既然我们已经更正了列类型并选择了正确的解析配置，那么让我们来解析数据集。点击输出底部的<strong class="bold">解析</strong>按钮。</li>
</ol>
<p>下面的屏幕截图显示了解析后的输出:</p>
<div><div><img alt="Figure 2.19 – Parsing the output&#10;&#10;" height="640" src="img/B17298_02_019.jpg" width="1379"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.19-解析输出</p>
<p>现在，让我们观察从前面的截图中得到的输出<a id="_idIndexMarker140"/>:</p>
<ul>
<li>运行时间:这个输出显示了从H2O开始解析数据集以来的运行时间。</li>
<li><strong class="bold">剩余时间</strong>:这个输出显示了H2O完成数据集解析的预期剩余时间。</li>
<li><strong class="bold"> Type </strong>:这个输出显示了解析后的文件的类型。</li>
<li><strong class="bold">键</strong>:这个输出显示了一个十六进制文件的链接，它是在成功解析后生成的。</li>
<li><strong class="bold">描述</strong>:该输出显示当前正在执行的操作。</li>
<li><strong class="bold">状态</strong>:该输出显示操作的当前状态。</li>
<li><strong class="bold">进度</strong>:该输出显示操作的进度条。</li>
<li><strong class="bold">动作</strong>:这个输出是一个按钮，显示成功解析数据集后生成的十六进制文件。</li>
</ul>
<p>恭喜你！您已经成功解析了数据集并生成了十六进制文件。十六进制文件通常被称为<strong class="bold">数据框架</strong>。现在我们已经生成了一个数据帧，让我们来看看各种元数据<a id="_idIndexMarker141"/>和对数据帧执行的操作<a id="_idTextAnchor049"/>。</p>
<h2 id="_idParaDest-42"><a id="_idTextAnchor050"/>观察数据帧</h2>
<p>数据帧是主数据对象<a id="_idIndexMarker142"/>，H2O可以在其上执行多项数据操作。此外，H2O就数据框架的内容提供了详细的见解和统计数据。当处理非常大的数据帧时，这些见解特别有用，因为很难识别数据行跨度从数千到数百万的任何列中是否有任何缺失或零。</p>
<p>因此，让我们观察刚刚解析的数据帧，并探索它的特性。您可以通过从我们在<em class="italic">图2.19 </em>中看到的解析输出中执行以下任一操作来查看数据帧:</p>
<ul>
<li>点击<strong class="bold">键</strong>行中的<code>heart.hex</code>超链接。</li>
<li>点击<strong class="bold">动作</strong>行中的<strong class="bold">查看数据</strong>按钮。</li>
</ul>
<p>下面的屏幕截图显示了前面提到的操作的输出:</p>
<div><div><img alt="Figure 2.20 – Viewing a dataframe&#10;&#10;" height="574" src="img/B17298_02_020.jpg" width="873"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.20–查看数据帧</p>
<p>输出显示数据帧的摘要。在研究<strong class="bold">动作</strong>部分的各种操作之前，首先，让我们研究一下<a id="_idIndexMarker143"/>下面显示的数据帧的元数据。</p>
<p>元数据由以下内容组成:</p>
<ul>
<li><strong class="bold">行</strong>:显示数据集中的行数</li>
<li><strong class="bold">列</strong>:显示数据集中的列数</li>
<li><strong class="bold">压缩大小</strong>:显示数据帧的总压缩大小</li>
</ul>
<p>在元数据下面，有<strong class="bold">列摘要</strong>部分。在这里，您可以看到跨列拆分的数据帧内容的统计信息。</p>
<p>该摘要包含以下信息:</p>
<ul>
<li><strong class="bold">标签</strong>:该列显示数据帧的列名。</li>
<li><strong class="bold">类型</strong>:该列显示该列的类型。</li>
<li><strong class="bold">缺失</strong>:该列显示该列中缺失值的个数。</li>
<li><strong class="bold">零</strong>:该列显示该列中零的个数。</li>
<li><strong class="bold"> +Inf </strong>:该列显示正无穷大值的个数。</li>
<li><strong class="bold"> -Inf </strong>:该列显示负无穷大值的个数。</li>
<li><strong class="bold">最小值</strong>:该列显示该列中的最小值。</li>
<li><strong class="bold">最大值</strong>:显示该列中的最大值。</li>
<li><strong class="bold">西格玛</strong>:该列显示该列值的可变性。</li>
<li><strong class="bold">基数</strong>:该列显示列中唯一值的数量。</li>
<li><strong class="bold">动作</strong>:该列显示您可以在数据帧的列上执行的某些动作。这些操作主要包括将列转换成不同的类型。如果解析后H2O错误地读取了列类型，这对于纠正列类型非常有用。</li>
</ul>
<p>您可能想知道为什么在<strong class="bold">零</strong>列中看到大量值<a id="_idIndexMarker144"/>，例如<strong class="bold">性别</strong>和<strong class="bold">休息</strong>。这是因为<strong class="bold">编码</strong>。当解析枚举列时，H2O将枚举和字符串编码成从0到1的数字值，然后是2，依此类推，<a id="_idIndexMarker145"/>依此类推。您也可以通过选择想要的编码<a id="_idIndexMarker147"/>过程来控制这个编码过程<a id="_idIndexMarker146"/>，例如<strong class="bold">标签编码</strong>或<strong class="bold">一键编码</strong>。我们将在第5章 、<em class="italic">理解AutoML算法</em>中更详细地讨论编码。</p>
<p>在<strong class="bold">列摘要</strong>部分之后，您将看到<strong class="bold">块压缩摘要</strong>部分，如以下截图所示:</p>
<div><div><img alt="Figure 2.21 – The dataset’s CHUNK COMPRESSION SUMMARY section&#10;&#10;" height="187" src="img/B17298_02_021.jpg" width="844"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.21–数据集的块压缩摘要部分</p>
<p>当处理非常大的数据集时，如果以传统方式进行，从数据集中读取和写入数据会花费很长时间。因此，经常使用Hadoop文件系统、Spark等系统，因为它们以分布式方式执行读写，比传统的连续方式更快。<strong class="bold">分块</strong>是一个过程<a id="_idIndexMarker148"/>，分布式文件系统如Hadoop将数据集分割成块，并在写入磁盘之前展平它们。H2O在内部处理所有这些，因此用户不需要担心管理分布式读取或写入。<strong class="bold">块压缩摘要</strong>部分只是给出了关于块分布的附加信息。</p>
<p>在<strong class="bold">块压缩概要</strong>下面是<strong class="bold">帧分配概要</strong>部分，如下面的截图所示:</p>
<div><div><img alt="Figure 2.22 – The dataset’s Frame Distribution Summary section&#10;&#10;" height="228" src="img/B17298_02_022.jpg" width="848"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.22–数据集的帧分布汇总部分</p>
<p><strong class="bold">帧分布汇总</strong>部分给出了数据帧的总体统计信息。如果您已经<a id="_idIndexMarker149"/>导入了多个文件并将它们解析成一个数据帧，那么帧分布摘要将计算总大小、平均大小、最小大小、最大大小、每个数据集的块数量等等。</p>
<p>从<em class="italic">图2.20 </em>中回顾数据帧，您可以看到列名被突出显示为链接。让我们点击最后一栏，<strong class="bold">心脏病</strong>。</p>
<p>以下截图将向您展示<strong class="bold">心脏病</strong>栏目的栏目摘要:</p>
<div><div><img alt="Figure 2.23 – Column summary&#10;&#10;" height="396" src="img/B17298_02_023.jpg" width="565"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.23–列摘要</p>
<p><strong class="bold">列摘要</strong>根据数据集中各个<a id="_idIndexMarker150"/>列的类型为您提供了更多的详细信息。</p>
<p>对于像<strong class="bold">心脏病</strong>这样的枚举，它向您显示该列的详细信息如下:</p>
<ul>
<li><strong class="bold">特性</strong>:此图显示了零值和非零值的百分比分布。</li>
<li><strong class="bold">域</strong>:这个图显示了列的域，即一个值在总行数中重复的次数。</li>
</ul>
<p>当你将鼠标悬停在图表上时，你会看到更多细节。请随意探索所有的列，并尝试了解它们的功能。</p>
<p>从<em class="italic">图2.20 </em>回到数据帧，现在让我们看看<strong class="bold">动作</strong>部分。这包括可在数据帧上执行的某些动作。</p>
<p>这些行动包括以下内容:</p>
<ul>
<li><strong class="bold">查看数据</strong>:该动作显示数据框中的数据。</li>
<li><strong class="bold">分割</strong>:该动作将数据帧按照指定的比例分割成指定的部分。</li>
<li><strong class="bold">构建模型</strong>:这个动作开始在这个数据帧上构建模型。</li>
<li><strong class="bold">运行AutoML </strong>:该动作触发数据帧上的AutoML。</li>
<li><strong class="bold">预测</strong>:这个动作使用dataframe对一个已经训练好的模型进行预测，并得到结果。</li>
<li><strong class="bold">下载</strong>:该动作将数据帧下载到系统。</li>
<li><strong class="bold">导出</strong>:该动作将数据帧导出到系统中的指定路径。</li>
</ul>
<p>尽管我们对触发AutoML感到兴奋，但还是让我们继续探索各种数据帧特性。</p>
<p>现在，让我们看看数据帧及其实际数据内容。为此，点击<strong class="bold">动作</strong>部分的<strong class="bold">查看数据</strong>按钮。</p>
<p>以下截图显示了<strong class="bold">查看数据</strong>按钮的输出:</p>
<div><div><img alt="Figure 2.24 – The dataframe’s content view&#10;&#10;" height="660" src="img/B17298_02_024.jpg" width="932"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.24–数据框的内容视图</p>
<p>该函数显示数据集的实际内容<a id="_idIndexMarker152"/>。您可以向下滚动查看数据框的所有内容。如果您在数据帧上运行了任何操作，那么您将能够使用此操作查看数据帧内容的变化。</p>
<p>既然您已经探索并理解了各种数据帧操作和数据帧的元数据，让我们研究一下<a id="_idIndexMarker153"/>另一个有趣的数据帧操作，叫做<strong class="bold"> Split </strong>。</p>
<h2 id="_idParaDest-43"><a id="_idTextAnchor051"/>分割数据帧</h2>
<p>在我们发送用于模型训练的数据帧之前，我们需要一个带有预测值的样本<a id="_idIndexMarker154"/>数据帧。此样本可用于验证模型是否做出正确的预测，并测量模型的准确性和性能。我们可以通过保留一小部分数据帧供以后验证使用来做到这一点。这就是拆分功能发挥作用的地方。</p>
<p><strong class="bold"> Split </strong>顾名思义，将数据集分割成若干部分，我们可以在以后使用它们进行不同的操作。数据集的分割考虑了比率。H2O会根据您想要进行的分割数量和数据分布比率创建多个数据帧。</p>
<p>要分割数据框，点击<strong class="bold">动作</strong>部分的<strong class="bold">分割</strong>操作<a id="_idIndexMarker156"/>按钮上的<a id="_idIndexMarker155"/>。</p>
<p>下面的截图显示了点击<strong class="bold">分割</strong>按钮的输出:</p>
<p class="IMG---Figure"> </p>
<div><div><img alt="Figure 2.25 – Splitting a dataframe&#10;&#10;" height="398" src="img/B17298_02_025.jpg" width="779"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.25–分割数据帧</p>
<p>在前面的输出中，将提示您输入拆分配置，如下所示:</p>
<ul>
<li><strong class="bold">框架</strong>:此配置允许您选择想要分割的框架。</li>
<li><code>training_dataframe</code>以0.70的比率</li><li><code>validation_dataframe</code>以0.20的比率</li><li><code>testing_dataframe</code>以0.10的比率</li></ul>
<li><strong class="bold">种子</strong>:这个配置让你选择随机点。Split不会线性拆分数据帧。它随机分割数据帧的行。这是一件好事，因为它在分割的数据帧之间平均分配数据，从而消除了数据集行序列中可能存在的任何偏差。对于我们的演练，让我们将种子值设置为5。</li>

<p>完成<a id="_idIndexMarker157"/>这些更改后，点击<strong class="bold">创建</strong>按钮。这将生成三个数据帧:<strong class="bold">训练_数据帧</strong>、<strong class="bold">验证_数据帧</strong>和<strong class="bold">测试_数据帧</strong>。这三个帧将被保存在H2O的本地存储库中，也可以用于其他实验。</p>
<p>下图显示了<strong class="bold">创建</strong>操作的输出:</p>
<div><div><img alt="Figure 2.26 – Split dataset results&#10;&#10;" height="218" src="img/B17298_02_026.jpg" width="980"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.26–分割数据集结果</p>
<p>所有三个数据帧都是独立的数据帧，具有与您在图2.20 的<em class="italic">中看到的原始数据集相同的功能和选项。分割不会删除原始数据帧。它创建新的数据帧，并从原始数据帧中复制数据，然后根据选定的比率在数据帧之间分配这些数据。</em></p>
<p>既然我们已经准备好了训练框架、验证框架和测试框架，我们就为模型训练管道的下一步，也就是模型训练，做好了准备。</p>
<p>因此，概括地说，在本节中，您了解了我们可以对H2O流中可用的数据集执行的各种<a id="_idIndexMarker158"/>数据操作，例如导入、解析、读取解析的数据帧以及分割它。</p>
<p>在下一节中，我们将重点关注模型训练，并使用H2O AutoML在我们在本标题中创建的数据框架上训练模型。</p>
<h1 id="_idParaDest-44"><a id="_idTextAnchor052"/>在H2O流程中使用模型训练功能</h1>
<p>一旦你的数据集准备好了，模型训练管道<a id="_idIndexMarker160"/>的下一个<a id="_idIndexMarker159"/>步骤就是实际的训练部分。模型的训练可能会变得非常复杂，因为有许多配置决定了如何在数据集上训练模型。即使对于AutoML来说也是如此，在AutoML中，大多数超参数调整都是在幕后完成的。对于特定类型的数据，不仅有正确和错误的模型定型方法，而且一些配置值也会影响模型的性能。因此，在使用AutoML训练模型时，了解H2O必须提供的各种配置参数非常重要。在本节中，我们将重点了解这些参数是什么，以及它们在模型训练中的作用。</p>
<p>我们将了解如何使用AutoML逐步训练模型，使用我们之前创建的数据框架。</p>
<p>请注意，本节中有许多内容太复杂，现阶段无法理解。我们将在以后的章节中探讨其中的一些。目前，我们将只关注我们现在可以理解的特征，因为本章的目标是理解H2O流以及如何使用AutoML来训练使用H2O流的模型。</p>
<p>在下面的小节中，我们将了解模型训练操作，从了解AutoML训练配置参数开始。</p>
<h2 id="_idParaDest-45"><a id="_idTextAnchor053"/>了解H2O流中的AutoML参数</h2>
<p>就你想如何训练<a id="_idIndexMarker162"/>你的模型而言，H2O汽车是非常可配置的<a id="_idIndexMarker161"/>。尽管使用相同的AutoML技术，但通常每个行业都有特定的偏好或倾向，即希望如何根据需求训练模型。因此，尽管AutoML正在自动化大多数ML过程，但在AutoML如何训练其模型方面，仍需要一定程度的控制和灵活性。H2O为其AutoML特性提供了广泛的配置能力。让我们在训练模型时探索它们。</p>
<p>有两种方法可以触发数据集上的<a id="_idIndexMarker163"/> AutoML。它们列举如下:</p>
<ul>
<li>点击数据帧输出的<strong class="bold">动作</strong>部分的<strong class="bold">运行AutoML </strong>按钮，如图<em class="italic">图2.20 </em>所示。</li>
<li>在web UI最顶端的<strong class="bold">模型</strong>部分的下拉菜单中选择<strong class="bold">运行AutoML </strong>，如图2.27 所示。</li>
</ul>
<p>让我们选择第二个选项，这样我们就可以探索web UI页面顶部的<strong class="bold">模型</strong>操作部分。当您点击<strong class="bold">型号</strong>部分时，您应该会看到下拉列表，如下图所示:</p>
<div><div><img alt="Figure 2.27 – The Model functions drop-down list&#10;&#10;" height="783" src="img/B17298_02_027.jpg" width="358"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.27–模型功能下拉列表</p>
<p>前面的下拉列表将模型操作分为三种类型，如下所示:</p>
<ul>
<li><strong class="bold">运行AutoML </strong>:该操作通过提示用户输入配置值来启动AutoML过程<a id="_idIndexMarker164"/>以使用AutoML训练模型。</li>
<li><strong class="bold">运行特定模型</strong>:该操作开始对您希望使用的特定ML算法进行模型训练<a id="_idIndexMarker165"/>；比如深度学习，K-means聚类，随机森林等等。每个ML算法都有自己的一组参数，您必须指定这些参数才能开始训练模型。</li>
<li><strong class="bold">模型管理选项</strong>:这些操作是基本操作<a id="_idIndexMarker166"/>，用于管理您可能在一段时间内训练过的各种模型。<ul><li>这些操作如下所示:<ul><li><strong class="bold">导入MOJO模型</strong>:该操作导入H2O <strong class="bold">模型对象，优化</strong> ( <strong class="bold"> MOJO </strong>)之前由另一个H2O服务<a id="_idIndexMarker167"/>训练的模型，并以MOJO的形式导出到系统中。</li><li><strong class="bold">列出所有模型</strong>:此操作列出您的H2O服务培训的所有模型。这包括那些被其他心流笔记本训练过的人。</li><li><strong class="bold">列出网格搜索结果</strong>:网格搜索是一种技术，用于在训练模型时寻找最佳超参数，以获得最佳和最精确的性能。该操作列出了来自模型训练的所有网格搜索结果。</li><li><strong class="bold">导入模型</strong>:该操作将模型对象导入H2O。</li><li><strong class="bold">导出模型</strong>:该操作将模型对象作为二进制文件或MOJO导出到系统中。</li></ul></li></ul></li>
</ul>
<p>现在，让我们使用AutoML在数据集上训练我们的模型。</p>
<p>点击<strong class="bold">运行AutoML </strong>。如<em class="italic">图2.27 </em>所示，您应该会看到一个输出，提示您输入各种配置参数来运行AutoML。有大量的选项来配置您的AutoML培训。这些会极大地影响您的模型训练性能和最终得到训练的模型的质量。这些参数分为三类。让我们从基本参数开始，一个接一个地探索它们，并输入值以适应我们的模型训练要求。</p>
<h3>基本参数</h3>
<p>基本参数是关注所有模型训练操作所需的基本输入的参数<a id="_idIndexMarker168"/>。这些在所有的ML算法中是常见的，并且是不言自明的。</p>
<p>下面的屏幕截图显示了配置AutoML时需要输入的基本参数值:</p>
<div><div><img alt="Figure 2.28 – The basic parameters of AutoML&#10;&#10;" height="444" src="img/B17298_02_028.jpg" width="1167"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.28–AutoML的基本参数</p>
<p>基本参数如下所示:</p>
<ul>
<li><code>training_frame</code>参数是我们在H2O流程部分的<em class="italic">中创建的<code>training_dataframe.hex</code>文件。</em></li>
<li><code>HeartDisease</code>列。</li>
<li><code>validation_dataframe.hex</code>我们在上一节创建的文件。</li>
<li><strong class="bold"> blending_frame </strong>:该配置设置用于训练堆叠整体<a id="_idIndexMarker169"/>模型的数据帧。目前，我们可以忽略这一点，因为我们不会在本章中过多地探索堆叠系综。我们将在第五章<a href="B17298_05.xhtml#_idTextAnchor109"><em class="italic"/></a>、<em class="italic">了解AutoML算法</em>中更详细地探讨堆叠集成模型，因此我们将此留白。</li>
<li><code>nfolds</code>设为0，则AutoML将从训练帧中生成排行榜。</li>
<li><strong class="bold"> project_name </strong>:这个配置设置项目的名称。AutoML会将多次运行的所有结果分组到该项目名称下的一个排行榜中。如果将该值留空，H2O将自动为项目生成一个随机名称。</li>
<li><strong class="bold">分布</strong>:该配置用于指定ML算法使用的分布函数类型。支持指定分布函数类型的算法将使用它，而其他算法将使用它们的默认值。我们将在<a href="B17298_05.xhtml#_idTextAnchor109"> <em class="italic">第5章</em> </a>、<em class="italic">了解AutoML算法</em>中了解更多关于分布函数的内容。</li>
</ul>
<p>现在您已经了解了AutoML的基本参数，让我们了解一下高级参数。</p>
<h3>高级参数</h3>
<p>高级参数为使用AutoML的训练模型提供额外的<a id="_idIndexMarker170"/>配置。这些参数设置了某些默认值，因此不是强制性的。但是，它们确实提供了额外的配置，这些配置在训练模型时会改变AutoML的行为。</p>
<p>以下截图向您展示了AutoML高级参数的第一部分:</p>
<div><div><img alt="Figure 2.29 – AutoML advanced parameters, part 1&#10;&#10;" height="638" src="img/B17298_02_029.jpg" width="1155"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.29–AutoML高级参数，第1部分</p>
<p>紧随其后的是高级参数的第二部分。向下滚动以查看剩余的参数，如下面的屏幕截图所示:</p>
<div><div><img alt="Figure 2.30 – AutoML advanced parameters, part 2&#10;&#10;" height="623" src="img/B17298_02_030.jpg" width="1181"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.30–AutoML高级参数，第2部分</p>
<p>下面我们就来一一探究一下参数<a id="_idIndexMarker172"/>。高级参数如下所示:</p>
<ul>
<li><strong class="bold"> fold_column </strong>:该参数在N重交叉验证时，以列值为基础创建其折叠。我们将在接下来的章节中学习更多关于交叉验证的知识。</li>
<li><strong class="bold"> weights_column </strong>:该参数为训练帧中的一列赋予权重，或者简单地说，为一列赋予优先级。我们将在后面的章节中更详细地探讨模型训练中的权重。</li>
<li><strong class="bold"> ignored_columns </strong>:此参数允许您从训练框架中选择训练模型时希望忽略的列。在我们的实验中，我们不会忽略任何列，所以我们将保留所有未选中的列。</li>
<li><strong class="bold"> sort_metrics </strong>:此参数选择将用于对AutoML训练的模型进行排序和排名的度量。选择<strong class="bold">自动</strong>将使用<strong class="bold"> AUC </strong>度量进行二元分类，使用<strong class="bold"> mean_per_class_error </strong>进行多项分类，使用<strong class="bold">偏差</strong>进行回归。为了简单起见，让我们将<strong class="bold">均方误差</strong> ( <strong class="bold"> MSE </strong>)设置为排序度量，因为它更容易理解<a id="_idIndexMarker173"/>。我们将在第6章 、<em class="italic">了解H2O汽车排行榜和其他绩效指标</em>中更详细地探讨这些指标。</li>
<li><code>0</code>防止创建堆叠集合模型。我们将在接下来的章节中进一步探索堆叠集成模型和交叉验证。</li>
<li><strong class="bold"> Balance_classes </strong>:在模型训练中，最好是在输出类具有相等值分布的数据集上训练模型。这减轻了价值分配不均可能产生的偏见。此参数平衡输出类，使其数量相等。在我们的例子中，输出类是<strong class="bold">心脏病</strong>列。正如我们在<strong class="bold">心脏病</strong>列的摘要中看到的，在分布部分，我们有大约410个值为0，508个值为1 ( <em class="italic">见图2.23 </em>)。因此，理想情况下，我们需要在训练模型之前平衡这些类。然而，为了保持事情的简单，我们将跳过职业的平衡，专注于理解基础知识。我们将在接下来的章节中进一步探讨职业平衡。</li>
<li><strong class="bold"> exclude_algos </strong>:该参数从AutoML训练中排除某些算法。对于我们的实验，我们要考虑所有的算法，所以让我们把这个值留空。</li>
<li><code>-1</code>照现在这样。</li>
<li><strong class="bold">monoton _ constraints</strong>:在某些情况下，如果非常强烈地认为特征之间的关系具有某种质量，则可以使用约束来提高模型的预测性能。该参数有助于设置这些约束。我们将在接下来的章节中对此进行更多的讨论。让我们把这个值留空。</li>
<li><code>5</code>。</li>
<li><code>10</code>，别的模特训练可能要花很长时间。</li>
<li><strong class="bold"> max_runtime_secs </strong>:该参数设置H20训练单个模型的最大时间。通常，数据集越大，模型的定型时间就越长。为模型训练设置非常小的运行时间不会给AutoML训练模型所需的时间。由于我们的数据集不是很大，我们将让AutoML花时间训练模型，这应该不会太长。</li>
<li><strong class="bold">max _ runtime _ sec _ per _ model</strong>:该参数设置AutoML训练单个模型所花费的最大时间。模特培训不会花太长时间。所以，我们忽略这一点。</li>
<li><code>0</code>将其禁用。</li>
<li><strong class="bold"> stopping_metrics </strong>:该指标用于提前停止。由于停止是禁用的，我们将忽略这一点。</li>
<li><strong class="bold"> stopping_tolerance </strong>:这是预期渐进式模型训练改进的相对容差，低于该容差，AutoML应停止训练模型。由于停止是禁用的，我们将忽略这一点。</li>
</ul>
<p>既然你已经了解了AutoML的基本参数是什么，那我们来查一下专家参数。</p>
<h3>专家参数</h3>
<p>专家参数是提供额外选项的参数<a id="_idIndexMarker176"/>，这些额外选项用有助于进一步实验的额外特征来补充AutoML训练结果。这些参数取决于您已经在<em class="italic">高级参数</em>部分选择的配置。</p>
<p>下面的屏幕截图显示了我们当前演练中可用的专家参数选项:</p>
<div><div><img alt="Figure 2.31 – AutoML expert parameters&#10;&#10;" height="271" src="img/B17298_02_031.jpg" width="999"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.31–AutoML专家参数</p>
<p>专家参数如下所示:</p>
<ul>
<li><strong class="bold">keep _ cross _ validation _ predictions</strong>:如果为训练启用了交叉验证，那么H2O会提供保存这些预测值的选项。</li>
<li><strong class="bold">keep _ cross _ validation _ models</strong>:如果为训练启用了交叉验证，那么H2O提供了保存同样训练的模型的选项。</li>
<li><strong class="bold">keep _ cross _ validation _ fold _ assignments</strong>:如果为训练启用了交叉验证，那么H2O提供了保存用于不同交叉验证的模型训练的折叠的选项。</li>
<li><strong class="bold"> export_checkpoint_dir </strong>:这是H2O存储生成模型的目录路径。</li>
</ul>
<p>根据您在“基本”和“高级”参数中的选择，更多专家选项可用。目前，我们可以禁用所有专家参数，因为在本演练中我们不会过多关注它们。</p>
<p>一旦您设置了所有的参数值，现在剩下的唯一事情就是触发AutoML模型训练。</p>
<h2 id="_idParaDest-46"><a id="_idTextAnchor054"/>在H2O流程中使用AutoML训练和理解模型</h2>
<p>模型训练是最复杂的<a id="_idIndexMarker177"/>之一，也是ML管道的重要部分。模型训练是通过学习特征<a id="_idIndexMarker179"/>和预期输出之间的关系来映射数学<a id="_idIndexMarker178"/>近似值的过程，同时努力使损失最小化。有多种方法可以做到这一点。系统<a id="_idIndexMarker180"/>执行该任务的方法被称为ML算法。AutoML使用各种ML算法训练模型<a id="_idIndexMarker181"/>，并相互比较它们的性能，以根据ML问题找到具有最小误差度量值的模型。</p>
<p>首先，让我们了解如何在H2O流中使用AutoML来训练一个模型。</p>
<h3>在H2O流程中使用AutoML训练模型</h3>
<p>使用AutoML设置用于训练<a id="_idIndexMarker183"/>模型的参数值时，您需要仔细考虑<a id="_idIndexMarker182"/>。一旦选择了正确的输入，就可以触发AutoML模型训练。</p>
<p>你可以点击<strong class="bold"> Run AutoML </strong>输出末尾的<strong class="bold"> Build Models </strong>按钮来完成。</p>
<p>下面的屏幕截图显示了AutoML培训作业的进度:</p>
<p class="IMG---Figure"> </p>
<div><div><img alt="Figure 2.32 – The AutoML training is finished&#10;&#10;" height="474" src="img/B17298_02_032.jpg" width="1346"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.32–AutoML培训完成</p>
<p>训练模型应该需要一些时间。模型训练的结果<a id="_idIndexMarker184"/>存储在<strong class="bold">排行榜</strong>中。<strong class="bold">键</strong>部分的值是指向排行榜的链接(参见<em class="italic">图2.32 </em>)。</p>
<p>您可以通过两种方式查看排行榜<a id="_idIndexMarker185"/>。如下所列<a id="_idIndexMarker186"/>:</p>
<ul>
<li>点击AutoML培训工作输出的<strong class="bold">键</strong>部分的排行榜链接。</li>
<li>点击AutoML培训作业输出的<strong class="bold">查看</strong>按钮。</li>
</ul>
<p>在下面的截图中，你可以看到一个<strong class="bold">排行榜</strong>的样子:</p>
<div><div><img alt="Figure 2.33 – AutoML Leaderboard&#10;&#10;" height="532" src="img/B17298_02_033.jpg" width="1259"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.33–AutoML排行榜</p>
<p>如果您按照前面的例子中所示的相同步骤，那么您应该看到相同的输出，尽管模型的id略有不同，因为它是随机生成的。排行榜显示了AutoML训练过的所有模型，并根据<strong class="bold">排序标准</strong>将它们从最好到最差排序。排序度量是模型质量的统计度量<a id="_idIndexMarker187"/>，用于比较不同模型的性能。此外，排行榜还提供了所有单个型号详情的链接。您可以单击其中的任何一个，以获得有关各个型号的更多信息。如果AutoML正在进行中并且当前正在训练模型，那么您也可以通过点击<strong class="bold"> Monitor Live </strong>按钮来实时查看训练的进度。</p>
<p>既然您已经理解了如何使用AutoML训练一个模型，那么让我们深入ML模型的细节，并尝试理解它的各种特征。</p>
<h3>理解ML模型</h3>
<p>ML模型可以被描述为包含数学方程的对象<a id="_idIndexMarker188"/>，该数学方程可以识别给定特征集的模式并预测潜在结果。这些ML模型构成了所有ML管道的中心组件，因为整个ML管道旨在创建和使用这些模型进行预测。因此，了解一个训练好的ML模型的各种细节是很重要的，以便证明它所做的预测是否准确以及准确到什么程度。</p>
<p>让我们点击排行榜上的最佳型号，了解更多详情。您应该会看到以下输出:</p>
<div><div><img alt="Figure 2.34 – Model information&#10;&#10;" height="209" src="img/B17298_02_034.jpg" width="1179"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.34–型号信息</p>
<p>正如你所看到的，H2O提供了一个非常深入的模型细节。所有的细节都分门别类地放在各自的小节中。这里有大量的信息，因此，它可以是压倒性的。目前，我们将只关注重要的部分。</p>
<p>让我们逐一浏览一下重要且易于理解的细节:</p>
<ul>
<li><strong class="bold">型号ID </strong>:这是型号的ID。</li>
<li><strong class="bold">算法</strong>:表示用于训练模型的算法。</li>
<li><strong class="bold">动作</strong>:模型训练完成后，您可以对其执行以下动作:<ul><li><strong class="bold">刷新</strong>:刷新内存中的模型。</li><li><strong class="bold">预测</strong>:这可以让你开始对这个模型进行预测。</li><li><strong class="bold">下载POJO </strong>:以<strong class="bold">普通旧Java对象</strong> ( <strong class="bold"> POJO </strong>)格式下载<a id="_idIndexMarker189"/>模型。</li><li><strong class="bold">下载模型部署包</strong>:下载MOJO格式的模型。</li><li><strong class="bold"> Export </strong>:将模型作为文件或MOJO导出到系统中。</li><li><strong class="bold"> Inspect </strong> : H2O进入Inspect模式，在这里它检查模型对象，检索关于其模式和子模式的详细信息。</li><li><strong class="bold">删除</strong>:删除模型。</li><li><strong class="bold">下载生成模型</strong>:下载生成的模型JAR文件。</li></ul></li>
</ul>
<p>然后，您有一组子部分<a id="_idIndexMarker190"/>解释更多关于模型的元数据和性能。这些小节对于不同的模型略有不同，因为出于解释的目的，一些模型可能需要显示一些额外的元数据。</p>
<p>正如你所看到的，许多细节看起来本质上非常复杂，这是理所当然的。这是因为它们涉及到一点数据科学知识。不用担心；我们将在接下来的章节中探讨所有这些问题。</p>
<p>让我们看一下更简单的小节，这样我们就可以理解ML模型的各种元数据:</p>
<ul>
<li><strong class="bold">模型参数</strong>:模型参数<a id="_idIndexMarker191"/>只不过是我们传递给AutoML的输入参数，以及AutoML决定用来训练模型的一些输入。点击<strong class="bold">显示所有参数</strong>或<strong class="bold">显示修改参数</strong>按钮，您可以选择查看所有参数或仅查看修改后的参数。参数说明显示在每个参数的旁边。</li>
<li><strong class="bold">变量重要性</strong>:变量重要性表示变量<a id="_idIndexMarker192"/>在进行预测时的重要性。最重要的变量是ML模型在进行预测时最依赖的变量。对非常重要的变量的任何改变都会极大地影响模型预测。</li>
</ul>
<p>下面的屏幕截图向您展示了我们用来训练模型的数据框架中各种特征的重要程度:</p>
<div><div><img alt="Figure 2.35 – Variable importances&#10;&#10;" height="477" src="img/B17298_02_035.jpg" width="951"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.35-可变重要性</p>
<ul>
<li><strong class="bold">输出</strong>:输出子部分表示<a id="_idIndexMarker193"/>AutoML训练的基本输出值。显示的大部分详细信息是针对交叉验证结果的。</li>
</ul>
<p>输出值如下所示:</p>
<ul>
<li><strong class="bold"> model_category </strong>:该值表示模型的类别，表示它执行哪种预测。二项式表示它执行二项式分类，这意味着它预测值是<strong class="bold"> 1 </strong>还是<strong class="bold"> 0 </strong>。在我们的例子中，<strong class="bold"> 1 </strong>表示这个人可能面临心脏病，而<strong class="bold"> 0 </strong>表示这个人不太可能面临心脏病。</li>
<li><strong class="bold"> start_time </strong>:该值表示开始模型训练的纪元时间。</li>
<li><strong class="bold"> end_time </strong>:该值表示结束模型训练的纪元时间。</li>
<li><strong class="bold">运行时间</strong>:该值表示完成模型训练所用的历元总时间。</li>
<li><strong class="bold"> default_threshold </strong>:这是默认的阈值，超过该值，模型会将所有预测视为<strong class="bold"> 1 </strong>。类似地，任何低于默认阈值的预测值都将是<strong class="bold"> 0 </strong>。</li>
</ul>
<p>下面的屏幕截图显示了<a id="_idIndexMarker194"/> you模型的输出子部分的详细信息:</p>
<p class="IMG---Figure"> </p>
<div><div><img alt="Figure 2.36 – Output of the model information&#10;&#10;" height="461" src="img/B17298_02_036.jpg" width="610"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.36–模型信息的输出</p>
<ul>
<li><strong class="bold"> Column_Types </strong>:这一小节简要介绍数据帧中各列的类型<a id="_idIndexMarker195"/>。这些值的顺序与定型数据帧中的列顺序相同。</li>
</ul>
<p>下面的屏幕截图显示了模型细节的<strong class="bold"> column_types </strong>指标:</p>
<div><div><img alt="Figure 2.37 – Column types&#10;&#10;" height="549" src="img/B17298_02_037.jpg" width="275"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.37–列类型</p>
<ul>
<li><strong class="bold">Output-Training _ Metrics</strong>:这一小节向您展示训练数据集用于预测时模型的指标<a id="_idIndexMarker196"/>。我们将在以后的章节中了解ML的各种度量标准。</li>
</ul>
<p>下面的屏幕截图显示了模型详细信息的培训指标:</p>
<p class="IMG---Figure"> </p>
<div><div><img alt="Figure 2.38 – The model output’s training metrics&#10;&#10;" height="590" src="img/B17298_02_038.jpg" width="744"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.38–模型输出的训练指标</p>
<ul>
<li><strong class="bold">Output-Validation _ Metrics</strong>:与上一小节类似，这一小节向您展示了当验证数据集用于预测时模型的指标<a id="_idIndexMarker197"/>。</li>
</ul>
<p>下面的屏幕截图显示了模型详细信息的培训指标:</p>
<div><div><img alt="Figure 2.39 – The model output’s validation metrics&#10;&#10;" height="751" src="img/B17298_02_039.jpg" width="701"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.39–模型输出的验证指标</p>
<p>现在我们已经了解了模型细节的各个部分，让我们看看如何对这个新训练的模型执行预测。</p>
<h1 id="_idParaDest-47"><a id="_idTextAnchor055"/>在H2O流中使用预测功能</h1>
<p>现在你终于有了一个经过训练的<a id="_idIndexMarker198"/>模型，我们可以对它进行<a id="_idIndexMarker199"/>预测。对训练模型的预测很简单。您只需要加载模型并传入您的数据集，其中包含您要进行预测的数据。H2O将使用加载的模型并对数据集中的所有值进行预测。让我们使用之前创建的<code>prediction_dataframe.hex</code>数据框架进行预测。</p>
<p>我们将在以下小节中了解预测操作，首先了解如何进行预测。</p>
<h2 id="_idParaDest-48"><a id="_idTextAnchor056"/>利用H2O流进行预测</h2>
<p>首先，让我们从<a id="_idIndexMarker200"/>开始探索web UI最顶端的<strong class="bold">分数</strong>操作的下拉列表。</p>
<p>您将看到评分操作列表，如下所示:</p>
<div><div><img alt="Figure 2.40 – The Score functions drop-down menu&#10;&#10;" height="291" src="img/B17298_02_040.jpg" width="1204"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.40–得分功能下拉菜单</p>
<p>前面的下拉菜单显示了您可以执行的各种评分操作的列表。</p>
<p>这些功能如下所示:</p>
<ul>
<li><strong class="bold">预测</strong>:使用训练好的模型进行预测。</li>
<li><strong class="bold">部分相关图</strong>:这些图显示了变量对预测的影响。换句话说，它们向您展示了更改用于预测的数据中的某些变量如何影响预测响应。</li>
<li><strong class="bold">列出所有预测</strong>:该功能列出所有已经做出的预测。</li>
</ul>
<p>有两种方法可以开始在H2O流中进行预测。它们列举如下:</p>
<ul>
<li>使用<strong class="bold">分数</strong>操作下拉菜单中的<strong class="bold">预测</strong>功能。</li>
<li>点击模型<strong class="bold">动作</strong>部分的<strong class="bold">预测</strong>按钮，如图<em class="italic">图2.34 </em>所示。</li>
</ul>
<p>这两种方法将给出相同的输出，如下面的屏幕截图所示:</p>
<div><div><img alt="Figure 2.41 – Prediction&#10;&#10;" height="460" src="img/B17298_02_041.jpg" width="717"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.41–预测</p>
<p>点击ML <a id="_idIndexMarker201"/>模型的<strong class="bold">预测</strong>动作按钮，将<strong class="bold">模型</strong>参数设置为相应的模型ID。但是，当点击<strong class="bold">分数</strong>操作下拉列表中的<strong class="bold">预测</strong>操作按钮时，您可以选择任何型号。</p>
<p><strong class="bold">预测</strong>操作将提示您输入以下参数:</p>
<ul>
<li><strong class="bold">名称</strong>:您可以为预测结果命名，以便识别。如果您正在尝试不同的预测请求，并且需要快速引用您感兴趣的特定预测结果，这将非常方便。</li>
<li><strong class="bold">模型</strong>:这是您希望使用<a id="_idIndexMarker202"/>进行预测的模型的ID。由于我们选择了我们的<strong class="bold">梯度助推器</strong> ( <strong class="bold"> GBM </strong>)模型的<strong class="bold">预测</strong>动作，这将不可编辑。</li>
<li><strong class="bold">框架</strong>:这是您想要用来进行预测的数据框架。所以，让我们选择<strong class="bold">预测_数据集.十六进制</strong>文件。</li>
<li><strong class="bold">计算叶节点分配</strong>:为用于预测的数据帧中的每一行返回该行在模型的所有树中的叶位置。对于我们的演练，我们不需要这个，因此，我们可以不检查它。</li>
</ul>
<p>一旦选择了合适的参数值，剩下唯一要做的就是点击<strong class="bold">预测</strong>按钮进行预测。</p>
<p>下面的截图显示了<strong class="bold">预测</strong>操作的输出:</p>
<p class="IMG---Figure"> </p>
<div><div><img alt="Figure 2.42 – The Prediction output&#10;&#10;" height="356" src="img/B17298_02_042.jpg" width="1157"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.42–预测输出</p>
<p>恭喜你！你终于<a id="_idIndexMarker203"/>成功地对AutoML训练的模型做出了预测。让我们继续下一部分，我们将探索和理解我们刚刚得到的预测结果。</p>
<h2 id="_idParaDest-49"><a id="_idTextAnchor057"/>了解预测结果</h2>
<p>预测是ML流水线的最后阶段<a id="_idIndexMarker204"/>。它是为创建ML管道的所有努力带来实际价值的部分。做预测很容易；但是，了解实际预测值以及它相对于输入值的意义非常重要。</p>
<p>预测结果不仅提供了预测值的详细信息，还提供了度量信息和某些元数据，如图<em class="italic">图2.42 </em>所示。</p>
<p>以下屏幕截图显示了预测结果的预测输出子部分:</p>
<p class="IMG---Figure"> </p>
<div><div><img alt="Figure 2.43 – The prediction results&#10;&#10;" height="626" src="img/B17298_02_043.jpg" width="690"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.43–预测结果</p>
<p>这类似于我们在<em class="italic">图2.38 </em>和<em class="italic">图2.39 </em>中看到的模型细节的<strong class="bold">输出验证和训练指标</strong>。</p>
<p>在该子部分中，预测键旁边有预测<a id="_idIndexMarker205"/>帧链接。点击它会显示你的预测值的框架摘要。让我们这样做，以便我们可以得到一个很好的预测值。</p>
<p>下面的屏幕截图以数据框的形式显示了预测摘要的详细信息:</p>
<p class="IMG---Figure"> </p>
<div><div><img alt="Figure 2.44 – The prediction dataframe&#10;&#10;" height="385" src="img/B17298_02_044.jpg" width="987"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.44–预测数据框架</p>
<p>H2O也将预测结果存储为数据帧。因此，它们具有我们在<em class="italic">在H2O流中使用数据函数</em>一节中讨论的相同特性。</p>
<p><strong class="bold">列汇总</strong>部分表示<a id="_idIndexMarker206"/>预测数据帧中的三列。它们列举如下:</p>
<ul>
<li><strong class="bold">预测</strong>:该列为枚举类型，指示预测数据帧中输入行的预测值。</li>
<li><strong class="bold"> P0 </strong>:该栏表示预测值为0的概率。</li>
<li><strong class="bold"> P1 </strong>:该栏表示预测值为1的概率。</li>
</ul>
<p>让我们查看数据，以便更好地理解其内容。点击预测数据帧输出的<strong class="bold">动作</strong>部分的<strong class="bold">查看数据</strong>按钮，可以查看数据帧的内容，如图<em class="italic">图2.44 </em>所示。</p>
<p>以下屏幕截图显示了查看预测数据时的预期输出:</p>
<p class="IMG---Figure"> </p>
<div><div><img alt="Figure 2.45 – The content of the prediction dataframe&#10;&#10;" height="588" src="img/B17298_02_045.jpg" width="527"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.45–预测数据框架的内容</p>
<p>让我们回到预测<a id="_idIndexMarker207"/>输出的<strong class="bold">预测</strong>子部分，如图<em class="italic">图2.43 </em>所示。让我们将预测结果与用作预测输入的数据框架结合起来。您可以通过点击<strong class="bold">将预测与帧</strong>结合按钮来实现。</p>
<p>下面的屏幕截图显示了该操作的输出:</p>
<div><div><img alt="Figure 2.46 – The Combine predictions with frame result&#10;&#10;" height="194" src="img/B17298_02_046.jpg" width="1065"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.46–组合预测和框架结果</p>
<p>点击<strong class="bold">视图框</strong>按钮显示组合框，也是一个数据框。让我们点击<strong class="bold">查看框架</strong>按钮查看框架的内容。</p>
<p>下面的截图显示了从帧的组合输出中得到的<strong class="bold">视图帧</strong>操作的输出:</p>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US"> </p>
<div><div><img alt="Figure 2.47 – The dataframe used for prediction combined with prediction results&#10;&#10;" height="272" src="img/B17298_02_047.jpg" width="1039"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.47–用于预测和预测结果相结合的数据框架</p>
<p>选择组合预测输出的<strong class="bold">动作</strong>部分中的<strong class="bold">查看数据</strong>按钮，向您显示数据帧的完整内容<a id="_idIndexMarker208"/>，旁边是预测值。</p>
<p>以下屏幕截图显示了组合数据帧的内容:</p>
<div><div><img alt="Figure 2.48 – The content of the combined dataframes&#10;&#10;" height="616" src="img/B17298_02_048.jpg" width="951"/>
</div>
</div>
<p class="IMG---Caption" lang="en-US" xml:lang="en-US">图2.48–组合数据帧的内容</p>
<p>观察组合数据帧的内容，您会注意到现在可以很容易地比较预测值，如在<strong class="bold">预测</strong>列中所述，并将它们与同一行的<strong class="bold">心脏病</strong>列中的实际值进行比较。</p>
<p>恭喜你！您已经正式对一个模型进行了预测，您对该模型进行了训练并将结果合并到一个单一的数据框架中以进行比较，您可以与您的利益相关者共享该数据框架。因此，这总结了我们如何使用H2O流创建ML管道的演练。</p>
<h1 id="_idParaDest-50"><a id="_idTextAnchor058"/>总结</h1>
<p>在本章中，我们了解了H2O流必须提供的各种功能。在熟悉了web UI之后，我们开始实现ML管道。我们导入并解析了心力衰竭预测数据集。我们了解了可以在数据帧上执行的各种操作，了解了数据帧的元数据和统计数据，并准备了数据集，以便稍后训练、验证和预测模型。</p>
<p>然后，我们使用AutoML在数据框架上训练模型。我们了解正确配置AutoML需要输入的各种参数。我们使用AutoML训练模型，并了解排行榜。然后，我们更深入地研究训练出来的模型的细节，尽力了解它们的特点。</p>
<p>一旦我们的模型被定型，我们就对其执行预测，然后通过将它与原始数据帧相结合来探索预测输出，以便我们可以比较预测值。</p>
<p>在下一章，我们将进一步探索各种数据操作。这将有助于我们了解在清理和转换数据帧方面需要采取哪些步骤，以及如何提高训练模型的质量。</p>
</div>
<div><div/>
</div>
</div>
</body></html>