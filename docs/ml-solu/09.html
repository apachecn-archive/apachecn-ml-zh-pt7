<html><head/><body>






<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09"/>第九章。构建实时物体识别应用程序</h1></div></div></div><p>在这一章中，我们将构建一个可以检测物体的应用程序。这个应用程序将帮助我们识别出现在图像或视频中的物体。我们将使用实时输入，例如来自网络摄像头的实时视频流，我们的实时对象检测应用程序将检测视频流中存在的对象。我们将使用现场视频流，这是这种物体检测被称为<strong>实时物体检测<a id="id1040" class="indexterm"/> </strong>的主要原因。在本章中，我们将使用<strong>迁移学习</strong>方法来<a id="id1041" class="indexterm"/>构建实时物体检测。我将在本章的课程中详细解释迁移学习。</p><p>在本章中，我们将讨论以下主题:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">介绍问题陈述</li><li class="listitem" style="list-style-type: disc">了解数据集</li><li class="listitem" style="list-style-type: disc">迁移学习</li><li class="listitem" style="list-style-type: disc">设置编码环境</li><li class="listitem" style="list-style-type: disc">基线模型的特征工程</li><li class="listitem" style="list-style-type: disc">选择<strong>机器学习</strong> ( <strong> ML </strong>)算法</li><li class="listitem" style="list-style-type: disc">构建基线模型</li><li class="listitem" style="list-style-type: disc">了解测试指标</li><li class="listitem" style="list-style-type: disc">测试基线模型</li><li class="listitem" style="list-style-type: disc">现有方法的问题</li><li class="listitem" style="list-style-type: disc">如何优化现有方法<div> <ul class="itemizedlist"> <li class="listitem" style="list-style-type: disc">了解优化过程</li> </ul> </div></li><li class="listitem" style="list-style-type: disc">实施修订方法<div> <ul class="itemizedlist"> <li class="listitem" style="list-style-type: disc">测试修订方法</li> <li class="listitem" style="list-style-type: disc">理解修订方法</li> </ul> </div>中的问题</li><li class="listitem" style="list-style-type: disc">最佳方法<div> <ul class="itemizedlist"> <li class="listitem" style="list-style-type: disc">实施最佳方法</li> </ul> </div></li><li class="listitem" style="list-style-type: disc">摘要</li></ul></div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec87"/>介绍问题陈述</h1></div></div></div><p>在这章<a id="id1042" class="indexterm"/>中，我们将构建一个物体检测应用程序。我们不仅仅是检测物体，我们还将构建实时检测物体的应用程序。这种应用可以用于自动驾驶汽车，用于农业领域的隔离任务，甚至可以用于机器人领域。让我们了解我们的目标以及我们实际上在构建什么。</p><p>我们希望建立一个应用程序，其中我们将提供直播网络摄像头视频流或直播视频流作为输入。我们的应用程序将使用预训练的机器学习模型，这将帮助我们预测视频中出现的对象。这意味着，如果视频中有一个人，那么我们的应用程序可以将这个人识别为一个人。如果视频包含一把椅子、一个杯子或一部手机，那么我们的应用程序应该以正确的方式识别所有这些对象。因此，我们在这一章的主要目标是建立一个应用程序，可以检测图像和视频中的对象。在本章中，你还将学习迁移学习的概念。我们所有的方法都基于深度学习技术。</p><p>在下一部分，我们将讨论数据集。</p></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec88"/>了解数据集</h1></div></div></div><p>在这一部分，我们<a id="id1043" class="indexterm"/>将涵盖深度学习模型已经被训练的数据集。当我们尝试构建对象检测应用程序时，有两个数据集被大量使用<a id="id1044" class="indexterm"/>，这些数据集如下:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">COCO数据集</li><li class="listitem" style="list-style-type: disc">PASCAL VOC数据集</li></ul></div><p>我们将逐一查看每个数据集。</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec151"/>COCO数据集</h2></div></div></div><p>可可代表上下文中常见的<a id="id1045" class="indexterm"/>对象。因此，这个数据集的简称是COCO数据集。许多科技巨头，如谷歌、脸书、微软等等都在使用COCO数据来构建令人惊叹的应用程序，用于对象检测、对象分割等等。您可以在官方网页上找到关于该数据集的详细信息:</p><p><a class="ulink" href="http://cocodataset.org/#home">http://cocodataset.org/#home</a></p><p>COCO数据集是一个大规模的对象检测、分割和字幕数据集。在这个数据集中，总共有330，000幅图像，其中超过200，000幅被标记。这些图像包含80个对象类别的150万个对象实例。所有带标签的图像都有五种不同的标题；因此，我们的机器学习方法能够有效地推广目标检测和分割。</p><p>通过使用COCO Explorer，我们可以探索COCO数据集。您可以使用<a class="ulink" href="http://cocodataset.org/#explore">http://cocodataset.org/#explore</a>URL来浏览数据集。可可探险家是伟大的用户界面。你只需要选择objects标签，比如<em>我想看图片中有一个人、一辆自行车和一辆公共汽车的图片</em>，浏览器会为你提供图片中有一个人、一辆自行车和一辆公共汽车的图片。可以参考下图:</p><div><img src="img/B08394_09_01.jpg" alt="The COCO dataset" width="801" height="843"/><div><p>图9.1: COCO数据集资源管理器片段</p></div></div><p>在每个图像中，已经为每个主要对象提供了适当的对象边界。这是<a id="id1048" class="indexterm"/>如果你想从零开始构建你自己的计算机视觉应用程序，这个数据集非常棒的主要原因。</p><p>在这里，我们不是<a id="id1049" class="indexterm"/>下载数据集，因为如果我们需要在这个数据集上从头开始训练模型，那么它将需要大量的时间和大量的GPU来获得良好的准确性。因此，我们将使用预训练的模型，并使用迁移学习，我们将实现实时对象检测。现在，我们来看看PASCAL VOC数据集。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec152"/>PASCAL VOC数据集</h2></div></div></div><p>PASCAL代表模式分析、统计建模和计算学习，VOC代表可视对象类。在这个数据集中，图像被标记为20类<a id="id1050" class="indexterm"/>用于对象<a id="id1051" class="indexterm"/>检测。动作类和个人布局标签也是可用的。在person layout taster标签中，边界框是关于人的每个部分(头、手、脚)的标签。你可以在http://host.robots.ox.ac.uk/pascal/VOC/voc2012/index.html的<a class="ulink" href="http://host.robots.ox.ac.uk/pascal/VOC/voc2012/index.html">查阅这个数据集的详细资料。</a></p><div><div><div><div><h3 class="title"><a id="ch09lvl3sec119"/>帕斯卡VOC类</h3></div></div></div><p>图像被分为四大类:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">人</li><li class="listitem" style="list-style-type: disc">动物</li><li class="listitem" style="list-style-type: disc">车辆</li><li class="listitem" style="list-style-type: disc">室内的</li></ul></div><p>每个图像都用前面的主要类别进行标记，另外还有给图像中的对象的特定标记。上述四个类别中的每一个都有特定的标签，我在下面的列表中描述了这些标签:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><strong>人物</strong>:人物</li><li class="listitem" style="list-style-type: disc"><strong>动物</strong>:鸟、猫、牛、狗、马、羊</li><li class="listitem" style="list-style-type: disc"><strong>交通工具</strong>:飞机、自行车、轮船、公共汽车、汽车、摩托车、火车</li><li class="listitem" style="list-style-type: disc"><strong>室内</strong>:瓶子、椅子、餐桌、盆栽、沙发、电视/显示器</li></ul></div><p>可以参考下图，帮助你理解这个PASCAL VOC数据集中的标注:</p><div><img src="img/B08394_09_02.jpg" alt="PASCAL VOC classes" width="502" height="329"/><div><p>图9.2: PASCAL VOC标记图像示例</p></div></div><p>正如你在前面的图中看到的<a id="id1053" class="indexterm"/>，两个主要的类被标记:人和动物。对于图像中出现的物体，即人和羊，已经给出了特定的标记。我们不下载此数据集；我们将使用预训练模型，该模型是使用此数据集训练的。</p><p>到目前为止，你已经听到了很多关于迁移学习和预训练模型的术语。我们来了解一下它们是什么。</p></div></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec89"/>迁移学习</h1></div></div></div><p>在本节<a id="id1054" class="indexterm"/>中，我们将了解什么是迁移学习，以及在我们构建实时对象检测时，它将如何对我们有用。我们<a id="id1055" class="indexterm"/>将本节分为以下几个部分:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">什么是迁移学习？</li><li class="listitem" style="list-style-type: disc">什么是预训练模型？</li><li class="listitem" style="list-style-type: disc">为什么要使用预先训练好的模型？</li><li class="listitem" style="list-style-type: disc">如何使用预先训练好的模型？</li></ul></div><p>先说第一个问题。</p><div><div><div><div><h2 class="title">什么是迁移学习？</h2></div></div></div><p>我们将首先着眼于迁移学习背后的直觉，然后，我们将涵盖它的技术定义。让我通过一个简单的师生类比来解释这个概念。教师在教授某些特定的课题或科目方面有多年的经验。无论老师有什么信息，他们都会传递给学生。所以，教学的过程就是把知识从老师传递给学生。可以参考下图:</p><div><img src="img/B08394_09_03.jpg" alt="What is Transfer Learning?" width="663" height="670"/><div><p>图9.3:迁移学习概述</p></div></div><p>现在，记住这个<a id="id1057" class="indexterm"/>类比；我们将把它应用于神经网络。当我们训练神经网络时，它从给定的数据集中获取知识。这个经过训练的神经网络有一些权重，帮助它从给定的数据集学习；训练之后，我们可以用二进制格式存储这些权重。我们以二进制格式存储的权重可以提取出来，然后传输到任何其他神经网络。因此，我们不是从头开始训练神经网络，而是转移先前训练的模型获得的知识。我们正在将学习到的特征转移到新的神经网络中，这将节省我们很多时间。如果我们已经有了一个特定应用的训练模型，那么我们将把它应用到新的但是相似类型的应用中，这反过来将有助于节省时间。</p><p>现在，是时候<a id="id1058" class="indexterm"/>用更专业的术语来定义迁移学习了。迁移学习是机器学习中的一个研究问题，它专注于存储在解决特定问题时获得的知识，并将其应用于不同但相关的问题。有时候，迁移学习也叫归纳迁移。我们举一个实实在在的例子来固化你的视野。如果我们建立一个在学习识别汽车时获得知识的机器学习模型，它也可以应用于我们试图识别卡车的时候。在本章中，我们将使用迁移学习来构建这个实时对象检测应用程序。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec154"/>什么是预训练模型？</h2></div></div></div><p>我想<a id="id1059" class="indexterm"/>给你一个简单的解释。预训练模型是由其他人创建和构建的，用于解决特定问题。这意味着我们正在使用一个已经被训练好的模型，并插入和使用它。通过使用预先训练的模型，我们可以构建具有相似领域的新应用程序。</p><p>我举个例子:假设我们想制造一辆自动驾驶汽车。为了建造它，我们的第一步是建造一个像样的物体识别系统。你可以花一年或更长时间从零开始构建像样的图像和对象识别算法，或者你可以使用预先训练好的模型，如谷歌inception模型或YOLO模型，后者是使用PASCAL VOC数据集构建的。</p><p>使用预先训练的模型有一些<a id="id1060" class="indexterm"/>优势，如下所示:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">一个预先训练好的模型不一定能给你100%的准确率，但却省了不少力气。</li><li class="listitem" style="list-style-type: disc">你可以优化你正在处理的真实问题的准确性，而不是从头开始做一个算法；正如我们有时所说，没有必要重新发明轮子。</li><li class="listitem" style="list-style-type: disc">有许多可用的库可以帮助我们保存训练好的模型，因此我们可以在需要时轻松地加载和使用它们。</li></ul></div><p>除了预训练模型为我们提供的优势之外，我们还需要理解为什么我们应该使用预训练模型的其他真正原因。因此，让我们在下一节讨论这个问题。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec155"/>为什么要使用预先训练好的模型？</h2></div></div></div><p>当我们<a id="id1061" class="indexterm"/>专注于以不同的方式开发现有算法时，我们的目标将是构建一个优于所有其他现有算法的算法，并使其更加高效。如果我们只关注研究部分，那么这可能是一个开发高效和准确算法的好方法，但是如果你的愿景是开发一个应用程序，并且这个算法是整个应用程序的一部分，那么你应该关注如何快速有效地构建应用程序。我们通过一个例子来理解这一点。</p><p>在这一章中，我们想要建立实时物体检测技术。现在，我的主要精力将放在构建一个能够实时检测物体的应用程序上。不仅如此；我还需要结合对象检测和实时跟踪活动。如果我忽略了我的主要目标，开始开发新的但是有效的目标检测算法，那么我将会失去注意力。我的重点将是构建整个实时对象检测应用程序，而不仅仅是某个算法。</p><p>有时，如果我们失去了重点，试图从头开始构建算法，那么这将花费大量时间。我们也会白费力气，因为世界上有些聪明人可能已经为我们建造好了。当我们使用这个已经开发的算法时，我们将节省时间并专注于我们的应用。在构建了我们实际应用程序的原型之后，我们将有时间对它进行即兴创作，以便它可以被许多其他人使用。</p><p>让我告诉你我的故事。几个月前，我开始构建一个可用于安全领域的图像检测应用程序。当时我不想用一个预先训练好的模型，因为我想探索一下从零开始构建一个算法需要付出多大的努力。所以，我开始自己做一个。我尝试了几种不同的算法，比如SVM、<strong>多层感知器</strong> ( <strong> MLP </strong>)、以及<strong>卷积神经网络</strong> ( <strong> CNN </strong>模型，但是我<a id="id1062" class="indexterm"/>得到的准确率真的很低。我不再专注于构建一个可用于安全领域的图像检测算法应用程序，而是开始专注于改进算法。过了一段时间，我意识到，如果我使用一个带有优化技术的预训练模型会更好，这将节省我的时间，并使我能够构建一个更好的解决方案。这次经历之后，我试图探索在我正在解决的问题陈述中使用迁移学习的选项，如果我发现没有迁移学习的余地，那么我会从头开始制作算法；否则，我更喜欢使用预先训练好的模型。因此，在构建算法之前，一定要探索所有的选项。了解应用程序的使用情况，并在此基础上构建您的解决方案。假设你正在打造自己的自动驾驶汽车；然后，实时物体检测将成为自动驾驶汽车的重要组成部分，但它将只是整个应用程序的一部分；因此，如果我们使用预先训练好的模型来检测物体，那会更好，这样我们就可以利用我们的时间来建造一辆优质的自动驾驶汽车。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec156"/>如何使用预先训练好的模型？</h2></div></div></div><p>一般来说，<a id="id1064" class="indexterm"/>预训练模型是二进制格式的，可以下载并在我们的应用程序中使用。有些库，比如Keras、TensorFlow、Darknet等等，已经有了那些预模型，您可以加载这些预模型并与某些可用的API一起使用。这些预先训练的网络能够通过迁移学习来概括不属于PASCAL VOC或COCO数据集的图像。我们可以通过微调模型来修改预先存在的模型。我们不想过多地修改权重，因为它已经在使用大量GPU的大型数据集上进行了训练。预训练的模型具有概括对象的预测和分类的能力，因此我们知道这个预训练的模型可以被概括到足以给我们最好的可能结果。但是，如果我们想从零开始训练模型，我们可以更改一些超参数。这些参数可以是学习速率、时期、层大小等等。让我们来讨论其中的一些:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">学习率:学习率<a id="id1065" class="indexterm"/>基本上控制了我们应该更新多少神经元的权重。我们可以使用固定学习率、递减学习率、基于动量的方法或自适应学习率。</li><li class="listitem" style="list-style-type: disc">历元数:<a id="id1066" class="indexterm"/>历元数表示整个训练数据集应该通过神经网络的次数。为了减少测试误差和训练误差之间的差距，我们需要增加历元的数量。</li><li class="listitem" style="list-style-type: disc">批量大小:对于<a id="id1067" class="indexterm"/>卷积神经网络，小批量通常更可取。对于卷积神经网络，16到128的范围确实是一个不错的选择。</li><li class="listitem" style="list-style-type: disc">激活函数:正如我们<a id="id1068" class="indexterm"/>所知，激活函数给模型引入了非线性。ReLU激活函数是卷积神经网络的首选。您也可以使用其他激活函数，如tanh、sigmoid等。</li><li class="listitem" style="list-style-type: disc">正则化的放弃:正则化技术用于防止过度拟合问题。Dropout是<a id="id1069" class="indexterm"/>深度神经网络的正则化技术。在这项技术中，我们去掉了神经网络中的一些神经元或单元。神经元的退出是基于概率值的。默认值为0.5，这是一个不错的选择，但我们可以在观察训练误差和测试误差后更改正则化的值。</li></ul></div><p>在这里，我们将使用预训练模型，如Caffe预训练模型<a id="id1070" class="indexterm"/>，TensorFow对象减损模型，以及<strong>你只看一次</strong> ( <strong> YOLO </strong>)。对于来自网络摄像头的实时流，我们使用OpenCV，这对于绘制边界框也很有用。所以首先，让我们设置OpenCV环境。</p></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec90"/>设置编码环境</h1></div></div></div><p>在这一节中，我们<a id="id1071" class="indexterm"/>将列出运行即将到来的代码所需的库和设备。你需要一个网络摄像头，至少可以清晰地播放视频。我们将使用OpenCV、TensorFlow、YOLO、Darkflow和Darknet库。我不打算解释如何安装TensorFlow，因为这是一个简单的过程，你可以通过点击<a class="ulink" href="https://www.tensorflow.org/install/install_linux">https://www.tensorflow.org/install/install_linux</a>找到安装的文档。</p><p>在这一节中，我们将首先看看如何设置OpenCV，在接下来的几节中，我们将看到如何设置YOLO、暗流和暗网。</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec157"/>设置和安装OpenCV</h2></div></div></div><p>OpenCV代表<a id="id1072" class="indexterm"/>开源<a id="id1073" class="indexterm"/>计算机视觉。它是为计算效率而设计的，非常注重实时应用。在本节中，您将学习如何<a id="id1074" class="indexterm"/>设置OpenCV。我用的是Ubuntu 16.04，有GPU，所以已经装了CUDA和CUDNN。如果你还没有安装CUDA和CUDNN，那么你可以参考这个GitHub链接:<a class="ulink" href="https://gist.github.com/vbalnt/a0f789d788a99bfb62b61cb809246d64">https://gist . GitHub . com/vbalnt/a 0 f 789d 788 a 99 bfb 62 b 61 CB 809246d 64</a>。完成后，开始执行以下步骤:</p><div><ol class="orderedlist arabic"><li class="listitem">这将更新<a id="id1075" class="indexterm"/>软件和库:<code class="literal">$ sudo apt-get update</code></li><li class="listitem">这将升级操作系统并安装操作系统级更新:<code class="literal">$ sudo apt-get upgrade</code></li><li class="listitem">这是用来编译软件的:<code class="literal">$ sudo apt-get install build-essential</code></li><li class="listitem">这个命令安装OpenCV的先决条件:<code class="literal">$ sudo apt-get install cmake git libgtk2.0-dev pkg-config libavcodec-dev libavformat-dev libswscale-dev</code></li><li class="listitem">这个命令安装OpenCV的可选先决条件:<code class="literal">$ sudo apt-get install python-dev python-numpy libtbb2 libtbb-dev libjpeg-dev libpng-dev libtiff-dev libjasper-dev    libdc1394-22-dev</code></li><li class="listitem">使用以下命令创建一个目录:<code class="literal">$ sudo mkdir ~/opencv</code></li><li class="listitem">跳转到我们刚刚创建的目录:<code class="literal">$ cd ~/opencv</code></li><li class="listitem">从GitHub的opencv目录中克隆以下OpenCV项目:<div><ol class="orderedlist arabic"><li class="listitem"><code class="literal">$ sudo git clone https://github.com/opencv/opencv.git</code></li><li class="listitem"><code class="literal">$ sudo git clone https://github.com/opencv/opencv_contrib.git</code></li></ol></div></li><li class="listitem">在opencv文件夹中，创建另一个名为build: <code class="literal">$ sudo mkdir ~/opencv/build</code>的目录</li><li class="listitem">跳转到构建目录或文件夹:<code class="literal">$ cd ~/opencv/build</code></li><li class="listitem">一旦您进入构建文件夹位置，运行这个命令。这可能需要一些时间。如果运行此<a id="id1077" class="indexterm"/>命令没有任何错误，则继续下一步:<div> <pre class="programlisting">$ sudo cmake -D CMAKE_BUILD_TYPE=RELEASE \ -D CMAKE_INSTALL_PREFIX=/usr/local \ -D INSTALL_C_EXAMPLES=ON \ -D INSTALL_PYTHON_EXAMPLES=ON \ -D WITH_TBB=ON \ -D WITH_V4L=ON \ -D WITH_QT=ON \ -D WITH_OPENGL=ON \ -D OPENCV_EXTRA_MODULES_PATH=../../opencv_contrib/modules \ -D BUILD_EXAMPLES=ON ..</pre> </div></li><li class="listitem">使用以下命令确定您有多少个CPU核心。:<code class="literal">$ nproc</code></li><li class="listitem">一旦知道了CPU的核心数，就可以用它来处理多线程了。我已经分配了四个CPU内核，这意味着有四个线程同时运行。这个命令是<code class="literal">$ make -j4</code>,它为OpenCV编译所有用C编写的类。</li><li class="listitem">现在，执行这个命令来实际安装OpenCV: <code class="literal">$ sudo make install</code></li><li class="listitem">将路径添加到配置文件:<code class="literal">$ sudo sh -c 'echo "/usr/local/lib" &gt;&gt; /etc/ld.so.conf.d/opencv.conf'</code></li><li class="listitem">使用以下命令检查配置是否正确:<code class="literal">$ sudo ldconfig</code></li></ol></div><p>一旦你成功安装了OpenCV，我们就可以使用这个库来传输实时视频。现在，我们将开始构建基线模型。我们开始吧！</p></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec91"/>特征工程为基线模型</h1></div></div></div><p>为了构建<a id="id1078" class="indexterm"/>基线模型，我们将使用带有<a id="id1080" class="indexterm"/>预训练权重的Google MobileNet SSD检测<a id="id1079" class="indexterm"/>网络的Caffe实现。该模型已经在PASCAL VOC数据集上进行了训练。因此，在这一节中，我们将看看谷歌训练这个模型的方法。我们将了解MobileNet SSD背后的基本方法，并使用预先训练的模型来帮助节省时间。为了创建这种精确的模型，我们需要大量的GPU和训练时间，所以我们使用预训练的模型。这个预先训练好的MobileNet模型使用<strong>卷积神经网络</strong> ( <strong> CNN </strong>)。</p><p>让我们看看<a id="id1081" class="indexterm"/>MobileNet如何使用CNN提取特征。这将帮助我们理解CNN背后的基本理念，以及MobileNet是如何被使用的。CNN网络由多个层组成，当我们向CNN提供图像时，它会扫描图像的<a id="id1083" class="indexterm"/>区域，并尝试使用区域提议方法提取可能的对象。然后，它找到带有对象的区域，使用扭曲区域，并生成CNN特征。这些特征可以是像素的位置、边缘、边缘的长度、图像的纹理、区域的比例、图片的亮度或暗度、对象部分等等。CNN网络自己学习这些类型的特征。可以参考下图:</p><div><img src="img/B08394_09_04.jpg" alt="Features engineering for the baseline model" width="1000" height="709"/><div><p>图9.4:理解CNN中的特征提取</p></div></div><p>正如你在前面的<a id="id1084" class="indexterm"/>图中看到的，图像的区域已经被扫描，由C1和S1组成的第一个CNN图层将生成这些特征。这些特征可以识别最终构建整个对象的边缘的表示。在第二阶段，CNN层<a id="id1085" class="indexterm"/>学习可以帮助神经网络识别物体部分的特征表示。在<a id="id1086" class="indexterm"/>的最后阶段，它学习所有必要的特征，以识别给定输入图像中存在的物体。如果你想探索CNN网络的每一个方面，你可以参考<a class="ulink" href="http://cs231n.github.io/convolutional-networks/">http://cs231n.github.io/convolutional-networks/</a>。不用担心；我们将在接下来的章节中介绍CNN架构的概述，以便您能够理解对象检测是如何工作的。现在，是时候探索CNN了。</p></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec92"/>选择机器学习算法</h1></div></div></div><p>我们已经知道<a id="id1087" class="indexterm"/>我们正在使用<strong>卷积神经网络</strong> ( <strong> CNN </strong>)来开发这个应用程序。你可能想知道为什么我们选择了CNN而不是另一个神经网络。你可能已经知道这个问题的答案了。我们选择CNN有三个原因:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">如今，大量的视觉数据被小心地手工标注</li><li class="listitem" style="list-style-type: disc">负担得起的计算机器，通过它GPU打开了优化的大门</li><li class="listitem" style="list-style-type: disc">CNN的各种结构优于其他算法</li></ul></div><p>由于这些原因，我们选择了带SSD的CNN。在基线模型的开发过程中，我们将使用MobileNet，它使用CNN，下面有<strong>单发探测器</strong> ( <strong> SSD </strong>)技术<a id="id1089" class="indexterm"/>。因此，在这一节中，我们将看看在MobileNet开发过程中使用的CNN的架构。这将有助于我们理解预先训练的模型。</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec158"/>MobileNet SSD模型的架构</h2></div></div></div><p>MobileNet SSD速度很快，并且<a id="id1090" class="indexterm"/>在图像和视频中很好地完成了对象检测的工作<a id="id1091" class="indexterm"/>。这个模型比<strong>基于区域的卷积神经网络</strong> ( <strong> R-CNN </strong>)更快。SSD达到这个速度是因为它扫描图像和视频帧的方式非常不同。</p><p>在R-CNN中，模型在两个不同的步骤中执行<a id="id1093" class="indexterm"/>区域提议和区域分类，如下所示:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">首先，他们使用区域提议网络来生成感兴趣的区域</li><li class="listitem" style="list-style-type: disc">之后，全连接层或正敏感构成层对所选区域中的对象进行分类。</li></ul></div><p>这些步骤<a id="id1094" class="indexterm"/>与R-CNN相同，但是SSD在单次拍摄中执行它们，这意味着它同时预测边界框和出现在边界框中的对象的类别。当图像或视频流和一组基本事实标签作为输入被给出时，SDD执行以下步骤:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">将图像通过一系列卷积层，这些卷积层以不同大小的矩阵形式生成特征映射集。输出可以是10×10矩阵、6×6矩阵或3×3矩阵的形式。</li><li class="listitem" style="list-style-type: disc">对于每个特征图中的每个位置，使用3×3卷积滤波器来评估一小组默认边界框。这些生成的默认边界框相当于锚框，是使用更快的R-CNN生成的。</li><li class="listitem" style="list-style-type: disc">对于每个框，同时预测对象的边界框偏移和类别概率。</li><li class="listitem" style="list-style-type: disc">在培训过程中，将基本事实框与这些预测框相匹配。这种匹配是通过使用并集交集(IoU)来执行的。最佳预测框将被标记为正边界框。每个边界框都会发生这种情况。这里已经考虑了具有超过50%真实值的借据。</li></ul></div><p>请看下图的图形表示。MobileNets具有流线型的架构，该架构使用深度方向可分离的卷积，以便为移动和嵌入式视觉应用构建轻量级深度神经网络。对于计算机视觉应用，MobileNets是一种更有效的ML模型。你也可以参考MobileNet在<a class="ulink" href="https://arxiv.org/pdf/1704.04861.pdf">https://arxiv.org/pdf/1704.04861.pdf</a>的原始论文。</p><div><img src="img/B08394_09_05.jpg" alt="Architecture of the MobileNet SSD model" width="333" height="222"/><div><p>图9.5:MobileNet SSD的基本架构构建模块</p><p>图片来源:https://arxiv.org/pdf/1704.04861.pdf</p></div></div><p>正如你<a id="id1095" class="indexterm"/>在前面的图中看到的，我们<a id="id1096" class="indexterm"/>使用了标准卷积网络和深度卷积网络。SDD移动网络使用ReLU激活功能。可以参考下图，了解一下这个网络是什么样的滤波器形状:</p><div><img src="img/B08394_09_06.jpg" alt="Architecture of the MobileNet SSD model" width="334" height="369"/><div><p>图9.6，MobileNet主体架构</p><p>图片来源:https://arxiv.org/pdf/1704.04861.pdf</p></div></div><p>如果你想<a id="id1097" class="indexterm"/>解读这个表格，那么让我们<a id="id1098" class="indexterm"/>考虑一个例子。如果我们有一个像素为224×224的原始图像，那么这个Mobilenet网络将图像缩小到7×7像素；它还有1024个频道。在此之后，有一个平均池层，它作用于所有图像并生成1×1×1，024大小的向量，这实际上只是1，024个元素的向量。如果您想了解有关MobileNet SSD的更多信息，请参考以下资源:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://cs231n.github.io/convolutional-networks/">http://cs231n.github.io/convolutional-networks/</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="https://towardsdatascience.com/deep-learning-for-object-detection-a-comprehensive-review-73930816d8d9">https://towardsdatascience . com/deep-learning-for-object-detection-a-comprehensive-review-73930816 d8d 9</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="https://medium.com/ilenze-com/object-detection-using-deep-learning-for-advanced-users-part-1-183bbbb08b19">https://medium . com/ilenze-com/object-detection-using-deep-learning-for-advanced-users-part-1-183 bbbb 08 b 19</a></li><li class="listitem" style="list-style-type: disc"><a class="ulink" href="http://machinethink.net/blog/googles-mobile-net-architecture-on-iphone/">http://machine think . net/blog/Google s-mobile-net-architecture-on-iphone/</a></li></ul></div><p>现在，让我们转到实现部分。</p></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec93"/>建立基线模型</h1></div></div></div><p>在这个<a id="id1099" class="indexterm"/>部分，我们将看看编码部分。可以参考这个GitHub链接给出的代码:<a class="ulink" href="https://github.com/jalajthanaki/Real_time_object_detection/tree/master/base_line_model">https://GitHub . com/jalajthanaki/Real _ time _ object _ detection/tree/master/base _ line _ model</a>。</p><p>首先，按照本章前面给出的信息，从给定的链接下载项目并安装OpenCV。当你下载这个项目文件夹的时候，有一个<a id="id1100" class="indexterm"/>预训练的MobileNet SSD已经使用caffe库实现了，但是在这里，我们使用的是预训练的二进制模型。我们使用OpenCV加载预训练模型，并从网络摄像头传输视频。</p><p>在代码中，首先，我们指定需要导入的库，并定义将用于运行脚本的命令行参数。我们需要提供参数文件和预训练的模型。参数文件名为<code class="literal">MobileNetSSD_deploy.prototxt.txt</code>，预训练模型的文件名为<code class="literal">MobileNetSSD_deploy.caffemodel</code>。我们还定义了模型可以识别的类。之后，我们将使用OpenCV加载预训练的模型。您可以在下面的截图中参考到此阶段的编码:</p><div><img src="img/B08394_09_07.jpg" alt="Building the baseline model" width="1000" height="505"/><div><p>图9.7:基线模型的代码片段</p></div></div><p>现在，让我们看看如何通过网络摄像头传输视频。在这里，我们使用库<code class="literal">imutils</code>和它的视频API从网络摄像头传输视频。使用start函数，我们将开始流式传输，之后，我们将定义帧大小。我们获取帧大小并将其转换为blob格式。该代码始终验证检测到的对象置信分数<a id="id1101" class="indexterm"/>将高于最小置信分数或<a id="id1102" class="indexterm"/>置信分数的最小阈值。一旦我们得到了更高的置信度，我们将为这些对象绘制边界框。我们可以看到目前已经探测到的物体。基线模型的视频流可以参考下图:</p><div><img src="img/B08394_09_08.jpg" alt="Building the baseline model" width="654" height="852"/><div><p>图9.8:基线模型视频流的代码片段</p></div></div><p>为了停止流，我们需要通过按Q或Ctrl + C来打破循环，并且我们需要注意当<a id="id1103" class="indexterm"/>我们关闭<a id="id1104" class="indexterm"/>程序时，所有的窗口和进程将适当地停止。你可以在下面的截图中看到这一点:</p><div><img src="img/B08394_09_09.jpg" alt="Building the baseline model" width="553" height="172"/><div><p>图9.9:结束脚本的代码片段</p></div></div><p>在我们运行脚本测试之前，让我们了解对象检测应用程序的测试指标。一旦我们理解了测试标准，我们将运行代码并检查我们得到了多少准确性。</p></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec94"/>理解测试指标</h1></div></div></div><p>在这个<a id="id1105" class="indexterm"/>部分，我们将介绍测试<a id="id1106" class="indexterm"/>指标。我们将看看这两个矩阵，它们将帮助我们理解如何测试对象检测应用程序。这些测试矩阵如下:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">并集上的交集</li><li class="listitem" style="list-style-type: disc">平均精度</li></ul></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec159"/>并集上的交集(IoU)</h2></div></div></div><p>对于<a id="id1107" class="indexterm"/>检测，使用IoU<a id="id1108" class="indexterm"/>以查明对象提议是否正确。这是确定对象检测是否完美完成的常规方法。IoU通常采用建议对象像素组A和真实对象像素组B，并根据以下公式计算IoU:</p><div><img src="img/B08394_09_30.jpg" alt="Intersection over Union (IoU)" width="164" height="52"/></div><p>通常，IoU &gt;0.5，这意味着<a id="id1109" class="indexterm"/>是命中或者它识别了对象的对象像素或边界框；否则，它会失败。这是对借据更正式的理解。现在，让我们<a id="id1110" class="indexterm"/>看看直觉和它背后的意义。让我们以一个图像作为参考，帮助我们理解这个矩阵背后的直觉。可以参考以下截图:</p><div><img src="img/B08394_09_10.jpg" alt="Intersection over Union (IoU)" width="684" height="569"/><div><p>图9.10:理解欠条背后的直觉</p></div></div><p>前面的<a id="id1111" class="indexterm"/>截图是检测图像中停车标志的一个例子。预测边界框以红色绘制，属于该红色框的像素被视为集合A的一部分，而地面实况边界框以绿色绘制，属于该<a id="id1112" class="indexterm"/>绿色框的像素被视为集合b的一部分。我们的目标是计算这些边界框之间的交集。因此，当我们的应用程序绘制一个边界框时，它应该与地面实况边界框匹配至少50%以上，这被认为是一个好的预测。下图给出了IoU的计算公式:</p><div><img src="img/B08394_09_11.jpg" alt="Intersection over Union (IoU)" width="654" height="464"/><div><p>图9.11:基于直觉理解的IoU方程</p></div></div><p>现实中，我们预测的边界框的(x，y)坐标与真实边界框的(x，y)坐标精确匹配的机会很少。在下图中，您<a id="id1113" class="indexterm"/>可以看到差、好、优借条的各种例子:</p><div><img src="img/B08394_09_12.jpg" alt="Intersection over Union (IoU)" width="664" height="341"/><div><p>图9.12:各种IoU边界框示例</p></div></div><p>IoUs帮助我们<a id="id1114" class="indexterm"/>确定应用程序识别对象边界和区分不同对象的能力。现在，是时候了解下一个测试指标了。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec160"/>平均精度均值</h2></div></div></div><p>在此<a id="id1115" class="indexterm"/>部分，我们将涵盖<strong>平均精度</strong> ( <strong>图</strong>)。在对象检测中，首先，我们<a id="id1116" class="indexterm"/>识别对象边界框，然后我们将其分类。这些类别有一些标签，我们为被识别的对象提供适当的标签。现在，我们需要测试应用程序如何分配这些标签，这意味着我们如何将对象分类到不同的预定义类别中。对于每个类别，我们将计算以下内容:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">真正TP(c):一个预测的类是C，并且该对象实际上属于类C</li><li class="listitem" style="list-style-type: disc">误报FP(c):预测的类别是C，但实际上，该对象不属于类别C</li><li class="listitem" style="list-style-type: disc">C类的平均精度由以下等式给出:<div> <img src="img/B08394_09_31.jpg" alt="mean Average Precision" width="415" height="62"/> </div></li></ul></div><p>因此，对于所有的<a id="id1117" class="indexterm"/>类，我们需要计算mAP，等式如下:</p><div><img src="img/B08394_09_32.jpg" alt="mean Average Precision" width="338" height="62"/></div><p>如果我们<a id="id1118" class="indexterm"/>想要更好的预测，那么我们需要将IoU从0.5提高到更高的值(提高到1.0，这将是完美的)。我们可以用这个等式来表示:mAP <sub> @p </sub>，其中p ∈ (0，1)是IoU。mAP <sub> @[0.5:0.95] </sub>表示在多个阈值上计算mAP，然后再次对其进行平均。</p><p>现在，让我们测试基线模型并检查这个实现的映射。</p></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec95"/>测试基线模型</h1></div></div></div><p>在本节中，我们<a id="id1119" class="indexterm"/>将运行<a id="id1120" class="indexterm"/>基线模型。为了运行该脚本，我们需要跳转到放置名为<code class="literal">real_time_object_detection.py</code>的脚本的位置，并且在命令提示符下，我们需要执行以下命令:</p><div><img src="img/B08394_09_13.jpg" alt="Testing the baseline model" width="1000" height="81"/><div><p>图9.13:基线方法的执行</p></div></div><p>看一下下图。在这里，我只是放置了示例图像，但是当您运行脚本时，您可以看到整个<a id="id1121" class="indexterm"/>视频。下面是使用基线方法进行实时物体检测的完整视频的链接:<a class="ulink" href="https://drive.google.com/drive/folders/1RwKEUaxTExefdrSJSy44NugqGZaTN_BX?usp=sharing">https://drive . Google . com/drive/folders/1 rwkeueaxtexefdrsjsy 44 nugqgzatn _ BX？usp =分享</a>。</p><div><img src="img/B08394_09_14.jpg" alt="Testing the baseline model" width="502" height="377"/><div><p>图9.14:基线方法的输出(图像是视频流的一部分)</p></div></div><p>这里，MobileNet SSD的<a id="id1122" class="indexterm"/>图为71.1%。在下一节中，您将了解如何优化这种方法。首先，我们将列出我们在下一次迭代中可以改进的点。那么，让我们跳到下一部分。</p></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec96"/>现有方法的问题</h1></div></div></div><p>虽然<a id="id1123" class="indexterm"/> MobileNet SSD速度很快，给了我们很好的结果，但它仍然无法识别杯子、钢笔等类别。所以，我们需要使用已经在各种对象上训练过的预训练模型。在即将到来的迭代中，我们需要使用预训练模型，例如TensorFlow对象检测API，它将能够识别与基线方法相比不同的对象。现在，让我们看看我们将如何优化现有的方法。</p></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec97"/>如何优化现有方法</h1></div></div></div><p>正如前面提到的<a id="id1124" class="indexterm"/>，为了优化现有的方法，我将使用TensorFlow对象检测API。你可以在下面的链接参考Google关于这个API的tensor flow GitHub repo:<a class="ulink" href="https://github.com/tensorflow/models/tree/master/research/object_detection">https://GitHub . com/tensor flow/models/tree/master/research/object _ detection</a>。该API使用COCO数据集和PASCAL VOC数据集进行训练；因此，它将具有识别各种类别的能力。</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec161"/>了解优化流程</h2></div></div></div><p>对我们来说，最重要的部分是如何使用各种预先训练好的模型。步骤如下:</p><div><ol class="orderedlist arabic"><li class="listitem">首先，使用以下链接获取TensorFlow模型存储库:<a class="ulink" href="https://github.com/tensorflow/models">https://github.com/tensorflow/models</a></li><li class="listitem">一旦您提取了存储库，您就可以找到我提到的iPython笔记本，以便了解如何使用预训练模型，并在<a class="ulink" href="https://github.com/tensorflow/models/blob/master/research/object_detection/object_detection_tutorial.ipynb">https://github . com/tensor flow/models/blob/master/research/object _ detection/object _ detection _ tutorial . ipynb</a>中找到iPython笔记本的链接。</li><li class="listitem">这里用的是带MobileNet的SSD，但是我们用的是检测模型zoo。该模型在COCO数据集上训练，并且基于模型的速度和性能给出它们的版本。可以从这个链接下载预训练好的模型:<a class="ulink" href="https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/detection_model_zoo.md">https://github . com/tensor flow/models/blob/master/research/object _ detection/g3doc/detection _ model _ zoo . MD</a>。我已经把这些部分都放在一起了，所以大家很容易实现代码。</li><li class="listitem">最重要的是，这个模型是使用SSD方法训练的，但它采用了kitti数据集和Open Image数据集等数据集。因此，该模型能够检测更多的目标，具有更好的通用性。Kitti数据集的链接是<a class="ulink" href="http://www.cvlibs.net/datasets/kitti/">http://www.cvlibs.net/datasets/kitti/</a>，Open Image数据集的链接是<a class="ulink" href="https://github.com/openimages/dataset">https://github.com/openimages/dataset</a>。</li></ol></div><p>一旦我们<a id="id1127" class="indexterm"/>下载了存储库和预训练模型，我们将加载预训练模型。众所周知，在TensorFlow中，模型被保存为. pb文件。一旦我们加载了模型，我们将使用OpenCV来传输视频。在接下来的部分中，我们将为修改后的方法实现代码。</p></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec98"/>实施修订后的方法</h1></div></div></div><p>在本节中，我们<a id="id1128" class="indexterm"/>将了解修改后的方法的实施。可以参考这个GitHub链接:<a class="ulink" href="https://github.com/jalajthanaki/Real_time_object_detection/tree/master/revised_approach">https://GitHub . com/jalajthaaki/Real _ time _ Object _ detection/tree/master/revised _ approach</a>，里面有预先训练好的模型和TensorFlow的对象<a id="id1129" class="indexterm"/>检测文件夹。在我们开始编写代码之前，我将提供关于这种方法的文件夹结构的信息。可以参考下图:</p><div><img src="img/B08394_09_15.jpg" alt="Implementing the revised approach" width="319" height="154"/><div><p>图9.15:理解修订方法的文件夹结构</p></div></div><p>下面是从TensorFlow模型库下载的对象检测文件夹:<a class="ulink" href="https://github.com/tensorflow/models/tree/master/research/object_detection">https://github . com/tensor flow/models/tree/master/research/object _ detection</a>。在<code class="literal">utils</code>文件夹中，有一些帮助器功能可以帮助我们流式播放视频。帮助我们运行脚本的主脚本是<code class="literal">object_detection_app.py</code>。预训练模型已保存在对象检测文件夹中。预训练模型在该文件夹中的路径是:<code class="literal">~/PycharmProjects/Real_time_object_detection/revised_approach/object_detection/ssd_mobilenet_v1_coco_11_06_2017/frozen_inference_graph.pb</code>。</p><p>现在，让我们一步一步地看编码实现。在第一步中，我们将导入依赖库并加载预先训练好的模型。可以参考下图:</p><div><img src="img/B08394_09_16.jpg" alt="Implementing the revised approach" width="914" height="614"/><div><p>图9.16:在修订的方法中加载预训练模型的代码片段</p></div></div><p>在这个模型中，有90种不同类型的物体可以被识别。一旦我们加载了模型，下一步就是<code class="literal">detect_objects()</code>函数，它用于识别对象。一旦对象被识别，该对象的边界框被绘制，并且我们同时对这些对象运行预先训练的模型，以便我们可以获得该对象的识别标签，无论它是杯子、瓶子、人等等。可以参考下图:</p><div><img src="img/B08394_09_17.jpg" alt="Implementing the revised approach" width="822" height="550"/><div><p>图9.17:detect _ objects()函数的代码片段</p></div></div><p>在这之后，我们有了<code class="literal">worker()</code>函数，它帮助我们流式传输视频以及执行一些GPU内存<a id="id1131" class="indexterm"/>管理。可以参考下图:</p><div><img src="img/B08394_09_18.jpg" alt="Implementing the revised approach" width="670" height="482"/><div><p>图9.18:worker()函数的代码片段</p></div></div><p>正如你所看到的，我们已经定义了GPU内存份额，以及当它检测到物体时使用的颜色种类。现在，让我们看看脚本的主要功能。在main函数中，我们定义了一些可选参数及其默认值。这些参数列表如下:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">摄像机的设备索引:<code class="literal">--source=0</code></li><li class="listitem" style="list-style-type: disc">视频流中帧的宽度<code class="literal">--width= 500</code></li><li class="listitem" style="list-style-type: disc">视频流中帧的高度<code class="literal">--height= 500</code></li><li class="listitem" style="list-style-type: disc">工人数量<code class="literal">--num-workers=2</code></li><li class="listitem" style="list-style-type: disc">队列的大小<code class="literal">--queue-size=5</code></li></ul></div><p>可以参考下图所示主要功能的实现:</p><div><img src="img/B08394_09_19.jpg" alt="Implementing the revised approach" width="816" height="899"/><div><p>图9.19:主函数的代码片段</p></div></div><p>当我们运行脚本时，我们可以<a id="id1133" class="indexterm"/>看到下图中给出的输出。在这里，我们放置了图像，但您可以通过以下链接观看视频:</p><p><a class="ulink" href="https://drive.google.com/drive/folders/1RwKEUaxTExefdrSJSy44NugqGZaTN_BX?usp=sharing">https://drive . Google . com/drive/folders/1 rwkeueaxtexefdrsjsy 44 nugqgzatn _ BX？usp =共享</a></p><div><img src="img/B08394_09_20.jpg" alt="Implementing the revised approach" width="490" height="428"/><div><p>图9.20:修订方法的输出</p></div></div><p>
</p><p>一旦我们结束视频，资源和流程<a id="id1134" class="indexterm"/>也应该结束。为此，我们将使用通过下图提供给我们的代码:</p><div><img src="img/B08394_09_21.jpg" alt="Implementing the revised approach" width="235" height="61"/><div><p>图9.21:脚本终止后释放资源的代码片段</p></div></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec162"/>测试修订后的方法</h2></div></div></div><p>一旦我们执行了这种方法，我们就可以识别诸如杯子、钢笔等物体。因此，我们可以说，我们的基线方法绝对是即兴的，有一些修改过的标签，如沙发(在这种方法中，标识为沙发)。除此之外，如果我们谈论这个预训练模型的地图，那么根据文档，在COCO数据集上，这个模型获得大约52.4%的准确性。在我们的输入中，我们将获得大约73%的准确率。这种方法可以识别更多不同类别的对象，这是一个很大的优势。</p><p>在接下来的部分，我们将讨论可以用来提出最佳解决方案的要点。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec163"/>了解修订方法的问题</h2></div></div></div><p>我们<a id="id1136" class="indexterm"/>已经尝试了快速、准确的方法，但是我们需要一种快速、准确、优化的方法。在开发最佳解决方案时，我们需要牢记以下几点:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">基于SSD的方法很好，但当您使用COCO或PASCAL VOC数据集训练自己的模型时，就不那么准确了。</li><li class="listitem" style="list-style-type: disc">TensorFlow检测模型zoo在COCO测试数据集上的mAP得分将从20%到40%。因此，我们需要探索其他技术来帮助我们在处理和对象检测准确性方面给出更好的结果。</li></ul></div><p>因此，在接下来的部分中，我们将看看可以帮助我们优化修订方法的方法。</p></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec99"/>最佳方法</h1></div></div></div><p>在这一部分，我们<a id="id1137" class="indexterm"/>将尝试名为<strong> YOLO </strong>的方法。YOLO代表你只看一眼。这个<a id="id1138" class="indexterm"/>技术给了我们很好的准确性，很快，并且它的内存管理很容易。本节将分为两部分:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">了解YOLO</li><li class="listitem" style="list-style-type: disc">使用YOLO实施最佳方法</li></ul></div><p>在第一部分，我们将了解关于YOLO的基本知识。在实施过程中，我们将使用YOLO和预训练的YOLO模型。那么，让我们开始吧！</p><div><div><div><div><h2 class="title"><a id="ch09lvl2sec164"/>了解YOLO</h2></div></div></div><p>YOLO是一个最先进的实时物体探测系统。在GPU Titan X上，它以40-90 FPS的速度处理图像，在PASCAL VOC数据集上的映射为78.6%，在coco test-dev数据集上的映射为48.1%。所以，现在，我们将看看YOLO是如何工作和处理图像来识别物体的。我们使用的是YOLOv2 (YOLO版本2)，因为它是一个更快的版本。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec165"/>YOLO的工作</h2></div></div></div><p>YOLO重构了<a id="id1141" class="indexterm"/>物体探测问题。它认为对象识别任务是一个单一的回归问题，从图像像素到包围盒坐标和类概率。单个卷积网络同时预测多个边界框和这些框的类别概率。YOLO在全图像上训练，直接优化检测性能。与传统方法相比，这种方法有以下几个优点:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">YOLO速度极快。这个<a id="id1142" class="indexterm"/>是因为，在YOLO，帧检测是一个回归问题，我们不需要使用复杂的流水线。</li><li class="listitem" style="list-style-type: disc">我们可以简单地在测试时对新图像运行我们的神经网络来预测检测。我们的基础网络在Titan X GPU上以每秒45帧的速度运行，没有批处理，快速版本的运行速度超过150 fps。这意味着我们可以实时处理流视频，延迟不到25毫秒。</li></ul></div><p>当YOLO对有关类别及其外观的信息进行预测时，它会对图像进行全局处理。它还学习对物体的概括。</p><p>YOLO把输入图像分成一个S×S的网格。如果一个物体的中心落在一个网格单元中，那么这个网格单元负责检测这个物体。每个网格单元预测B边界框和这些框的置信度得分。这些置信度得分反映了模型对盒子包含对象的置信度，以及它认为它预测的盒子有多准确。所以，形式上，我们可以用这个符号来定义YOLO的信任机制。我们将置信度定义为Pr(object) * IoU。如果该单元中不存在任何对象，则置信度得分应该为零；否则，我们希望置信度得分等于预测框和实际情况之间的IoU。每个边界框由五个预测组成:x、y、w、h和置信度。(x，y)坐标表示相对于网格单元边界的盒子中心。w和h代表宽度和高度。它们被预言与整个图像相关。最后，信心<a id="id1143" class="indexterm"/>分数代表欠条。对于每个网格单元，它预测C个条件类概率，<em> Pr(Classi|Object) </em>。这些概率取决于包含对象的网格单元。我们只预测每个网格单元的一组类别概率，而不考虑边界框b的数量。在测试时，我们将条件类别概率与由以下等式定义的单个框置信度预测相乘:</p><div><img src="img/B08394_09_33.jpg" alt="The working of YOLO" width="488" height="34"/></div><p>前面的等式给出了每个盒子的特定于类别的置信度得分。这个分数包含类出现在框中的概率以及预测的框与对象的匹配程度。YOLO整个过程的图示如下图所示:</p><div><img src="img/B08394_09_22.jpg" alt="The working of YOLO" width="711" height="632"/><div><p>图9.22:YOLO物体探测的图示</p></div></div><p>现在，让我们来了解一下YOLO建筑的基本知识。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec166"/>YOLO的建筑</h2></div></div></div><p>在这一部分，你<a id="id1144" class="indexterm"/>将学习关于YOLO建筑的基础知识。在YOLO，有24个卷积层，后面是两个全连接层。YOLO没有使用谷歌网络使用的初始模块，而是简单地使用1×1缩减层，然后是3×3卷积层。快速YOLO使用卷积层数较少的神经网络。我们用9层而不是24层。我们也在这些层中使用较少的过滤器。除此之外，在训练和测试期间，YOLO和快速YOLO的所有参数都是相同的。可以参考下图的架构:</p><div><img src="img/B08394_09_23.jpg" alt="The architecture of YOLO" width="1000" height="698"/><div><p>图9.23:YOLO的建筑</p></div></div><p>现在，让我们转到实现部分。</p></div><div><div><div><div><h2 class="title"><a id="ch09lvl2sec167"/>使用YOLO实施最佳方法</h2></div></div></div><p>为了<a id="id1145" class="indexterm"/>实现YOLO，我们需要安装Cython模块。除此之外，您可以使用Darknet或Darkflow，它是Darknet上的TensorFlow包装器。Darknet是用C和CUDA写的，所以还是挺快的。在这里，我们将实现这两个选项。在实现之前，我们需要设置环境。这里的实现部分应该分为两个部分:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">使用暗网实现</li><li class="listitem" style="list-style-type: disc">使用暗流实现</li></ul></div><p>所有代码可以参考这个GitHub资源库:<a class="ulink" href="https://github.com/jalajthanaki/Real_time_object_detection_with_YOLO">https://GitHub . com/jalajthanaki/Real _ time _ object _ detection _ with _ YOLO</a>。</p><div><div><div><div><h3 class="title"><a id="ch09lvl3sec120"/>使用暗网实现</h3></div></div></div><p>为了使用Darknet实现<a id="id1148" class="indexterm"/> YOLO，我们<a id="id1146" class="indexterm"/>遵循<a id="id1147" class="indexterm"/>这些步骤:</p><div><ul class="itemizedlist"><li class="listitem" style="list-style-type: disc">暗网的环境设置</li><li class="listitem" style="list-style-type: disc">编译暗网</li><li class="listitem" style="list-style-type: disc">下载预先训练的重量</li><li class="listitem" style="list-style-type: disc">对图像运行对象检测</li><li class="listitem" style="list-style-type: disc">对视频流运行对象检测</li></ul></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec53"/>暗网环境设置</h4></div></div></div><p>在这一步，我们<a id="id1149" class="indexterm"/>需要下载Darknet的GitHub库。我们可以使用下面的命令来实现。您可以从任何路径下载该存储库:</p><div><pre class="programlisting">$ git clone https://github.com/pjreddie/darknet</pre></div><p>一旦运行这个命令，就会创建名为Darknet的目录。之后就可以跳到下一步了。</p></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec54"/>编译暗网</h4></div></div></div><p>一旦我们下载了暗网，我们需要跳转到名为暗网的目录。之后，我们需要编译暗网。因此，我们需要依次执行以下命令:</p><div><pre class="programlisting">
$ cd darknet
$ make
</pre></div></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec55"/>下载预训练体重</h4></div></div></div><p>配置文件<a id="id1151" class="indexterm"/>已经在darknet目录下的<code class="literal">cfg/</code>子目录中。因此，通过执行以下命令，您可以下载YOLO模型的预训练权重:</p><div><pre class="programlisting">$ wegt https://pjreddie.com/media/files/yolo.weights</pre></div><p>此下载可能需要一些时间。一旦我们有了预先训练好的重量，我们就可以运行暗网了。</p></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec56"/>对图像进行目标检测</h4></div></div></div><p>如果你想识别图像中的物体，那么你需要执行下面的命令:</p><div><pre class="programlisting">./darknet detect cfg/yolo.cfg yolo.weights data/dog.jpg</pre></div><p>你可以参考下图中这个<a id="id1152" class="indexterm"/>命令的输出:</p><div><img src="img/B08394_09_24.jpg" alt="Running object detection for the image" width="1000" height="562"/><div><p>图9.24:使用暗网对图像进行对象检测的输出</p></div></div><p>现在，让我们在视频流上实现YOLO。</p></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec57"/>对视频流运行目标检测</h4></div></div></div><p>我们可以使用以下命令在视频流上运行YOLO:</p><div><pre class="programlisting">./darknet detector demo cfg/coco.data cfg/yolo.cfg yolo.weights &lt;video file&gt;</pre></div><p>这里，我们需要传递视频的路径。更多信息可以参考这个暗网文档:【https://pjreddie.com/darknet/yolo/<a class="ulink" href="https://pjreddie.com/darknet/yolo/">。现在，让我们来了解一下Darkflow的实现。</a></p></div></div><div><div><div><div><h3 class="title"><a id="ch09lvl3sec121"/>使用暗流实现</h3></div></div></div><p>在这个<a id="id1153" class="indexterm"/>实现中，您需要引用名为Darkflow的文件夹中给出的代码。我们需要按照<a id="id1155" class="indexterm"/>步骤执行<a id="id1154" class="indexterm"/>:</p><div><ol class="orderedlist arabic"><li class="listitem">安装Cython</li><li class="listitem">构建已经提供的安装文件</li><li class="listitem">测试环境</li><li class="listitem">加载模型并在图像上运行对象检测</li><li class="listitem">加载模型并在视频流上运行对象检测</li></ol></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec58"/>安装Cython</h4></div></div></div><p>为了<a id="id1156" class="indexterm"/>安装Cython，我们需要<a id="id1157" class="indexterm"/>执行以下命令。之所以需要这个Cython包，是因为Darkflow是一个Python包装器，它使用了Darknet中的C代码:</p><div><pre class="programlisting">$ sudo apt-get install Cython</pre></div><p>一旦安装了Cython，我们就可以构建另一个设置。</p></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec59"/>构建已经提供的设置文件</h4></div></div></div><p>在这个阶段，我们<a id="id1158" class="indexterm"/>将执行为我们建立必要的Cython环境的命令。该命令如下所示:</p><div><pre class="programlisting">$ python setup.py build_ext --inplace</pre></div><p>当我们执行这个命令时，我们将不得不在克隆的Darkflow目录中使用<code class="literal">./flow</code>而不是flow，因为Darkflow不是全局安装的。一旦这个命令成功运行，我们需要测试我们是否完美地安装了所有的依赖项。您可以使用以下命令下载预训练体重:</p><div><pre class="programlisting">$ wegt https://pjreddie.com/media/files/yolo.weights</pre></div></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec60"/>测试环境</h4></div></div></div><p>在这个阶段，我们将测试Darkflow <a id="id1159" class="indexterm"/>是否完美运行。为了检查这一点，我们需要执行以下命令:</p><div><pre class="programlisting">$ ./flow --h</pre></div><p>可以参考下图:</p><div><img src="img/B08394_09_25.jpg" alt="Testing the environment" width="1000" height="697"/><div><p>图9.25:暗流的成功测试结果</p></div></div><p>一旦您可以看到前面的<a id="id1160" class="indexterm"/>输出，您就会知道您已经成功地配置了暗流。现在，让我们运行它。</p></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec61"/>加载模型并在图像上运行对象检测</h4></div></div></div><p>我们可以在图像上运行<a id="id1161" class="indexterm"/>暗流。为此，我们需要加载YOLO预训练的权重、配置文件和图像路径，以便您可以执行以下命令:</p><div><pre class="programlisting">./flow --imgdir sample_img/ --model cfg/yolo.cfg --load ../darknet/yolo.weights</pre></div><p>如果您想以json格式保存对象检测，那么这也是可能的。您需要执行以下命令:</p><div><pre class="programlisting">./flow --imgdir sample_img/ --model cfg/yolo.cfg --load ../darknet/yolo.weights --json</pre></div><p>您可以在<code class="literal">sample_img/out</code>文件夹中看到输出；请参考下图:</p><div><img src="img/B08394_09_26.jpg" alt="Loading the model and running object detection on images" width="1000" height="580"/><div><p>图9.26:使用暗流输出带有预测对象的图像</p></div></div><p>你也可以<a id="id1162" class="indexterm"/>参考下图:</p><div><img src="img/B08394_09_27.jpg" alt="Loading the model and running object detection on images" width="1000" height="95"/><div><p>图9.27:图像中检测到的对象的json输出</p></div></div></div><div><div><div><div><h4 class="title"><a id="ch09lvl4sec62"/>加载模型并在视频流上运行对象检测</h4></div></div></div><p>在这一节中，我们<a id="id1163" class="indexterm"/>将对视频流进行对象检测。首先，我们将了解如何使用网络摄像头和执行对象检测。该命令如下所示:</p><div><pre class="programlisting">./flow --model cfg/yolo.cfg --load ../darknet/yolo.weights --demo camera --saveVideo --gpu 0.60</pre></div><p>可以参考下图。可以在这个链接看到视频:<a class="ulink" href="https://drive.google.com/drive/folders/1RwKEUaxTExefdrSJSy44NugqGZaTN_BX?usp=sharing">https://drive . Google . com/drive/folders/1 rwkeueaxtexefdrsjsy 44 nugqgzatn _ BX？usp =分享</a></p><div><img src="img/B08394_09_28.jpg" alt="Loading the model and running object detection on the video stream" width="1000" height="708"/><div><p>图9.28:使用暗流对网络摄像头视频流进行对象检测的输出</p></div></div><p>
</p><p>我们也可以为预先录制的视频运行<a id="id1164" class="indexterm"/>暗流。为此，您需要运行以下命令:</p><div><pre class="programlisting">./flow --model cfg/yolo.cfg --load ../darknet/yolo.weights --demo ~/Downloads/Traffic.avi --saveVideo --gpu 0.60</pre></div><p>可以参考下图。可以在这个链接看到视频:<a class="ulink" href="https://drive.google.com/drive/folders/1RwKEUaxTExefdrSJSy44NugqGZaTN_BX?usp=sharing">https://drive . Google . com/drive/folders/1 rwkeueaxtexefdrsjsy 44 nugqgzatn _ BX？usp =分享</a>。</p><div><img src="img/B08394_09_29.jpg" alt="Loading the model and running object detection on the video stream" width="1000" height="505"/><div><p>图9.29:使用暗流对预先录制的视频进行对象检测的输出</p></div></div><p>在两个<a id="id1165" class="indexterm"/>命令中，我们都使用了—save Video标志来保存视频，并使用了—gpu 0.60标志，该标志使用了60%的gpu内存。使用这种方法，我们将获得78%的准确率。</p></div></div></div></div></div>



  








<style type="text/css" title="ibis-book">
    #sbo-rt-content div,#sbo-rt-content td,#sbo-rt-content th,#sbo-rt-content div{font-family:sans-serif}#sbo-rt-content div{font-weight:400}#sbo-rt-content th{font-weight:700}#sbo-rt-content p.paragraph_style{margin-bottom:.66em;line-height:15px;font-weight:400;text-indent:0}#sbo-rt-content h2.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content h3.paragraph_style{margin-bottom:.66em;z-index:10000;line-height:15px}#sbo-rt-content a.paragraph_style{font-weight:400;text-indent:0}#sbo-rt-content #book-contents p{z-index:100}#sbo-rt-content p{padding-top:0;margin-bottom:1em;z-index:100;text-indent:0}#sbo-rt-content img{max-width:100%;height:auto}#sbo-rt-content h1,#sbo-rt-content h2,#sbo-rt-content h3,#sbo-rt-content h4,#sbo-rt-content h5,#sbo-rt-content h6{margin-top:0;margin-bottom:.66em;font-weight:700;clear:both}#sbo-rt-content p{clear:both}#sbo-rt-content h1{font-size:2em}#sbo-rt-content h2{color:#ff9b2f;font-size:1.6em}#sbo-rt-content h3{margin:14px 0 6px;font-size:1.3em;color:green}#sbo-rt-content h4{color:#BD1D1D}#sbo-rt-content div.informalfigure{margin:1px auto 10px}#sbo-rt-content div.informalfigure table{margin-left:auto;margin-right:auto}#sbo-rt-content span.bold,#sbo-rt-content strong{font-weight:700}#sbo-rt-content div.informaltable{border-top:0;border-bottom:0;margin-top:5px;margin-bottom:5px;border-left:0;border-right:0;border-style:solid;border-color:#000}#sbo-rt-content div.informaltable table{width:100%;margin:2em 0}#sbo-rt-content div.toc{display:none}#sbo-rt-content div.informaltable table{border-width:0 1px;border-spacing:0;border-style:solid;border-color:#000;border-collapse:collapse;background-color:#fff}#sbo-rt-content div.informaltable table th{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content div.informaltable table td{border-width:1px;padding:3px;border-style:solid;border-color:#000;background-color:#fff}#sbo-rt-content .book_title a{color:#000}#sbo-rt-content .author_name{font-style:italic}#sbo-rt-content .mediaobject table{margin:.5em 0 1em}#sbo-rt-content pre,#sbo-rt-content pre.programlisting{color:blue;clear:both;margin:.5em 2em;overflow:auto;padding:.5em 2em;white-space:pre-wrap;word-wrap:break-word}#sbo-rt-content div.informalexample{word-wrap:break-word}#sbo-rt-content pre.programlisting span.bold{font-weight:700}#sbo-rt-content code.literal{color:blue}#sbo-rt-content div.mediaobject img{margin-left:auto;margin-right:auto}#sbo-rt-content div.mediaobject{margin-bottom:1em;margin-left:auto;margin-right:auto;text-align:center}#sbo-rt-content div.note p{clear:none}#sbo-rt-content div.section .title{color:#ff9b2f;font-weight:700}#sbo-rt-content div.section div.section .title{color:green;font-weight:700}#sbo-rt-content div.section div.section div.section .title{color:#BD1D1D;font-weight:700}#sbo-rt-content div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content div.section div.section div.section div.section div.section div.section .title{font-weight:700}#sbo-rt-content body#page div.note h3{color:#000}#sbo-rt-content div.caption{font-size:smaller;font-style:italic;text-align:center;margin-top:.5em;margin-bottom:1em}#sbo-rt-content div.preface p span.bold{display:block}#sbo-rt-content div.preface pre span.bold{display:inline}#sbo-rt-content div.preface div.section p span.bold{display:inline}#sbo-rt-content div.section pre.programlisting span.bold{float:left;clear:left}#sbo-rt-content div.preface div.titlepage h2.title{text-align:left}#sbo-rt-content div.note,#sbo-rt-content div.tip,#sbo-rt-content div.sidebar{word-wrap:break-word;margin:0 0 1em;padding:0;border:1px solid #777;background-color:#e0e0e0;clear:both}#sbo-rt-content div.note div.mediaobject{margin-bottom:1em}#sbo-rt-content ul,#sbo-rt-content ol{margin-bottom:1em}#sbo-rt-content li ul,#sbo-rt-content li ol{margin-top:1em}#sbo-rt-content div.blockquote blockquote{text-align:center;font-style:italic;margin:2em 0}#sbo-rt-content div.mediaobject table{margin-left:auto;margin-right:auto}#sbo-rt-content pre.programlisting span.bold{float:none}#sbo-rt-content div.note div.inner,#sbo-rt-content div.tip div.inner,#sbo-rt-content div.sidebar div.inner{margin:.75em}#sbo-rt-content div.tip{border-style:dashed}#sbo-rt-content div.note h3.title,#sbo-rt-content div.tip h3.title{color:#000}#sbo-rt-content em{font-style:italic}#sbo-rt-content div.x-form-element{padding-bottom:2px}#sbo-rt-content .w175{width:175px}#sbo-rt-content img.nframe{margin-left:0;width:600px}#sbo-rt-content div.note h2,#sbo-rt-content div.note h3,#sbo-rt-content div.tip h2,#sbo-rt-content div.tip h3{color:#000 !important}#sbo-rt-content div.note p,#sbo-rt-content div.tip p,#sbo-rt-content div.sidebar p,#sbo-rt-content div.note ol,#sbo-rt-content div.note ul{width:100%;margin-left:0 !important}#sbo-rt-content ol.arabic,#sbo-rt-content ol.arabic li{list-style-type:decimal}#sbo-rt-content ol.lowerroman,#sbo-rt-content ol.lowerroman li{list-style-type:lower-roman}#sbo-rt-content ol.loweralpha,#sbo-rt-content ol.loweralpha li{list-style-type:lower-alpha}#sbo-rt-content li div.mediaobject,#sbo-rt-content li div.note,#sbo-rt-content li div.tip,#sbo-rt-content li div.sidebar,#sbo-rt-content li table,#sbo-rt-content li h1,#sbo-rt-content li h2,#sbo-rt-content li h3,#sbo-rt-content li h4,#sbo-rt-content li h5,#sbo-rt-content li h6{margin-top:1em}#sbo-rt-content div.note div.mediaobject{margin-top:1em}
    </style>
<style type="text/css" id="font-styles">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-size: &amp;lt;%= font_size %&amp;gt; !important; }</style>
<style type="text/css" id="font-family">#sbo-rt-content, #sbo-rt-content p, #sbo-rt-content div { font-family: &amp;lt;%= font_family %&amp;gt; !important; }</style>
<style type="text/css" id="column-width">#sbo-rt-content { max-width: &amp;lt;%= column_width %&amp;gt;% !important; margin: 0 auto !important; }</style>

<style type="text/css">body{background-color:#fbfbfb!important;margin:1em;}#sbo-rt-content *{text-indent:0pt!important;}#sbo-rt-content .bq{margin-right:1em!important;}#sbo-rt-content *{word-wrap:break-word!important;word-break:break-word!important;}#sbo-rt-content table,#sbo-rt-content pre{overflow-x:unset!important;overflow:unset!important;overflow-y:unset!important;white-space:pre-wrap!important;}</style>
<div><div><div><div><div><h1 class="title"><a id="ch09lvl1sec100"/>摘要</h1></div></div></div><p>在本章中，你学习了迁移学习。我们探索了不同的库和方法来构建实时对象检测应用程序。您了解了如何设置OpenCV，并了解了它在构建基线应用程序中的作用。在这种基线方法中，我们使用了使用caffe深度学习库训练的模型。在那之后，我们使用TensorFlow来建立实时对象检测，但最终，我们使用了预训练的YOLO模型，它优于其他所有方法。这种基于YOLO的方法为我们提供了对象检测应用的更一般化的方法。如果您对构建计算机视觉的创新解决方案感兴趣，那么您可以报名参加VOC挑战赛。这会提升你的技能，给你一个学习的机会。更多信息可以参考这个链接:<a class="ulink" href="http://host.robots.ox.ac.uk/pascal/VOC/">http://host.robots.ox.ac.uk/pascal/VOC/</a>(PASCAL VOC Challenges 2005-2012)。你也可以构建自己的算法，检查结果，并将结果与现有方法进行比较，如果结果优于现有方法，你肯定可以在知名期刊上发表论文。通过使用YOLO方法，我们在PASCAL VOC数据集上获得了78%的平均精度，当您将该模型应用于任何视频或图像时，它都可以很好地工作。这一章的代码归功于阿德里安·罗斯布鲁克、达特·特兰和特里厄。我们根据COCO数据集或PASCAL VOC数据集的图谱定义了图谱得分。</p><p>在下一章，我们将探索另一个属于计算机视觉领域的应用:人脸检测和面部表情检测。为了构建这个应用程序，我们将使用深度学习技术。所以，继续读！</p></div></div>



  
</body></html>