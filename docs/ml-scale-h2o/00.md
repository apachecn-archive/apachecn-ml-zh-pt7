

# 零、前言

在这个时间点上，**机器学习** ( **ML** )几乎不需要介绍:它对企业、非营利组织和科学组织来说既普遍又具有变革性。ML 是建立在数据之上的。我们都知道每年收集的数据呈指数级增长，生成这些数据的来源也越来越多样化。这本书是关于利用这些海量数据来做 ML 的。我们称之为*大规模机器学习*，并将其定义为三大支柱:在大型到海量数据集上构建高质量的模型，在多样化的企业环境中部署它们进行评分，并在此过程中导航多个利益相关者的关注。这里，规模考虑了数据量和企业环境、模型构建和模型部署。在这本书里，我们将向你展示，在实践中，H2O 是如何克服大规模执行 ML 的许多挑战的。

这本书首先概述了大规模执行 ML 的挑战，以及 H2O 框架如何克服这些挑战，同时产生高质量的模型和企业级部署。从那里，它过渡到使用大规模 H2O 的模型构建技术和模型部署模式的高级处理。然后，我们从需要理解、部署和维护该系统的多个企业利益相关者的角度来看其技术基础，并展示这与数据科学家的活动和需求之间的关系。最后，我们展示了如何实现大规模 H2O，或者将其作为更大、功能更丰富的 H2O 人工智能云平台的一部分，在这里，它呈现出令人兴奋的新水平的人工智能可能性和商业价值。

到本书结束时，您将具备从海量数据集中构建高质量的可解释的 ML 模型、将这些模型部署到各种各样的企业系统，以及组装实现独特形式商业价值的最先进的 ML 解决方案所需的知识。

# 这本书是给谁的

这本书是为数据科学家、ML 工程师、系统管理员、企业架构师和好奇的技术人员编写的，他们希望使用 H2O 大规模构建和部署 ML 模型。那些已经熟悉 H2O 的人将学习先进的建模技术和部署模式，以及 H2O 如何在幕后工作的细节。具有 ML 知识但很少或没有工作经验的学生将会了解它在大型企业中是如何运作的。建议学习 ML 的基础知识，并且需要理解 Python 才能理解代码示例。

# 这本书涵盖了什么

[*第一章*](B16721_01_Final_SK_ePub.xhtml#_idTextAnchor015) ，*机遇与挑战*，设定了全书的脉络。我们将首先围绕三个领域大规模地定义 ML:在大型到海量数据集上构建高质量的模型，在多样化的企业环境中部署它们以进行评分，并在此过程中导航多个利益相关者的关注。然后，我们将认识到在这种背景下 ML 的巨大商机和执行挑战。在这种情况下，您将了解 H2O 如何通过其 **H2O-3** 、**苏打水**、**企业蒸汽**和 **MOJO** 技术克服这些挑战，形成 H2O at Scale 框架。

[*第 2 章*](B16721_02_Final_SK_ePub.xhtml#_idTextAnchor024) 、*平台组件和关键概念*，通过描述每个 H2O 组件在 ML 生命周期中的位置、其关键特性以及如何克服大规模 ML 的挑战来概述每个组件。然后，我们从这个概述中提炼出几个关键概念。本章的目标是在您学习如何实现 H2O 之前，为您提供一个关于其工作原理的基础知识。

[*第 3 章*](B16721_03_Final_SK_ePub.xhtml#_idTextAnchor042) 、*基本工作流程——数据到可部署模型*，展示了使用 H2O 大比例框架构建和部署模型所需的最少步骤。把这当成一个`Hello World`例子，每个步骤都有解释。除了实现这些步骤，您还有其他选择，我们将对它们进行探讨。在这本书的这一点上，我们将结束我们的一般概述，并转移到高级主题。

[*第 4 章*](B16721_04_Final_SK_ePub.xhtml#_idTextAnchor064) ， *H2O 规模化模型构建-能力阐述*，开始我们的模型构建重点，它主要是数据科学家感兴趣的。在这一章中，我们熟悉了 H2O 广泛的建模能力，从数据摄取和操作到算法、模型训练、评估和可解释性技术。把这一章看作是 H2O 模型建筑的*什么*，而把下一章看作是对*如何*和*为什么*的高级处理。

[*第 5 章*](B16721_05_Final_SK_ePub.xhtml#_idTextAnchor082) 、*高级模型构建—第 1 部分*，向您介绍数据科学家在构建企业级模型时需要考虑的高级模型构建主题。我们讨论了数据分割选项，比较了建模算法，提出了超参数优化的两阶段网格搜索策略，介绍了 H2O AutoML 自动拟合多种算法的数据，并研究了改善模型性能的特征工程选项。在本章结束时，你应该能够使用一种或多种 H2O 现有的监督学习算法建立一个企业规模的优化预测模型。

[*第 6 章*](B16721_06_Final_SK_ePub.xhtml#_idTextAnchor106) ，*高级模型构建-第二部分*，继续我们的高级模型构建主题，展示如何在 Apache Spark 管道中构建 H2O 监督学习模型，回顾 H2O 的非监督学习方法，讨论更新 H2O 模型的最佳实践，并介绍确保 H2O 模型再现性的要求。

[*第 7 章*](B16721_07_Final_SK_ePub.xhtml#_idTextAnchor127) ，*了解 ML 模型*，概述了 H2O 内部用于解释 ML 模型的一组功能。仅仅建立一个预测准确的模型是不够的。在将任何模型投入生产之前，关键的一步是理解它是如何做出决策的。我们讨论选择适当的模型度量，使用多种诊断来建立对模型的信任，以及使用模型性能度量的全局和局部解释来从一组候选模型中选择最佳模型。这包括评估模型性能、评分速度和候选模型中满足的假设之间的权衡。

[*第 8 章*](B16721_08_Final_SK_ePub.xhtml#_idTextAnchor137) ，*综合起来*，以大多数数据科学项目的方式开始:用原始数据和一个总体商业目标。我们将数据和问题陈述提炼为与业务相关的内容，并且可以用可用数据来回答。我们设计各种功能，创建和评估多个候选模型，直到我们得到最终模型。我们评估最终模型，并说明模型部署所需的准备步骤。本章中的处理准确地反映了企业中数据科学家的工作。

[*第九章*](B16721_09_Final_SK_ePub.xhtml#_idTextAnchor159)*制作评分以及*H2O MOJO，开始我们的重点车型部署。ML 工程师、企业架构师、软件开发人员和一般技术人员会对这一章特别感兴趣。您将熟悉 H2O 的 MOJO 作为一个评分工件的优势，以及它可以多么容易地部署到各种各样的企业系统。最后，您将编写一个批处理文件评分程序，嵌入一个 MOJO 来演示这种灵活性。

[*第十章*](B16721_10_Final_SK_ePub.xhtml#_idTextAnchor178) ， *H2O 模型部署模式*，探讨了部署 MOJO 的许多方式。您将首先概述各种可能的部署模式，然后深入了解每种模式的实现细节。这些模式涵盖了各种专业 H2O 评分软件、第三方集成和您自己的定制系统上的实时流和批量评分。

[*第十一章*](B16721_11_Final_SK_ePub.xhtml#_idTextAnchor207) ，*管理员和运营人员的观点*，开始我们对企业利益相关者视角的关注与 H2O 的规模 ML。尽管数据科学家关注的是企业利益相关者的活动和关注点，但他们会看到他们如何与自己的活动相关联。在本章中，系统管理员和操作员将详细了解如何配置 Enterprise Steam，以及如何保护和管理用户，以便数据科学家能够以可控的方式自行调配环境。我们还将确定围绕维护和故障排除 H2O 工作负载和组件的操作活动。

[*第十二章*](B16721_12_Final_SK_ePub.xhtml#_idTextAnchor226) ，*企业架构师和安全视角*，涵盖了 H2O 在规模组件方面的企业架构师和安全视角。您将详细了解 H2O 的实现备选方案，以及组件如何集成、通信和部署。你会看到 H2O at Scale 框架可以独立部署，也可以作为更大的 **H2O 人工智能云**的一员，我们将在下一章讨论。

[*第十三章*](B16721_13_Final_SK_ePub.xhtml#_idTextAnchor241) ，*介绍 H2O AI 云*，概述 H2O.ai 的端到端 ML 全生命周期平台。H2O at Scale 框架和书中到目前为止涵盖的所有内容都是 H2O 人工智能云的一个较小的子集。在这一章中，我们将概述 H2O 人工智能组件及其关键功能，包括四个专门的**模型构建引擎**，一个全功能的 **MLOps** 和**功能商店**，以及一个开源的低代码 SDK，用于构建和集成**人工智能应用**并将其托管在**应用商店**。

[*第 14 章*](B16721_14_Final_SK_ePub.xhtml#_idTextAnchor256) ，*更大平台背景下的大规模 H2O*，以我们所学的一切结束了这本书，并展示了 H2O 大规模框架如何在用作 H2O 人工智能云的一部分时获得全新而令人兴奋的可能性。我们提供了这些可能性的例子，然后展示了一个使用 H2O 的参考企业集成框架，供您想象自己的可能性。

[*附录*](B16721_Appendix_Final_SK_ePub.xhtml#_idTextAnchor268) 、*启动 H2O 集群的替代方法*，展示了您可以创建 H2O 环境来运行本书中代码示例的不同方式。

# 为了充分利用这本书

要运行代码示例，您需要设置一个 H2O 环境。附录 中的 [*向您展示了这三种方法。那里描述了软件版本。*](B16721_Appendix_Final_SK_ePub.xhtml#_idTextAnchor268)

**如果你使用的是这本书的数字版，我们建议你自己输入代码或者从这本书的 GitHub 库中获取代码(下一节有链接)。这样做将帮助您避免任何与复制和粘贴代码相关的潜在错误。**

从概念的角度来看，在讲述 H2O 如何实现它们之前，我们先介绍广义的 ML 概念。因此，你应该能够从你更大的 ML 理解框架中理解书中的讨论。

# 下载示例代码文件

你可以从 GitHub 的[https://GitHub . com/packt publishing/Machine-Learning-at-Scale-with-H2O](https://github.com/PacktPublishing/Machine-Learning-at-Scale-with-H2O)下载本书的示例代码文件。如果代码有更新，它会在 GitHub 库中更新。

我们在[https://github.com/PacktPublishing/](https://github.com/PacktPublishing/)也有丰富的书籍和视频目录中的其他代码包。看看他们！

# 下载彩色图片

我们还提供了一个 PDF 文件，其中有本书中使用的截图和图表的彩色图像。你可以在这里下载:[https://packt.link/sDmtM](https://packt.link/sDmtM)。

# 习惯用法

本书通篇使用了许多文本约定。

`Code in text`:表示文本中的码字、数据库表名、文件夹名、文件名、文件扩展名、路径名、伪 URL、用户输入和 Twitter 句柄。这里有一个例子:“`h2o.explain`和`h2o.explain_row`方法分别为全局和局部解释捆绑了一组可解释函数和可视化。”

代码块设置如下:

```py
from pysparkling import *
```

```py
import h2o
```

```py
hc = H2Ocontext.getOrCreate()
```

```py
hc
```

任何命令行输入或输出都按如下方式编写:

```py
PYSPARK_DRIVER_PYTHON="ipython" \
PYSPARK_DRIVER_PYTHON_OPTS="notebook" \
bin/pysparkling
```

**粗体**:表示一个新术语、一个重要单词或您在屏幕上看到的单词。例如，菜单或对话框中的单词以**粗体**出现。下面是一个例子:“在 Flow 中的 **Admin** 菜单下，前三个选项是 **Jobs** 、 **Cluster Status** 和 **Water Meter**

提示或重要注意事项

像这样出现。

# 取得联系

我们随时欢迎读者的反馈。

`customercare@packtpub.com`在邮件主题中提及书名。

**勘误表**:虽然我们已经尽一切努力确保内容的准确性，但错误还是会发生。如果你在这本书里发现了一个错误，请告诉我们，我们将不胜感激。请参观 www.packtpub.com/support/errata 并填写表格。

`copyright@packt.com`与素材有链接。

如果你有兴趣成为一名作家:如果有一个你擅长的主题，并且你有兴趣写一本书或者为一本书投稿，请访问 authors.packtpub.com。

# 分享你的想法

一旦你阅读了 H2O 的*大规模机器学习，我们很想听听你的想法！请点击此处，直接进入该书的亚马逊评论页面，并分享您的反馈。*

您的评论对我们和技术社区非常重要，将有助于我们确保提供高质量的内容。