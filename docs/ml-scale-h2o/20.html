<html><head/><body>


	
		<title>B16721_Appendix_Final_SK_ePub</title>
		
	
	
		<div><h1 id="_idParaDest-266"><em class="italic"> <a id="_idTextAnchor268"/>附录</em>:启动H2O集群的替代方法</h1>
			<p>这个<a href="B16721_Appendix_Final_SK_ePub.xhtml#_idTextAnchor268"> <em class="italic">附录</em> </a>将向您展示如何在您的本地机器上启动H2O-3和苏打水集群，以便您可以运行本书中的代码示例。我们还将向您展示如何在H2O人工智能云的90天免费试用环境中启动H2O-3集群。这个试用环境包括Enterprise Steam，用于在Kubernetes基础设施上启动和管理H2O集群。</p>
			<p class="callout-heading">关于环境的说明</p>
			<p class="callout"><strong class="bold">架构</strong>:如<a href="B16721_02_Final_SK_ePub.xhtml#_idTextAnchor024"> <em class="italic">第2章</em> </a>、<em class="italic">平台组件和关键概念</em>中所介绍的，您将使用一个客户端环境(实现了H2O-3或苏打水库)来针对分布在Kubernetes或Hadoop集群上的多个服务器节点上的远程H2O-3或苏打水架构运行命令。然而，对于小数据集，该架构可以作为单个进程在与客户端相同的机器上本地启动。</p>
			<p class="callout"><strong class="bold">版本</strong>:本书的功能和代码样本使用了以下版本:3.34.0.7的H2O-3版本，在Spark 3.2上运行的苏打水版本3.34.0.7-1-3.2。您将使用最新(最近)的稳定版本设置您的环境，这将允许您运行本书中的相同代码示例，但也将包括本书编写后添加的H2O-3和苏打水中的功能。</p>
			<p class="callout">语言:你可以用Python、R或者Java/Scala来设置你的客户端环境。我们将在本书中使用Python。您的Python客户端可以是Jupyter notebook、PyCharm或其他。</p>
			<p>让我们学习如何完全在您的本地环境中运行H2O-3。</p>
			<h1 id="_idParaDest-267"><a id="_idTextAnchor269"/>本地H2O-3星团</h1>
			<p>这是运行H2O-3最简单的方法<a id="_idIndexMarker1162"/>,适用于本书代码样本中使用的小数据集。它在您的本地机器上启动H2O-3(相对于企业集群环境)并且不涉及H2O企业Steam。</p>
			<p>首先，我们将对H2O-3 Python环境进行一次性设置。</p>
			<h2 id="_idParaDest-268"><a id="_idTextAnchor270"/>第一步——在Python中安装H2O-3</h2>
			<p>要设置您的H2O-3 Python客户端，只需在您的Python环境中安装<a id="_idIndexMarker1163"/>三个模块依赖项，然后安装<code>h2o-3</code> Python模块。必须使用Python 2.7.x、3.5.x、3.6.x或3.7.x。</p>
			<p>更具体地说，请执行以下操作:</p>
			<ol>
				<li value="1">在您的Python环境中安装依赖项:<pre><strong class="bold">pip install requests</strong> <strong class="bold">pip install tabulate</strong> <strong class="bold">pip install future </strong></pre></li>
				<li>在您的Python环境中安装H2O-3库:<pre><strong class="bold">pip install h2o</strong></pre></li>
			</ol>
			<p>请参考<a href="http://h2o-release.s3.amazonaws.com/h2o/rel-zumbo/1/index.html">http://H2O-release . S3 . Amazon AWS . com/H2O/rel-zumbo/1/index . html</a>(PYTHON中的<strong class="bold">安装</strong>标签)在康达安装<a id="_idIndexMarker1164"/> H2O-3。</p>
			<p>现在，您可以在本地运行H2O 3号了。让我们看看如何做到这一点。</p>
			<h2 id="_idParaDest-269"><a id="_idTextAnchor271"/>步骤2–启动您的H2O-3集群并编写代码</h2>
			<p>要启动本地<a id="_idIndexMarker1165"/>单节点<a id="_idIndexMarker1166"/> H2O-3集群，只需在Python IDE中运行以下命令:</p>
			<pre class="source-code">import h2o</pre>
			<pre class="source-code">h2o.init()</pre>
			<pre class="source-code"># write h2o-3 code, including code samples in this book</pre>
			<p>现在，您可以编写您的H2O-3代码，包括本书中的所有示例。参见<a href="B16721_02_Final_SK_ePub.xhtml#_idTextAnchor024"> <em class="italic">第2章</em> </a>、<em class="italic">平台组件和关键概念、</em>中的<code>Hello World</code>代码示例和对表面下发生的<a id="_idIndexMarker1168"/>的解释<a id="_idIndexMarker1167"/>。</p>
			<p class="callout-heading">Java依赖——仅在本地运行时</p>
			<p class="callout">H2O-3集群(不是Python客户端)运行在Java上。因为您在本地机器上运行集群(代表单节点集群)，所以您必须安装Java。当您使用Python客户端连接到企业Kubernetes或Hadoop环境中的远程H2O集群时，这不是必需的。</p>
			<p>现在，让我们看看如何设置我们的环境，以便在本地机器上编写苏打水代码。</p>
			<h1 id="_idParaDest-270"><a id="_idTextAnchor272"/>当地波光粼粼的水簇</h1>
			<p>本地运行苏打水<a id="_idIndexMarker1169"/>类似于本地运行H2O-3，但是依赖于<a id="_idIndexMarker1170"/>火花。关于Spark、Python和H2O组件的完整解释<a id="_idIndexMarker1172"/>请参见此<a id="_idIndexMarker1171"/>链接:<a href="https://docs.h2o.ai/sparkling-water/3.2/latest-stable/doc/pysparkling.html">https://docs . H2O . ai/sparkling-water/3.2/latest-stable/doc/py sparkling . html</a>。</p>
			<p>我们将在这里使用Spark 3.2。要使用不同版本的Spark，请通过以下链接进入H2O下载页面的<strong class="bold">苏打水</strong>部分:<a href="https://h2o.ai/resources/download/">https://h2o.ai/resources/download/</a>。</p>
			<p>对于您的苏打水Python客户端，您必须使用Python 2.7.x、3.5.x、3.6.x或3.7.x。我们将在这里通过Jupyter笔记本运行苏打水。</p>
			<h2 id="_idParaDest-271"><a id="_idTextAnchor273"/>步骤1–在本地安装Spark</h2>
			<p>按照以下步骤<a id="_idIndexMarker1174"/>在本地安装Spark:</p>
			<ol>
				<li value="1">去https://spark.apache.org/downloads.html<a href="https://spark.apache.org/downloads.html">下载Spark。进行以下选择，然后下载:</a><ul><li>Spark版本:3.2.x</li><li>包类型:为Hadoop 3.3和更高版本预构建</li></ul></li>
				<li>解压缩下载的文件。</li>
				<li>设置以下环境变量(此处显示用于macOS): <pre><strong class="bold">export SPARK_HOME="/path/to/spark/folder"</strong> <strong class="bold">export MASTER="local[*]"</strong></pre></li>
			</ol>
			<p>现在，让我们在Python环境中安装苏打水库<a id="_idIndexMarker1175"/>。</p>
			<h2 id="_idParaDest-272"><a id="_idTextAnchor274"/>步骤2–在Python中安装苏打水</h2>
			<p>安装以下<a id="_idIndexMarker1176"/>模块:</p>
			<ol>
				<li value="1">在您的Python环境中安装依赖项:<pre><strong class="bold">pip install requests</strong> <strong class="bold">pip install tabulate</strong> <strong class="bold">pip install future </strong></pre></li>
				<li>安装苏打水Python模块(名为<code>PySparkling</code>)。请注意此处Spark 3.2的模块引用:<pre><strong class="bold">pip install h2o_pysparkling_3.2</strong></pre></li>
			</ol>
			<p>接下来，让我们安装一个交互式外壳。</p>
			<h2 id="_idParaDest-273"><a id="_idTextAnchor275"/>步骤3–安装一个闪闪发光的Water Python交互式外壳</h2>
			<p>要在本地运行苏打水<a id="_idIndexMarker1177"/>,我们需要安装一个交互式shell来在Spark上启动苏打水集群。(这仅在本地运行汽水时需要；在您的企业集群上运行时，Enterprise Steam会处理这些问题。)为此，请执行以下步骤:</p>
			<ol>
				<li value="1">导航到<a href="https://h2o.ai/resources/download/">https://h2o.ai/resources/download/</a>的<strong class="bold">苏打水</strong>部分，点击<strong class="bold">火花3.2的苏打水</strong>，最后点击<strong class="bold">下载苏打水</strong>按钮，下载交互外壳。</li>
				<li>解压下载文件。</li>
			</ol>
			<p>现在，让我们启动一个波光粼粼的水集群，并通过Jupyter笔记本访问它。</p>
			<h2 id="_idParaDest-274"><a id="_idTextAnchor276"/>第四步——在闪闪发光的水壳上放一个Jupyter笔记本</h2>
			<p>我们假设你已经将Jupyter Notebook <a id="_idIndexMarker1179"/>安装在与步骤<em class="italic"> 2 </em>中的安装相同的Python环境<a id="_idIndexMarker1180"/>中。执行以下步骤启动Jupyter笔记本:</p>
			<ol>
				<li value="1">在命令行上，导航到您在本节的步骤<em class="italic"> 3 </em>中解压缩下载文件的目录。</li>
				<li>启动波光粼粼的水互动外壳和其中的Jupyter笔记本:<ul><li>对于macOS，使用以下命令:<pre><strong class="bold">PYSPARK_DRIVER_PYTHON="ipython" \</strong> <strong class="bold">PYSPARK_DRIVER_PYTHON_OPTS="notebook" \</strong> <strong class="bold">bin/pysparkling</strong></pre></li><li>对于Windows，请使用以下内容:<pre><strong class="bold">SET PYSPARK_DRIVER_PYTHON=ipython</strong> <strong class="bold">SET PYSPARK_DRIVER_PYTHON_OPTS=notebook</strong> <strong class="bold">bin/pysparkling</strong></pre></li></ul></li>
			</ol>
			<p>您的Jupyter笔记本应该会在浏览器中启动。</p>
			<p>现在，让我们编写苏打水代码。</p>
			<h2 id="_idParaDest-275"><a id="_idTextAnchor277"/>第五步——启动你的苏打水集群并编写代码</h2>
			<p>在你的Jupyter笔记本中，键入下面的<a id="_idIndexMarker1182"/>代码开始你的工作:</p>
			<ol>
				<li value="1">启动你的波光粼粼的水集群:<pre>from pysparkling import * import h2o hc = H2OContext.getOrCreate() hc</pre></li>
				<li>测试安装:<pre>localdata = "/path/to/my/csv" mysparkdata = spark.read.load(localdata, format="csv") myH2Odata = hc.asH2OFrame(mysparkdata)</pre></li>
			</ol>
			<p>您现在已经准备好使用H2O和Spark代码构建<a id="_idIndexMarker1183"/>模型了。</p>
			<h1 id="_idParaDest-276"><a id="_idTextAnchor278"/> H2O人工智能云90天免费试用环境中的H2O 3集群</h1>
			<p>在这里，你必须与企业蒸汽互动运行H2O-3。在这种情况下，除了在本地运行H2O-3时安装的<code>h2o</code>模块之外，您还将在您的Python客户端环境中安装<code>h2osteam</code>模块。</p>
			<h2 id="_idParaDest-277"><a id="_idTextAnchor279"/>第一步——获得H2O人工智能云的90天试用期</h2>
			<p>点击<a href="https://h2o.ai/freetrial">https://h2o.ai/freetrial</a>获取H2O AI云的<a id="_idIndexMarker1184"/>试用权限。</p>
			<p>当您完成所有步骤并可以登录H2O人工智能云时，我们就可以开始运行H2O-3集群，作为H2O人工智能云平台的一部分。下面是接下来的步骤。</p>
			<h2 id="_idParaDest-278"><a id="_idTextAnchor280"/>步骤2–设置您的Python环境</h2>
			<p>要设置Python <a id="_idIndexMarker1185"/>客户端环境，请执行以下步骤:</p>
			<ol>
				<li value="1">登录H2O AI Cloud，点击侧边栏的<strong class="bold"> Python客户端</strong>选项，点击<code>h2osteam</code>库:</li>
			</ol>
			<div><div><img src="img/B16721_15_001.jpg" alt="Figure 15.1 – Enterprise Steam&#13;&#10;"/>
				</div>
			</div>
			<p class="figure-caption">图15.1–企业蒸汽</p>
			<ol>
				<li value="2">通过运行以下命令在您的Python环境中安装<code>h2osteam</code>库【T21:<pre><strong class="bold">pip install /path/to/download.whl</strong></pre></li>
			</ol>
			<p>这里，<code>/path/to/download.whl</code>被你的实际路径代替。</p>
			<ol>
				<li value="3">您还需要安装<code>h2o</code>库。为此，执行以下命令:<pre><strong class="bold">pip install requests</strong> <strong class="bold">pip install tabulate</strong> <strong class="bold">pip install future </strong> <strong class="bold">pip install h2o</strong></pre></li>
			</ol>
			<p>现在，让我们使用Steam启动一个H2O集群，然后用Python编写H2O代码。</p>
			<h2 id="_idParaDest-279"><a id="_idTextAnchor281"/>步骤3–启动您的集群</h2>
			<p>按照以下步骤启动您的H2O集群，这是在Kubernetes服务器集群上完成的:</p>
			<ol>
				<li value="1">在Enterprise Steam中，点击工具条上的<strong class="bold"> H2O </strong>，然后点击<strong class="bold">启动新集群</strong>按钮。</li>
				<li>现在，您可以配置您的H2O集群并为其命名。确保从下拉列表中配置最新的H2O版本，它应该与您在上一步中安装的库相匹配。</li>
				<li>配置完成后，点击<strong class="bold">启动集群</strong>按钮，等待集群启动完成。</li>
				<li>您将需要Enterprise Steam的URL来从您的Jupyter笔记本或其他Python客户端连接到它。在Steam中，将URL从<code>https</code>复制到<code>h2o.ai</code>(包含在内)。</li>
			</ol>
			<h2 id="_idParaDest-280"><a id="_idTextAnchor282"/>第4步——编写H2O协议3代码</h2>
			<p>我们现在可以开始<a id="_idIndexMarker1188"/>编写代码(例如用Jupyter ),在我们刚刚发布的H2O-3集群上构建模型。打开Python客户端后，执行以下步骤:</p>
			<ol>
				<li value="1">Import your libraries and connect to Enterprise Steam:<pre>import h2o
import h2osteam
from h2osteam.clients import H2oKubernetesClient
conn = h2osteam.login(
    url="https://SteamURL, 
verify_ssl=False,
    username="yourH2OAICloudUserName", 
    password=" yourH2OAICloudPassword")</pre><p class="callout-heading">重要说明</p><p class="callout">在撰写本文时，为期90天的H2O人工智能云试用的网址是<a href="https://steam.cloud.h2o.ai">https://steam . Cloud . H2O . AI</a>。</p><p class="callout">对于密码，您可以使用您的H2O人工智能云试用环境的登录密码，或者您可以使用从企业Steam配置页面生成的临时个人访问令牌。</p></li>
				<li>连接到您在Enterprise Steam中启动的H2O集群:<pre>cluster = H2oKubernetesClient().get_cluster(     name="yourClusterName",      created_by="yourH2OAICloudUserName") cluster.connect() # you are now ready to write code to run on this H2O cluster</pre></li>
			</ol>
			<p>你现在可以写<a id="_idIndexMarker1189"/>你的H2O-3代码，包括本书的所有样本。</p>
		</div>
	

</body></html>