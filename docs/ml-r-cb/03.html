<html><head/><body>
<html>
  <head>
    <title>Chapter 3. R and Statistics</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch03" class="calibre1"/>第三章。r和统计</h1></div></div></div><p class="calibre7">在本章中，我们将讨论以下主题:</p><div><ul class="itemizedlist"><li class="listitem">理解R中的数据采样</li><li class="listitem">运算R中的概率分布</li><li class="listitem">在R中使用单变量描述性统计</li><li class="listitem">执行相关性和多变量分析</li><li class="listitem">操作线性回归和多变量分析</li><li class="listitem">进行精确的二项式检验</li><li class="listitem">执行学生的t检验</li><li class="listitem">执行Kolmogorov-Smirnov测试</li><li class="listitem">理解Wilcoxon秩和与符号秩检验</li><li class="listitem">使用皮尔逊卡方检验</li><li class="listitem">进行单向方差分析</li><li class="listitem">进行双向方差分析</li></ul></div></div></body></html>


<html>
  <head>
    <title>Chapter 3. R and Statistics</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h1 class="title" id="calibre_pb_1"><a id="ch03lvl1sec27" class="calibre1"/>简介</h1></div></div></div><p class="calibre7">作为统计语言S的后代，R语言已经成为统计领域的首选计算语言。而且，由于其作为该领域活跃贡献者的地位，如果发现了新的统计方法，很有可能首先在R语言中实现这种方法。因此，大量的统计方法可以通过应用R语言来实现。</p><p class="calibre7">要在R中应用统计方法，用户可以将实现方法分为描述性统计和推断性统计:</p><div><ul class="itemizedlist"><li class="listitem"><strong class="calibre2">描述性统计</strong>:这些<a id="id249" class="calibre1"/>用来概括<a id="id250" class="calibre1"/>数据的特征。用户可以使用平均值和标准差来描述<a id="id251" class="calibre1"/>数字数据，使用频率和<a id="id252" class="calibre1"/>百分比来描述分类数据。</li><li class="listitem"><strong class="calibre2">推断统计</strong>:根据样本数据中的模式，用户可以推断出总体的<a id="id253" class="calibre1"/>特征。与推断统计相关的<a id="id254" class="calibre1"/>方法用于假设检验、数据估计、数据关联和关系建模。推论可以进一步扩展到预测、预测和估计被研究人群中或与之相关的未观察到的值。</li></ul></div><p class="calibre7">在下面的食谱中，我们将讨论数据采样、概率分布、单变量描述性统计、相关性和多变量分析、线性回归和多变量分析、精确二项式检验、学生t检验、Kolmogorov-Smirnov检验、Wilcoxon秩和与有符号秩检验、Pearson卡方检验、单向ANOVA和双向ANOVA。</p></div></div></body></html>


<html>
  <head>
    <title>Understanding data sampling in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec28" class="calibre1"/>了解R中的数据采样</h1></div></div></div><p class="calibre7">抽样是从统计总体中选择数据子集的方法，可以利用总体的特征来估计总体。以下配方将<a id="id255" class="calibre1"/>演示如何在r中生成样本。</p></div></body></html>


<html>
  <head>
    <title>Understanding data sampling in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">准备就绪</h2></div></div></div><p class="calibre7">确保你有一个适合以下食谱的工作环境。</p></div></div></body></html>


<html>
  <head>
    <title>Understanding data sampling in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec78" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤来理解R中的数据采样:</p><div><ol class="orderedlist"><li class="listitem" value="1">为了生成给定人群的随机样本，用户可以简单地使用<code class="email">sample</code>功能:<div> <pre class="programlisting"> <strong class="calibre2">&gt; sample(1:10)</strong> </pre> </div></li><li class="listitem" value="2">要指定返回的项数，用户可以将赋值设置为<code class="email">size</code>参数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; sample(1:10, size = 5)</strong> </pre> </div></li><li class="listitem" value="3">此外，样本还可以通过指定<code class="email">replace = TRUE</code>(默认为<code class="email">FALSE</code> ): <div> <pre class="programlisting"> <strong class="calibre2">&gt; sample(c(0,1), 10, replace = TRUE)</strong> </pre> </div>来生成伯努利试验</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Understanding data sampling in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">它是如何工作的...</h2></div></div></div><p class="calibre7">正如我们在前面的<a id="id256" class="calibre1"/>演示中看到的，<code class="email">sample</code>函数可以从指定的总体中生成随机样本。用户只需通过指定<code class="email">size</code>的参数，即可指定记录的返回值。将<code class="email">replace</code>参数分配给<code class="email">TRUE</code>，您可以生成伯努利试验(只有<code class="email">0</code>和<code class="email">1</code>的群体)。</p></div></div></body></html>


<html>
  <head>
    <title>Understanding data sampling in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec80" class="calibre1"/>亦见</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">在R中，默认包提供了另一个示例方法<code class="email">sample.int</code>，其中n和size都必须以整数形式提供:<div> <pre class="programlisting"> <strong class="calibre2">&gt; sample.int(20, 12)</strong> </pre> </div></li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Operating a probability distribution in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec29" class="calibre1"/>运算R中的概率分布</h1></div></div></div><p class="calibre7">概率分布和统计分析密切相关。对于统计分析来说，分析师是基于一定的人群进行预测的，这种人群大多是在一种概率分布下。所以，如果你发现选择预测的数据并没有遵循实验设计中确切的假设概率分布，那么即将出现的结果是可以反驳的。换句话说，概率为统计提供了依据。下面的例子将演示<a id="id258" class="calibre1"/>如何在r中生成概率分布</p></div></body></html>


<html>
  <head>
    <title>Operating a probability distribution in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">正在准备中</h2></div></div></div><p class="calibre7">由于大多数分发函数源自<code class="email">stats</code>包，确保库<code class="email">stats</code>已加载。</p></div></div></body></html>


<html>
  <head>
    <title>Operating a probability distribution in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec82" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤:</p><div><ol class="orderedlist"><li class="listitem" value="1">对于正态分布，用户可以使用<code class="email">dnorm</code>，返回<code class="email">0</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; dnorm(0)</strong> <strong class="calibre2">[1] 0.3989423</strong> </pre> </div>处的正态曲线高度</li><li class="listitem" value="2">然后，用户可以更改自变量中的平均值和标准差:<div> <pre class="programlisting"> <strong class="calibre2">&gt; dnorm(0,mean=3,sd=5)</strong> <strong class="calibre2">[1] 0.06664492</strong> </pre> </div></li><li class="listitem" value="3">Next, plot the graph of a normal distribution with the <code class="email">curve</code> function:<div><pre class="programlisting">
<strong class="calibre2">&gt; curve(dnorm,-3,3)</strong>
</pre></div><div><img src="img/00049.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">标准正态分布</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="4">与返回正常曲线高度的<code class="email">dnorm</code>相比，<code class="email">pnorm</code>函数可以返回给定值下的面积:<div> <pre class="programlisting"> <strong class="calibre2">&gt; pnorm(1.5)</strong> <strong class="calibre2">[1] 0.9331928</strong> </pre> </div></li><li class="listitem" value="5">或者，要得到某个值以上的面积，可以指定选项<code class="email">lower.tail</code>到<code class="email">FALSE</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; pnorm(1.5, lower.tail=FALSE)</strong> <strong class="calibre2">[1] 0.0668072</strong> </pre> </div></li><li class="listitem" value="6">To plot the graph of <code class="email">pnorm</code>, the user can employ a <code class="email">curve</code> function:<div><pre class="programlisting">
<strong class="calibre2">&gt; curve(pnorm(x), -3,3)</strong>
</pre></div><div><img src="img/00050.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">累积密度函数</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="7">要计算特定分布的分位数，可以使用<code class="email">qnorm</code>。函数<code class="email">qnorm,</code>可以被视为<code class="email">pnorm</code>的逆函数，它返回给定概率的Z得分:<div> <pre class="programlisting"> <strong class="calibre2">&gt; qnorm(0.5)</strong> <strong class="calibre2">[1] 0</strong> <strong class="calibre2">&gt; qnorm(pnorm(0))</strong> <strong class="calibre2">[1] 0</strong> </pre> </div></li><li class="listitem" value="8">To generate random numbers from a normal distribution, one can use the <code class="email">rnorm</code> function and specify the number of generated numbers. Also, one can define optional arguments, such as the mean and standard deviation:<div><pre class="programlisting">
<strong class="calibre2">&gt; set.seed(50)</strong>
<strong class="calibre2">&gt; x = rnorm(100,mean=3,sd=5)</strong>
<strong class="calibre2">&gt; hist(x)</strong>
</pre></div><div><img src="img/00051.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">正态分布直方图</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="9">To<a id="id261" class="calibre1"/> calculate the uniform distribution, the <code class="email">runif</code> function generates random numbers from a uniform distribution. The user can specify the range of the generated numbers by specifying variables, such as the minimum and maximum. For the following example, the user generates 100 random variables from <code class="email">0</code> to <code class="email">5</code>:<div><pre class="programlisting">
<strong class="calibre2">&gt; set.seed(50)</strong>
<strong class="calibre2">&gt; y = runif(100,0,5)</strong>
<strong class="calibre2">&gt; hist(y)</strong>
</pre></div><div><img src="img/00052.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">均匀分布的直方图</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="10">最后，如果你想测试数据的正态性，最广泛使用的测试是夏皮罗-威尔克斯测试。在这里，我们演示如何对来自正态分布和均匀分布的两个样本分别执行正态性检验:<div> <pre class="programlisting"> <strong class="calibre2">&gt; shapiro.test(x)</strong>  <strong class="calibre2">  Shapiro-Wilk normality test</strong>  <strong class="calibre2">data:  x </strong> <strong class="calibre2">W = 0.9938, p-value = 0.9319</strong> <strong class="calibre2">&gt; shapiro.test(y)</strong>  <strong class="calibre2">  Shapiro-Wilk normality test</strong>  <strong class="calibre2">data:  y </strong> <strong class="calibre2">W = 0.9563, p-value = 0.002221</strong> </pre> </div></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Operating a probability distribution in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">它是如何工作的...</h2></div></div></div><p class="calibre7">在这个食谱中，我们首先引入<code class="email">dnorm</code>，一个概率密度函数，它返回一个正态曲线的高度。指定单个输入后，输入值称为标准分数或z分数。在没有指定任何其他参数的情况下，假设正态分布的均值为零，标准差为一。然后我们介绍三种绘制标准和正态分布的方法。</p><p class="calibre7">在这之后，我们引入<code class="email">pnorm</code>，一个累积密度函数。函数<code class="email">pnorm</code>可以生成给定值下的面积。除此之外，<code class="email">pnorm</code>也可用于计算正态分布的p值。从数字中减去1，或者将选项<code class="email">lower.tail</code>赋值为True，就可以得到p值。类似地，可以使用<code class="email">plot</code>函数来绘制累积密度。</p><p class="calibre7">与<code class="email">pnorm</code>相反，<code class="email">qnorm</code>返回给定概率的z值。因此，该示例显示将<code class="email">qnorm</code>函数应用于<code class="email">pnorm</code>函数将产生精确的输入值。</p><p class="calibre7">接下来，我们将向您展示如何使用<code class="email">rnrom</code>函数从正态分布中生成随机样本，以及如何使用<code class="email">runif</code>函数从均匀分布中生成随机样本。在函数<code class="email">rnorm</code>中，必须指定生成数字的数量，我们也可以添加可选的增量，如平均值和标准偏差。然后，通过使用<code class="email">hist</code>函数，应该能够找到图3中的钟形曲线。另一方面，对于<code class="email">runif</code>功能，使用最小和最大规格，可以获得两者之间的样本号列表<a id="id263" class="calibre1"/>。然而，我们仍然可以使用<code class="email">hist</code>功能来绘制样本。很明显，输出数字(如上图所示)不是钟形的，这表明样本不是来自正态分布。</p><p class="calibre7">最后，我们演示了如何用夏皮罗-威尔克斯检验来检验数据的正态性。这里，我们分别对正态和均匀分布样本进行正态性检验。在这两个输出中，人们可以在每个测试结果中找到p值。p值显示了变化，这表明样本来自正态分布。如果p值高于0.05，我们可以断定样本来自正态分布。另一方面，如果该值低于0.05，则我们断定样本不来自正态分布。</p></div></div></body></html>


<html>
  <head>
    <title>Operating a probability distribution in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec84" class="calibre1"/>还有更多...</h2></div></div></div><p class="calibre7">除了正态分布，您还可以通过使用r的内置函数获得t分布、二项式分布和卡方分布。您可以使用<code class="email">help</code>函数来访问关于此的更多信息:</p><div><ul class="itemizedlist"><li class="listitem">对于一个t分布:<div> <pre class="programlisting"> <strong class="calibre2">&gt; help(TDist)</strong> </pre> </div></li><li class="listitem">对于二项分布:<div> <pre class="programlisting"> <strong class="calibre2">&gt;help(Binomial)</strong> </pre> </div></li><li class="listitem">对于卡方分布:<div> <pre class="programlisting"> <strong class="calibre2">&gt;help(Chisquare)</strong> </pre> </div></li></ul></div><p class="calibre7">要了解更多关于这个包中的发行版的信息，用户可以使用关键字<code class="email">distributions</code>访问<code class="email">help</code>函数，找到所有相关的文档:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; help(distributions)</strong>
</pre></div></div></div></body></html>


<html>
  <head>
    <title>Working with univariate descriptive statistics in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec30" class="calibre1"/>在R中使用单变量描述性统计</h1></div></div></div><p class="calibre7">单变量<a id="id264" class="calibre1"/>描述性统计描述一个<a id="id265" class="calibre1"/>单变量进行单位分析，也是最简单的定量分析形式。在这个食谱中，我们介绍一些用于描述单个变量的基本函数。</p></div></body></html>


<html>
  <head>
    <title>Working with univariate descriptive statistics in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">做好准备</h2></div></div></div><p class="calibre7">我们需要对样本数据进行描述性统计。这里，我们使用内置的<code class="email">mtcars</code>数据作为我们的<a id="id266" class="calibre1"/>示例。</p></div></div></body></html>


<html>
  <head>
    <title>Working with univariate descriptive statistics in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec86" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤:</p><div><ol class="orderedlist"><li class="listitem" value="1">首先将<code class="email">mtcars</code>数据加载到一个名为<code class="email">mtcars</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; data(mtcars)</strong> </pre> </div>的数据帧中</li><li class="listitem" value="2">为了<a id="id267" class="calibre1"/>获得向量范围，<code class="email">range</code>函数将返回向量的上下界:<div> <pre class="programlisting"> <strong class="calibre2">&gt; range(mtcars$mpg)</strong> <strong class="calibre2">[1] 10.4 33.9</strong> </pre> </div></li><li class="listitem" value="3">计算变量长度:<div> <pre class="programlisting"> <strong class="calibre2">&gt; length(mtcars$mpg)</strong> <strong class="calibre2">[1] 32</strong> </pre> </div></li><li class="listitem" value="4">求mpg的平均值:<div> <pre class="programlisting"> <strong class="calibre2">&gt; mean(mtcars$mpg)</strong> <strong class="calibre2">[1] 20.09062</strong> </pre> </div></li><li class="listitem" value="5">获取输入向量的中值:<div> <pre class="programlisting"> <strong class="calibre2">&gt; median(mtcars$mpg)</strong> <strong class="calibre2">[1] 19.2</strong> </pre> </div></li><li class="listitem" value="6">获取输入向量的标准差:<div> <pre class="programlisting"> <strong class="calibre2">&gt; sd(mtcars$mpg)</strong> <strong class="calibre2">[1] 6.026948</strong> </pre> </div></li><li class="listitem" value="7">获取输入向量的方差:<div> <pre class="programlisting"> <strong class="calibre2">&gt; var(mtcars$mpg)</strong> <strong class="calibre2">[1] 36.3241</strong> </pre> </div></li><li class="listitem" value="8">方差也可以用标准差的平方来计算:<div> <pre class="programlisting"> <strong class="calibre2">&gt; sd(mtcars$mpg) ^ 2</strong> <strong class="calibre2">[1] 36.3241</strong> </pre> </div></li><li class="listitem" value="9">为了<a id="id268" class="calibre1"/>获得<strong class="calibre2">四分位距</strong>(<strong class="calibre2">IQR</strong>):<div><pre class="programlisting"> <strong class="calibre2">&gt; IQR(mtcars$mpg)</strong> <strong class="calibre2">[1] 7.375</strong> </pre></div></li><li class="listitem" value="10">获取分位数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; quantile(mtcars$mpg,0.67)</strong> <strong class="calibre2"> 67% </strong> <strong class="calibre2">21.4</strong> </pre> </div></li><li class="listitem" value="11">获取输入向量的最大值:<div> <pre class="programlisting"> <strong class="calibre2">&gt; max(mtcars$mpg)</strong> <strong class="calibre2">[1] 33.9</strong> </pre> </div></li><li class="listitem" value="12">为了<a id="id269" class="calibre1"/>获得输入向量的最小值<a id="id270" class="calibre1"/>:<div><pre class="programlisting"> <strong class="calibre2">&gt; min(mtcars$mpg)</strong> <strong class="calibre2">[1] 10.4</strong> </pre></div></li><li class="listitem" value="13">要获得一个包含累积最大值元素的向量:<div> <pre class="programlisting"> <strong class="calibre2">&gt; cummax(mtcars$mpg)</strong> <strong class="calibre2"> [1] 21.0 21.0 22.8 22.8 22.8 22.8 22.8 24.4 24.4 24.4 24.4 24.4 24.4 24.4 24.4 24.4</strong> <strong class="calibre2">[17] 24.4 32.4 32.4 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9 33.9</strong> </pre> </div></li><li class="listitem" value="14">为了获得具有累积最小值的元素的向量:<div> <pre class="programlisting"> <strong class="calibre2">&gt; cummin(mtcars$mpg)</strong> <strong class="calibre2"> [1] 21.0 21.0 21.0 21.0 18.7 18.1 14.3 14.3 14.3 14.3 14.3 14.3 14.3 14.3 10.4 10.4</strong> <strong class="calibre2">[17] 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4 10.4</strong> </pre> </div></li><li class="listitem" value="15">为了汇总数据集，可以应用<code class="email">summary</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; summary(mtcars)</strong> </pre> </div></li><li class="listitem" value="16">为了获得分类数据的频率计数，以<code class="email">mtcars</code>的<code class="email">cyl</code>为例:<div> <pre class="programlisting"> <strong class="calibre2">&gt; table(mtcars$cyl)</strong>  <strong class="calibre2"> 4  6  8</strong> <strong class="calibre2">11  7 14</strong> </pre> </div></li><li class="listitem" value="17">要获得数字数据的频率计数，您可以使用词干图来描绘数据形状；<code class="email">stem</code>产生一个给定值的茎叶图:<div> <pre class="programlisting"> <strong class="calibre2">&gt; stem(mtcars$mpg)</strong>  <strong class="calibre2">  The decimal point is at the |</strong>  <strong class="calibre2">  10 | 44</strong> <strong class="calibre2">  12 | 3</strong> <strong class="calibre2">  14 | 3702258</strong> <strong class="calibre2">  16 | 438</strong> <strong class="calibre2">  18 | 17227</strong> <strong class="calibre2">  20 | 00445</strong> <strong class="calibre2">  22 | 88</strong> <strong class="calibre2">  24 | 4</strong> <strong class="calibre2">  26 | 03</strong> <strong class="calibre2">  28 | </strong> <strong class="calibre2">  30 | 44</strong> <strong class="calibre2">  32 | 49</strong> </pre> </div></li><li class="listitem" value="18">You <a id="id271" class="calibre1"/>can use a histogram<a id="id272" class="calibre1"/> of ggplot to plot the same stem-and-leaf figure:<div><pre class="programlisting">
<strong class="calibre2">&gt; library(ggplot2)</strong>
<strong class="calibre2">&gt; qplot(mtcars$mpg, binwidth=2)</strong>
</pre></div><div><img src="img/00053.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">mtcars的mpg直方图</p></div></div><p class="calibre13"> </p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Working with univariate descriptive statistics in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">它是如何工作的...</h2></div></div></div><p class="calibre7">单变量描述性统计生成数据集的频率分布。此外，它们可以用来识别数据中的明显模式和变量的特征，以便从整体的角度更好地理解数据。此外，它们还可以提供有关集中趋势的信息和单个案例偏斜度的描述符。因此，在数据探索过程的开始进行单变量分析是很常见的。</p><p class="calibre7">为了开始探索数据，我们首先将数据集<code class="email">mtcars</code>加载到一个R会话中。从数据中，我们应用<code class="email">range</code>、<code class="email">length</code>、<code class="email">mean</code>、<code class="email">median</code>、<code class="email">sd</code>、<code class="email">var</code>、<code class="email">IQR</code>、<code class="email">quantile</code>、<code class="email">min</code>、<code class="email">max</code>、<code class="email">cumin</code>、<code class="email">cumax</code>得到属性<code class="email">mpg</code>的描述性统计量。然后，我们使用<code class="email">summary</code>函数获得关于<code class="email">mtcars</code>的汇总信息。</p><p class="calibre7">接下来，我们获得分类数据的频率计数(<code class="email">cyl</code>)。为了获得数字数据的频率计数，我们使用stem图来描绘数据形状。最后，我们使用带有<code class="email">2</code>中的<code class="email">binwidth</code>参数的直方图来生成一个类似于茎叶图的图。</p></div></div></body></html>


<html>
  <head>
    <title>Working with univariate descriptive statistics in R</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">还有更多...</h2></div></div></div><p class="calibre7">单变量描述性统计的一个常见场景是寻找向量的模式。在R中，没有内置函数来帮助用户获取数据的模式。但是，可以使用以下代码实现模式功能:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; mode = function(x) {</strong>
<strong class="calibre2">+ temp = table(x)</strong>
<strong class="calibre2">+ names(temp)[temp == max(temp)]</strong>
<strong class="calibre2">+ }</strong>
</pre></div><p class="calibre7">通过对向量<code class="email">mtcars$mpg</code>应用<code class="email">mode</code>函数，可以找到给定向量中最常出现的数值或类别:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; x = c(1,2,3,3,3,4,4,5,5,5,6)</strong>
<strong class="calibre2">&gt; mode(x)</strong>
<strong class="calibre2">[1] "3" "5"</strong>
</pre></div></div></div></body></html>


<html>
  <head>
    <title>Performing correlations and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec31" class="calibre1"/>执行相关性和多变量分析</h1></div></div></div><p class="calibre7">为了分析两个以上变量之间的关系，您需要进行多变量描述性统计，这允许对因素进行比较。此外，它还能防止单个变量的影响扭曲分析。在本食谱中，我们将讨论如何使用相关和协方差矩阵进行多元描述性统计。</p></div></body></html>


<html>
  <head>
    <title>Performing correlations and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">准备就绪</h2></div></div></div><p class="calibre7">确保<code class="email">mtcars</code>已经加载到R会话内的数据帧中。</p></div></div></body></html>


<html>
  <head>
    <title>Performing correlations and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec90" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行<a id="id277" class="calibre1"/>以下步骤:</p><div><ol class="orderedlist"><li class="listitem" value="1">这里，您<a id="id278" class="calibre1"/>可以通过将<code class="email">mtcars</code>中的前三个变量输入到<code class="email">cov</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; cov(mtcars[1:3])</strong> <strong class="calibre2">             mpg        cyl       disp</strong> <strong class="calibre2">mpg    36.324103  -9.172379  -633.0972</strong> <strong class="calibre2">cyl    -9.172379   3.189516   199.6603</strong> <strong class="calibre2">disp -633.097208 199.660282 15360.7998</strong> </pre> </div>中得到协方差矩阵</li><li class="listitem" value="2">为了获得数据集的相关矩阵，我们将<code class="email">mtcars</code>的前三个变量输入到<code class="email">cor</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; cor(mtcars[1:3])</strong> <strong class="calibre2">            mpg        cyl       disp</strong> <strong class="calibre2">mpg   1.0000000 -0.8521620 -0.8475514</strong> <strong class="calibre2">cyl  -0.8521620  1.0000000  0.9020329</strong> <strong class="calibre2">disp -0.8475514  0.9020329  1.0000000</strong> </pre> </div></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Performing correlations and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">它是如何工作的...</h2></div></div></div><p class="calibre7">在这个食谱中，我们演示了如何应用相关性和协方差来发现多个变量之间的关系。</p><p class="calibre7">首先，我们计算前三个<code class="email">mtcars</code>变量的协方差矩阵。协方差可以衡量变量之间的线性关系。因此，正协方差(例如，<code class="email">cyl</code>对<code class="email">mpg</code>)表示两个变量正线性相关。另一方面，负协方差(例如，<code class="email">mpg</code>对<code class="email">disp</code>)表示两个变量负线性相关。然而，由于不同数据集的方差，这些数据集的协方差得分不具有可比性。因此，如果您想要比较不同数据集中两个变量之间的线性关系强度，您应该使用归一化得分，即相关系数，而不是协方差。</p><p class="calibre7">接下来，我们应用一个<code class="email">cor</code>函数来获得<code class="email">mtcars</code>数据集中三个变量的相关系数矩阵。在相关系数矩阵中，矩阵的数字元素表示两个变量之间关系的强度。如果一个变量对自身的相关系数得分<code class="email">1</code>，则该变量对自身有正相关关系。<code class="email">cyl</code>和<code class="email">mpg</code>变量的相关系数为-0.85，这意味着<a id="id279" class="calibre1"/>变量之间存在很强的负相关关系。另一方面，<code class="email">disp</code>和<code class="email">cyl</code>变量得分为0.90，这可能表明它们之间存在强有力的正相关关系。</p></div></div></body></html>


<html>
  <head>
    <title>Performing correlations and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec92" class="calibre1"/>参见</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">You can use <code class="email">ggplot</code> to plot the heatmap of the correlation coefficient matrix:<div><pre class="programlisting">
<strong class="calibre2">&gt; library(reshape2)</strong>
<strong class="calibre2">&gt; qplot(x=Var1, y=Var2, data=melt(cor(mtcars[1:3])), fill=value, geom="tile")</strong>
</pre></div><div><img src="img/00054.jpeg" alt="See also" class="calibre9"/><div><p class="calibre12">相关系数矩阵热图</p></div></div><p class="calibre13"> </p></li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Operating linear regression and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec32" class="calibre1"/>操作线性回归和多元分析</h1></div></div></div><p class="calibre7">线性<a id="id281" class="calibre1"/>回归是一种<a id="id282" class="calibre1"/>评估因变量和自变量之间关联的方法。在本食谱中，我们将介绍如何进行多元分析的线性回归。</p></div></body></html>


<html>
  <head>
    <title>Operating linear regression and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">准备就绪</h2></div></div></div><p class="calibre7">确保<a id="id283" class="calibre1"/>已经被加载到R会话内的数据帧中。</p></div></div></body></html>


<html>
  <head>
    <title>Operating linear regression and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec94" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行<a id="id284" class="calibre1"/>以下步骤:</p><div><ol class="orderedlist"><li class="listitem" value="1">要将变量拟合到线性模型中，可以使用<code class="email">lm</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; lmfit = lm(mtcars$mpg ~ mtcars$cyl)</strong> <strong class="calibre2">&gt; lmfit</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">lm(formula = mtcars$mpg ~ mtcars$cyl)</strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">(Intercept)   mtcars$cyl  </strong> <strong class="calibre2">     37.885       -2.876 </strong> </pre> </div></li><li class="listitem" value="2">要获得拟合模型的详细信息，您可以使用<code class="email">summary</code>功能:<div> <pre class="programlisting"> <strong class="calibre2">&gt; summary(lmfit)</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">lm(formula = mtcars$mpg ~ mtcars$cyl)</strong>  <strong class="calibre2">Residuals:</strong> <strong class="calibre2">    Min      1Q  Median      3Q     Max </strong> <strong class="calibre2">-4.9814 -2.1185  0.2217  1.0717  7.5186 </strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">            Estimate Std. Error t value Pr(&gt;|t|)    </strong> <strong class="calibre2">(Intercept)  37.8846     2.0738   18.27  &lt; 2e-16 ***</strong> <strong class="calibre2">mtcars$cyl   -2.8758     0.3224   -8.92 6.11e-10 ***</strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">Residual standard error: 3.206 on 30 degrees of freedom</strong> <strong class="calibre2">Multiple R-squared:  0.7262,  Adjusted R-squared:  0.7171 </strong> <strong class="calibre2">F-statistic: 79.56 on 1 and 30 DF,  p-value: 6.113e-10</strong> </pre> </div></li><li class="listitem" value="3">要<a id="id285" class="calibre1"/>创建差异表的分析<a id="id286" class="calibre1"/>，可以使用<code class="email">anova</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; anova(lmfit)</strong> <strong class="calibre2">Analysis of Variance Table</strong>  <strong class="calibre2">Response: mtcars$mpg</strong> <strong class="calibre2">           Df Sum Sq Mean Sq F value    Pr(&gt;F)    </strong> <strong class="calibre2">mtcars$cyl  1 817.71  817.71  79.561 6.113e-10 ***</strong> <strong class="calibre2">Residuals  30 308.33   10.28                      </strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong> </pre> </div></li><li class="listitem" value="4">To plot the regression line on a scatter plot of two variables, you first plot <code class="email">cyl</code> against <code class="email">mpg</code> in it, then use the <code class="email">abline</code> function to add a regression line on the plot:<div><pre class="programlisting">
<strong class="calibre2">&gt; lmfit = lm(mtcars$mpg ~ mtcars$cyl)</strong>
<strong class="calibre2">&gt; plot(mtcars$cyl, mtcars$mpg)</strong>
<strong class="calibre2">&gt; abline(lmfit)</strong>
</pre></div><div><img src="img/00055.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">cyl对mpg的回归图</p></div></div><p class="calibre13"> </p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Operating linear regression and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec95" class="calibre1"/>工作原理...</h2></div></div></div><p class="calibre7">在此配方中，我们应用线性模型函数<code class="email">lm</code>，该函数构建两个变量的线性拟合模型，并返回公式和系数。接下来，我们应用<code class="email">summary</code>函数来<a id="id287" class="calibre1"/>检索模型的详细<a id="id288" class="calibre1"/>信息(包括F统计和P值)。F统计量的目的是检验模型的统计显著性。它产生一个F值，即模型均方差与误差均方差之比。因此，大的F值表明回归模型解释了更大的总可变性。然后，我们可以使用F值来支持或拒绝所有回归系数都等于零的零假设。换句话说，如果F值很大，表明回归模型具有预测能力，则零假设被拒绝。另一方面，每个属性的P值测试系数等于零的零假设(对响应变量没有影响)。换句话说，低p值可以拒绝零假设，并表明预测值的变化与响应变量的值相关。</p><p class="calibre7">接下来，我们对拟合的模型应用<code class="email">anova</code>函数来确定方差。该函数输出平方和，它代表模型预测值的可变性。此外，为了可视化两个变量之间的线性关系，<code class="email">abline</code>函数可以在<code class="email">mpg</code>对<code class="email">cyl</code>的散点图上添加一条回归线。从上图可以明显看出<code class="email">mpg</code>和<code class="email">cyl</code>变量是负相关的。</p></div></div></body></html>


<html>
  <head>
    <title>Operating linear regression and multivariate analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec96" class="calibre1"/>参见</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">有关如何执行线性和非线性回归分析的更多信息，请参考<a class="calibre1" title="Chapter 4. Understanding Regression Analysis" href="part0046_split_000.html#page">第4章</a>、<em class="calibre8">了解回归分析</em></li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Conducting an exact binomial test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec33" class="calibre1"/>进行精确的二项式检验</h1></div></div></div><p class="calibre7">在做出决策时，了解决策误差是否可以控制或<a id="id289" class="calibre1"/>可以测量是很重要的。换句话说，我们希望证明所形成的假设不太可能是偶然发生的，并且具有统计学意义。在假设检验中，有两种假设:零假设和替代假设(或研究假设)。假设检验的目的是验证实验结果是否显著。然而，为了验证替代假设是否可接受，如果零假设被拒绝，则认为它是真的。</p><p class="calibre7">在下面的食谱中，我们将讨论一些常见的统计测试方法。首先，我们将介绍如何在r中进行精确的二项式检验。</p></div></body></html>


<html>
  <head>
    <title>Conducting an exact binomial test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec97" class="calibre1"/>做好准备</h2></div></div></div><p class="calibre7">由于<code class="email">binom.test</code>函数来源于<code class="email">stats</code>包，确保<code class="email">stats</code>库<a id="id290" class="calibre1"/>已加载。</p></div></div></body></html>


<html>
  <head>
    <title>Conducting an exact binomial test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec98" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤:</p><div><ol class="orderedlist"><li class="listitem" value="1">假设有一个游戏，一个赌徒可以通过掷骰子来赢得数字6。作为规则的一部分，赌徒可以自带骰子。如果一个赌徒试图在游戏中作弊，他会用一个装满的骰子来增加他获胜的机会。因此，如果我们观察到游戏者在315场游戏中赢了92场，我们可以通过进行精确的二项式测试来确定骰子是否公平:<div> <pre class="programlisting"> <strong class="calibre2">&gt; binom.test(x=92, n=315, p=1/6)</strong>  <strong class="calibre2">  Exact binomial test</strong>  <strong class="calibre2">data:  92 and 315</strong> <strong class="calibre2">number of successes = 92, number of trials = 315, p-value = 3.458e-08</strong> <strong class="calibre2">alternative hypothesis: true probability of success is not equal to 0.1666667</strong> <strong class="calibre2">95 percent confidence interval:</strong> <strong class="calibre2"> 0.2424273 0.3456598</strong> <strong class="calibre2">sample estimates:</strong> <strong class="calibre2">probability of success </strong> <strong class="calibre2">             0.2920635 </strong> </pre> </div></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Conducting an exact binomial test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch03lvl2sec99" class="calibre1"/>工作原理...</h2></div></div></div><p class="calibre7">二项式测试使用二项式分布来找出对于具有二元结果的<em class="calibre8"> n </em>次试验，真实的成功率是否可能是<em class="calibre8"> P </em>。概率公式<em class="calibre8"> P </em>可由下式定义:</p><div><img src="img/00056.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10"> </p><p class="calibre7">这里，<em class="calibre8"> X </em>表示随机变量，计算利息的结果数；<em class="calibre8"> n </em>表示试验次数；<em class="calibre8"> k </em>表示成功次数；<em class="calibre8"> p </em>表示<a id="id291" class="calibre1"/>成功的概率；并且<em class="calibre8"> q </em>表示故障的概率。</p><p class="calibre7">在我们计算了概率<em class="calibre8"> P </em>之后，我们可以执行一个符号测试来确定成功概率是否与我们预期的相似。如果概率不等于我们预期的，我们可以拒绝零假设。</p><p class="calibre7">根据定义，零假设是一种怀疑的观点或关于将被检验的总体参数的陈述。零假设由H0表示。另一个假设由一系列总体值表示，这些值不包括在零假设中。另一种假设由H1提出。在这种情况下，无效假设和替代假设分别如下所示:</p><div><ul class="itemizedlist"><li class="listitem"><strong class="calibre2"> H0(零假设)</strong>:成功的<a id="id292" class="calibre1"/>真实概率<a id="id293" class="calibre1"/>等于我们的预期</li><li class="listitem"><strong class="calibre2"> H1(替代假设)</strong>:真正的成功概率并不等于我们预期的<a id="id294" class="calibre1"/></li></ul></div><p class="calibre7">在本例中，我们<a id="id295" class="calibre1"/>演示了如何使用二项式测试来确定掷骰子的次数、掷出数字6的频率以及无偏骰子掷出6的概率。t检验的结果显示p值= 3.458e-08(低于0.05)。对于显著性，在百分之五的水平，零假设(骰子是无偏的)被拒绝，因为掷出了太多的六(成功的概率= 0.2920635)。</p></div></div></body></html>


<html>
  <head>
    <title>Conducting an exact binomial test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec100" class="calibre1"/>参见</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">要阅读更多关于精确二项式检验的用法，请使用<code class="email">help</code>函数查看相关文档:<div> <pre class="programlisting"> <strong class="calibre2">&gt; ?binom.test</strong> </pre> </div></li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Performing student's t-test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch03lvl1sec34" class="calibre1"/>执行学生的t检验</h1></div></div></div><p class="calibre7">单样本t检验<a id="id296" class="calibre1"/>使我们能够检验两个均值是否显著不同；双样本t检验允许我们检验两个独立组的均值是否不同。在这个菜谱中，我们将讨论如何使用r进行一个样本t检验和两个样本t检验。</p></div></body></html>


<html>
  <head>
    <title>Performing student's t-test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">准备就绪</h2></div></div></div><p class="calibre7">确保<code class="email">mtcars</code>已经加载到R会话内的数据帧中。由于<code class="email">t.test</code>函数<a id="id297" class="calibre1"/>来源于<code class="email">stats</code>包，确保<code class="email">stats</code>库已加载。</p></div></div></body></html>


<html>
  <head>
    <title>Performing student's t-test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec102" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤:</p><div><ol class="orderedlist"><li class="listitem" value="1">First, we visualize the attribute, <code class="email">mpg</code>, against <code class="email">am</code> using a boxplot:<div><pre class="programlisting">
<strong class="calibre2">&gt; boxplot(mtcars$mpg, mtcars$mpg[mtcars$am==0], ylab = "mpg", names=c("overall","automobile"))</strong>
<strong class="calibre2">&gt; abline(h=mean(mtcars$mpg),lwd=2, col="red")</strong>
<strong class="calibre2">&gt; abline(h=mean(mtcars$mpg[mtcars$am==0]),lwd=2, col="blue")</strong>
</pre></div><div><img src="img/00057.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">总人口和汽车的mpg箱线图</p></div></div><p class="calibre13">然后，我们执行一个统计过程来验证汽车的平均值<code class="email">mpg</code>是否低于整体平均值<code class="email">mpg</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; mpg.mu = mean(mtcars$mpg)</strong> <strong class="calibre2">&gt; mpg_am = mtcars$mpg[mtcars$am == 0]</strong> <strong class="calibre2">&gt; t.test(mpg_am,mu = mpg.mu)</strong>  <strong class="calibre2">  One Sample t-test</strong>  <strong class="calibre2">data:  mpg_am</strong> <strong class="calibre2">t = -3.3462, df = 18, p-value = 0.003595</strong> <strong class="calibre2">alternative hypothesis: true mean is not equal to 20.09062</strong> <strong class="calibre2">95 percent confidence interval:</strong> <strong class="calibre2"> 15.29946 18.99528</strong> <strong class="calibre2">sample estimates:</strong> <strong class="calibre2">mean of x </strong> <strong class="calibre2"> 17.14737 </strong> </pre> </div></p></li><li class="listitem" value="2">自动挡和手动挡汽车的mpg箱线图</li><li class="listitem" value="3">We begin <a id="id298" class="calibre1"/>visualizing the data by plotting a boxplot:<div><pre class="programlisting">
<strong class="calibre2">&gt;boxplot(mtcars$mpg~mtcars$am,ylab='mpg',names=c('automatic','manual'))</strong>
<strong class="calibre2">&gt; abline(h=mean(mtcars$mpg[mtcars$am==0]),lwd=2, col="blue")</strong>
<strong class="calibre2">&gt; abline(h=mean(mtcars$mpg[mtcars$am==1]),lwd=2, col="red")</strong>
</pre></div><div><img src="img/00058.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">The boxplot of mpg of automatic and manual transmission cars</p></div></div><p class="calibre13">上图揭示了自动挡车的平均mpg低于手动挡车的平均mpg:<div><pre class="programlisting"> <strong class="calibre2">&gt; t.test(mtcars$mpg~mtcars$am)</strong>  <strong class="calibre2">  Welch Two Sample t-test</strong>  <strong class="calibre2">data:  mtcars$mpg by mtcars$am</strong> <strong class="calibre2">t = -3.7671, df = 18.332, p-value = 0.001374</strong> <strong class="calibre2">alternative hypothesis: true difference in means is not equal to 0</strong> <strong class="calibre2">95 percent confidence interval:</strong> <strong class="calibre2"> -11.280194  -3.209684</strong> <strong class="calibre2">sample estimates:</strong> <strong class="calibre2">mean in group 0 mean in group 1 </strong> <strong class="calibre2">       17.14737        24.39231 </strong> </pre></div></p></li><li class="listitem" value="4"><a id="ch03lvl2sec103" class="calibre1"/>工作原理...</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Performing student's t-test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">学生的t检验<a id="id299" class="calibre1"/>是指如果零假设为真，则检验统计遵循正态分布(学生的t分布)。它可用于确定<a id="id300" class="calibre1"/>两个独立数据集之间是否存在差异。学生的t检验最适用于与基于小样本的推断相关的问题。</h2></div></div></div><p class="calibre7">在这个食谱中，我们讨论一个样本学生的t检验和两个样本学生的t检验。在一个样本学生的t检验中，一个经常被问到的研究问题是，“总体的均值是否不同于零假设？”因此，为了测试汽车的平均mpg是否低于总体平均mpg，我们首先使用箱线图来查看人口之间的差异，而不做任何假设。从上图可以明显看出，汽车的平均每加仑行驶里程(蓝线)低于总人口的平均每加仑行驶里程(红线)。然后，我们应用一个样本t检验；低p值为0.003595 ( &lt; 0.05) suggests that we should reject the null hypothesis that the mean mpg for automobiles is less than the average mpg of the overall population.</p><p class="calibre7">As a one sample t-test enables us to test whether two means are significantly different, a two sample t-test allows us to test whether the means of two independent groups are different. Similar to a one sample t-test, we first use a boxplot to see the differences between populations and then apply a two-sample t-test. The test results shows the p-value = 0.01374 (p&lt; 0.05). In other words, the test provides evidence that rejects the null hypothesis, which shows the mean mpg of cars with automatic transmission differs from the cars with <a id="id301" class="calibre1"/>手动变速器)。</p><p class="calibre7"><a id="ch03lvl2sec104" class="calibre1"/>参见</p></div></div></body></html>


<html>
  <head>
    <title>Performing student's t-test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">要了解更多关于学生t-test的用法，请使用<code class="email">help</code>功能查看相关文档:<div> <pre class="programlisting"> <strong class="calibre2">&gt; ?t.test</strong> </pre> </div></h2></div></div></div><div><ul class="itemizedlist"><li class="listitem"><a id="ch03lvl1sec35" class="calibre1"/>执行Kolmogorov-Smirnov测试</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Performing the Kolmogorov-Smirnov test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">单样本Kolmogorov-Smirnov检验用于将样本与参考概率进行比较。双样本Kolmogorov-Smirnov检验比较了两个数据集的累积分布<a id="id302" class="calibre1"/>。在本食谱中，我们将演示如何使用r执行Kolmogorov-Smirnov测试。</h1></div></div></div><p class="calibre7">准备就绪</p></div></body></html>


<html>
  <head>
    <title>Performing the Kolmogorov-Smirnov test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">确保<code class="email">mtcars</code>已经加载到R会话内的数据帧中。由于<code class="email">ks.test</code>函数源自<code class="email">stats</code>包，确保<code class="email">stats</code>库已加载。</h2></div></div></div><p class="calibre7"><a id="ch03lvl2sec106" class="calibre1"/>怎么做...</p></div></div></body></html>


<html>
  <head>
    <title>Performing the Kolmogorov-Smirnov test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">执行以下步骤:</h2></div></div></div><p class="calibre7">用单样本Kolmogorov-Smirnov检验验证数据集x(用<code class="email">rnorm</code>函数生成)是否正态分布:<div> <pre class="programlisting"> <strong class="calibre2">&gt; x = rnorm(50)</strong> <strong class="calibre2">&gt; ks.test(x,"pnorm")</strong>  <strong class="calibre2">  One-sample Kolmogorov-Smirnov test</strong>  <strong class="calibre2">data:  x</strong> <strong class="calibre2">D = 0.1698, p-value = 0.0994</strong> <strong class="calibre2">alternative hypothesis: two-sided</strong> </pre> </div></p><div><ol class="orderedlist"><li class="listitem" value="1">接下来，可以生成均匀分布的样本数据:<div> <pre class="programlisting"> <strong class="calibre2">&gt; set.seed(3)</strong> <strong class="calibre2">&gt; x = runif(n=20, min=0, max=20)</strong>  <strong class="calibre2">&gt; y = runif(n=20, min=0, max=20)</strong> </pre> </div></li><li class="listitem" value="2">两个生成数据样本的ecdf图</li><li class="listitem" value="3">We <a id="id303" class="calibre1"/>first plot <code class="email">ecdf</code> of two generated data samples:  <div><pre class="programlisting">
<strong class="calibre2">&gt; plot(ecdf(x), do.points = FALSE, verticals=T, xlim=c(0, 20))</strong>
<strong class="calibre2">&gt; lines(ecdf(y), lty=3, do.points = FALSE, verticals=T)</strong>
</pre></div><div><img src="img/00059.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">The ecdf plot of two generated data samples</p></div></div><p class="calibre13">最后，我们对两组数据应用双样本Kolmogorov-Smirnov检验:<div> <pre class="programlisting"> <strong class="calibre2">&gt; ks.test(x,y)</strong>  <strong class="calibre2">  Two-sample Kolmogorov-Smirnov test</strong>  <strong class="calibre2">data:  x and y</strong> <strong class="calibre2">D = 0.3, p-value = 0.3356</strong> <strong class="calibre2">alternative hypothesis: two-sided</strong> </pre> </div></p></li><li class="listitem" value="4"><a id="ch03lvl2sec107" class="calibre1"/>工作原理...</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Performing the Kolmogorov-Smirnov test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><strong class="calibre2"> Kolmogorov-Smirnov检验</strong> ( <strong class="calibre2"> K-S检验</strong>)是非参数统计检验，用于连续概率分布的相等性<a id="id304" class="calibre1"/>。它可用于将样本与参考概率分布进行比较(单样本K-S检验)，或者直接比较两个样本(双样本K-S检验)。该测试基于经验分布函数(ECDF)。设<img src="img/00060.jpeg" alt="How it works..." class="calibre24"/>为大小为n的随机样本；经验分布函数<img src="img/00061.jpeg" alt="How it works..." class="calibre24"/>定义为:</h2></div></div></div><p class="calibre7">The <strong class="calibre2">Kolmogorov-Smirnov test</strong> (<strong class="calibre2">K-S test</strong>) is a nonparametric and statistical test, used for the equality<a id="id304" class="calibre1"/> of continuous probability distributions. It can be used to compare a sample with a reference probability distribution (a one sample K-S test), or it can directly compare two samples (a two sample K-S test). The test is based on the empirical distribution function (ECDF). Let <img src="img/00060.jpeg" alt="How it works..." class="calibre24"/> be a random sample of size, n; the empirical distribution function, <img src="img/00061.jpeg" alt="How it works..." class="calibre24"/>, is defined as:</p><div><img src="img/00062.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10">这里，<img src="img/00063.jpeg" alt="How it works..." class="calibre24"/>是指标函数。如果<img src="img/00064.jpeg" alt="How it works..." class="calibre24"/>，该功能等于1。否则，函数<a id="id305" class="calibre1"/>等于0。</p><p class="calibre7">Kolmogorov-Smirnov统计量(D)基于F(x)和Fn(x)之间的最大垂直差(其中supx表示上确界)。它被定义为:</p><p class="calibre7">The Kolmogorov-Smirnov statistic (D) is based on the greatest (where supx denotes the supremum) vertical difference between F(x) and Fn(x). It is defined as:</p><div><img src="img/00065.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10">H <sub class="calibre25"> 0 </sub>是样本服从指定的分布。H <sub class="calibre25"> 1 </sub>是样品不符合规定的分布。</p><p class="calibre7">如果Dn大于从表中获得的临界值，那么我们在显著性水平α上拒绝H <sub class="calibre25"> 0 </sub>。</p><p class="calibre7">我们首先测试从正态分布生成的随机数是否正态分布。在5%的显著性水平下，p值0.0994表示输入呈正态分布。</p><p class="calibre7">然后，我们绘制了经验累积分布函数(<code class="email">ecdf</code>)图，以显示双样本测试如何计算最大距离D(显示为0.3)，并应用双样本Kolmogorov-Smirnov测试来发现两个输入数据集是否可能来自同一分布。</p><p class="calibre7">p值在0.05以上，不拒绝零假设。换句话说，这意味着两个数据集可能来自同一个分布。</p><p class="calibre7"><a id="ch03lvl2sec108" class="calibre1"/>亦见</p></div></div></body></html>


<html>
  <head>
    <title>Performing the Kolmogorov-Smirnov test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">要阅读更多关于Kolmogorov-Smirnov测试用法的<a id="id306" class="calibre1"/>，请使用<code class="email">help</code>功能查看相关文档:<div> <pre class="programlisting"> <strong class="calibre2">&gt; ?ks.test</strong> </pre> </div></h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">关于经验累积分布函数的定义，请参考<code class="email">ecdf</code>的帮助页面:<div> <pre class="programlisting"> <strong class="calibre2">&gt; ?ecdf</strong> </pre> </div></li><li class="listitem"><a id="ch03lvl1sec36" class="calibre1"/>了解Wilcoxon秩和与有符号秩检验</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Understanding the Wilcoxon Rank Sum and Signed Rank test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">Wilcoxon秩和与符号秩检验(或Mann-Whitney-Wilcoxon)是零假设的非参数<a id="id307" class="calibre1"/>检验，它表明两个不同<a id="id309" class="calibre1"/>组的<a id="id308" class="calibre1"/>总体分布是相同的，而<a id="id310" class="calibre1"/>没有假定这两个组是正态分布的。这个食谱将展示如何在r。</h1></div></div></div><p class="calibre7">做好准备</p></div></body></html>


<html>
  <head>
    <title>Understanding the Wilcoxon Rank Sum and Signed Rank test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">确保<code class="email">mtcars</code>已经加载到R会话内的数据帧中。由于<code class="email">wilcox.test</code>函数源自<code class="email">stats</code>包，确保库<code class="email">stats</code>已加载。</h2></div></div></div><p class="calibre7"><a id="ch03lvl2sec110" class="calibre1"/>怎么做...</p></div></div></body></html>


<html>
  <head>
    <title>Understanding the Wilcoxon Rank Sum and Signed Rank test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">执行以下步骤:</h2></div></div></div><p class="calibre7">自动挡汽车和手动挡汽车的mpg箱线图</p><div><ol class="orderedlist"><li class="listitem" value="1">We first plot the data of <code class="email">mtcars</code> with the <code class="email">boxplot</code> function:<div><pre class="programlisting">
<strong class="calibre2">&gt; boxplot(mtcars$mpg~mtcars$am,ylab='mpg',names=c('automatic','manual'))</strong>
</pre></div><div><img src="img/00066.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">接下来，我们<a id="id311" class="calibre1"/>仍然执行Wilcoxon <a id="id312" class="calibre1"/>秩和检验，以验证自动变速器汽车的分布是否与手动变速器汽车的分布相同:<div> <pre class="programlisting"> <strong class="calibre2">&gt; wilcox.test(mpg ~ am, data=mtcars)</strong>  <strong class="calibre2">  Wilcoxon rank sum test with continuity correction</strong>  <strong class="calibre2">data:  mpg by am</strong> <strong class="calibre2">W = 42, p-value = 0.001871</strong> <strong class="calibre2">alternative hypothesis: true location shift is not equal to 0</strong>  <strong class="calibre2">Warning message:</strong> <strong class="calibre2">In wilcox.test.default(x = c(21.4, 18.7, 18.1, 14.3, 24.4, 22.8,  :</strong> <strong class="calibre2">  cannot compute exact p-value with ties</strong> </pre> </div></p></div></div><p class="calibre13"><a id="ch03lvl2sec111" class="calibre1"/>工作原理...</p></li><li class="listitem" value="2">在这份食谱中，我们讨论一种非参数检验方法，Wilcoxon秩和检验(也称为Mann-Whitney U检验)。对于student的t检验，假设两个样本之间的差异是正态分布的(当两个样本都是正态分布时，效果最好)。然而，当正态假设不确定时，可以采用Wilcoxon秩和检验来检验假设。</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Understanding the Wilcoxon Rank Sum and Signed Rank test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">这里，我们使用了一个<a id="id313" class="calibre1"/> Wilcoxon秩和检验来确定<a id="id314" class="calibre1"/>数据集<code class="email">mtcars</code>中的自动挡和手动挡汽车的mpg是否同分布。从测试结果中我们看到p值= 0.001871 ( &lt; 0.05)拒绝了零假设，也揭示了mpg在自动挡和手动挡汽车中的分布并不完全相同。执行此测试时，您可能会收到警告消息“无法计算带连接的精确p值”，这表明数据集中存在重复值。删除重复值后，警告消息将被清除。</h2></div></div></div><p class="calibre7"><a id="ch03lvl2sec112" class="calibre1"/>参见</p><p class="calibre7">要阅读更多关于Wilcoxon秩和及有符号秩检验的用法，请使用<code class="email">help</code>功能查看相关文档:<div> <pre class="programlisting"> <strong class="calibre2">&gt; ? wilcox.test</strong> </pre> </div></p></div></div></body></html>


<html>
  <head>
    <title>Understanding the Wilcoxon Rank Sum and Signed Rank test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl1sec37" class="calibre1"/>使用皮尔森卡方检验</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">在本食谱中，我们<a id="id315" class="calibre1"/>引入皮尔森卡方检验，用于检验两组<a id="id316" class="calibre1"/>分类变量的分布是否不同。我们将讨论如何在r中进行皮尔逊卡方检验。</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Working with Pearson's Chi-squared test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">准备就绪</h1></div></div></div><p class="calibre7">确保<code class="email">mtcars</code>已经加载到R会话内的数据帧中。由于<code class="email">chisq.test</code>函数来源于<code class="email">stats?</code>包，确保库<code class="email">stats,</code>已加载。</p></div></body></html>


<html>
  <head>
    <title>Working with Pearson's Chi-squared test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch03lvl2sec114" class="calibre1"/>怎么做</h2></div></div></div><p class="calibre7">执行以下步骤:</p></div></div></body></html>


<html>
  <head>
    <title>Working with Pearson's Chi-squared test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">为了制作计数表，我们首先使用根据变速器类型和前进档数量的输入建立的列联表:<div> <pre class="programlisting"> <strong class="calibre2">&gt; ftable = table(mtcars$am, mtcars$gear)</strong> <strong class="calibre2">&gt; ftable</strong> <strong class="calibre2">   </strong> <strong class="calibre2">     3  4  5</strong> <strong class="calibre2">  0 15  4  0</strong> <strong class="calibre2">  1  0  8  5</strong> </pre> </div></h2></div></div></div><p class="calibre7">自动挡和手动挡汽车的前进档数量</p><div><ol class="orderedlist"><li class="listitem" value="1">To make the counting table, we first use the contingency table built with the inputs of the transmission type and number of forward gears:<div><pre class="programlisting">
<strong class="calibre2">&gt; ftable = table(mtcars$am, mtcars$gear)</strong>
<strong class="calibre2">&gt; ftable</strong>
<strong class="calibre2">   </strong>
<strong class="calibre2">     3  4  5</strong>
<strong class="calibre2">  0 15  4  0</strong>
<strong class="calibre2">  1  0  8  5</strong>
</pre></div></li><li class="listitem" value="2">We<a id="id317" class="calibre1"/> then plot the mosaic plot of the contingency table:<div><pre class="programlisting">
<strong class="calibre2">&gt; mosaicplot(ftable, main="Number of Forward Gears Within Automatic and Manual Cars", color = TRUE)</strong>
</pre></div><div><img src="img/00067.jpeg" alt="How to do it" class="calibre9"/><div><p class="calibre12">接下来，我们对列联表进行皮尔逊卡方检验，以检验自动变速器和手动变速器的档位数量是否相同:<div> <pre class="programlisting"> <strong class="calibre2">&gt; chisq.test(ftable)</strong>  <strong class="calibre2">  Pearson's Chi-squared test</strong>  <strong class="calibre2">data:  ftable</strong> <strong class="calibre2">X-squared = 20.9447, df = 2, p-value = 2.831e-05</strong>  <strong class="calibre2">Warning message:</strong> <strong class="calibre2">In chisq.test(ftable) : Chi-squared approximation may be incorrect</strong> </pre> </div></p></div></div><p class="calibre13"><a id="ch03lvl2sec115" class="calibre1"/>工作原理...</p></li><li class="listitem" value="3">皮尔逊卡方检验是一种统计检验，用于发现两个<a id="id318" class="calibre1"/>分类变量之间是否存在关系。它最适用于大样本的不成对数据。如果您想进行Pearson的卡方检验，您需要确保输入样本满足两个假设:首先，两个输入变量应该是分类的。其次，变量应该包括两个或多个独立的组。</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Working with Pearson's Chi-squared test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">在皮尔逊的卡方检验中，假设我们有两个变量，A和B；我们可以用下面的陈述来说明无效假设和替代假设:</h2></div></div></div><p class="calibre7">H <sub class="calibre25"> 0 </sub>:变量A和变量B是独立的</p><p class="calibre7">H <sub class="calibre25"> 1 </sub>:变量A和变量B不是独立的</p><div><ul class="itemizedlist"><li class="listitem">为了检验零假设是正确的还是不正确的，卡方检验采取以下步骤。</li><li class="listitem">它计算卡方检验统计量，<img src="img/00068.jpeg" alt="How it works..." class="calibre24"/>:</li></ul></div><p class="calibre7">To test whether the null hypothesis is correct or incorrect, the Chi-squared test takes these steps.</p><p class="calibre7">这里，r是列联表中的行数，c是列联表中的列数，O <sub class="calibre25"> i，j </sub>是观测频率计数，E <sub class="calibre25"> i，j </sub>是期望频率计数。</p><div><img src="img/00069.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10">它决定了该统计的自由度<code class="email">df</code>。自由度等于:</p><p class="calibre7">这里，r是一个变量的级数，c是另一个变量的级数。</p><p class="calibre7">它将<img src="img/00071.jpeg" alt="How it works..." class="calibre24"/>与自由度卡方分布的临界值进行比较。</p><div><img src="img/00070.jpeg" alt="How it works..." class="calibre9"/></div><p class="calibre10">在本食谱中，我们使用列联表和镶嵌图来说明计数的差异。很明显，自动挡汽车的前进挡位数比手动挡汽车少。</p><p class="calibre7">然后，我们<a id="id319" class="calibre1"/>在列联表上执行皮尔逊卡方检验，以确定自动和手动变速器汽车中的档位是否相同。输出p值= 2.831e-05 ( &lt; 0.05)，反驳了零假设，并表明自动和手动变速器汽车的前进档数量不同。但是，输出消息包含一条警告消息，指出卡方近似可能不正确，这是因为列联表中的样本数小于5。</p><p class="calibre7"><a id="ch03lvl2sec116" class="calibre1"/>还有更多...</p><p class="calibre7">要阅读有关皮尔逊卡方检验用法的更多信息，请使用<code class="email">help</code>功能查看相关文档:</p><p class="calibre7">除了前面例子中提到的一些常见的假设检验方法之外，R:</p></div></div></body></html>


<html>
  <head>
    <title>Working with Pearson's Chi-squared test</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="id320" class="calibre1"/>比例测试(<code class="email">prop.test</code>):用于测试不同组的比例是否相同的<a id="id321" class="calibre1"/></h2></div></div></div><p class="calibre7"><a id="id322" class="calibre1"/> Z检验(UsingR包中的<code class="email">simple.z.test</code>):它<a id="id323" class="calibre1"/>将样本均值与总体均值和标准差进行比较</p><div><pre class="programlisting">
<strong class="calibre2">&gt; ? chisq.test</strong>
</pre></div><p class="calibre7"><a id="id324" class="calibre1"/> Bartlett检验(<code class="email">bartlett.test</code>):用于检验不同组的方差是否相同的<a id="id325" class="calibre1"/></p><div><ul class="itemizedlist"><li class="listitem"><a id="id326" class="calibre1"/>克鲁斯卡尔-沃利斯秩和检验(<code class="email">kruskal.test</code>):在不假设正态分布的情况下，用于检验不同<a id="id327" class="calibre1"/>组的分布是否相同</li><li class="listitem">夏皮罗-维尔克检验(<code class="email">shapiro.test</code>):这是用于正态性检验的<a id="id329" class="calibre1"/></li><li class="listitem"><a id="ch03lvl1sec38" class="calibre1"/>进行单因素方差分析</li><li class="listitem"><strong class="calibre2">分析</strong> <a id="id330" class="calibre1"/> <strong class="calibre2">方差</strong> ( <strong class="calibre2"> ANOVA </strong>)考察<a id="id331" class="calibre1"/>分类自变量与连续因变量之间的关系。可以用来检验几组的均值是否相等。如果只有一个分类变量作为自变量，可以进行单向ANOVA。另一方面，如果有两个以上的<a id="id333" class="calibre1"/>分类变量，您应该执行双向ANOVA。在这个食谱中，我们将讨论如何对r进行单向方差分析。</li><li class="listitem"><a id="ch03lvl2sec117" class="calibre1"/>做好准备</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Conducting a one-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">确保<code class="email">mtcars</code>已经加载到R会话内的数据帧中。因为<code class="email">oneway.test</code>和<code class="email">TukeyHSD</code>函数源自<code class="email">stats</code>包，所以确保库<code class="email">stats</code>被加载。</h1></div></div></div><p class="calibre7"><a id="ch03lvl2sec118" class="calibre1"/>怎么做...</p></div></body></html>


<html>
  <head>
    <title>Conducting a one-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">执行以下步骤:</h2></div></div></div><p class="calibre7">不同前进档数的mpg比较</p></div></div></body></html>


<html>
  <head>
    <title>Conducting a one-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec118" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">接下来，我们进行单向ANOVA来检验<code class="email">mpg</code>的平均值是否随着不同的前进档数而变化。我们使用函数，<code class="email">oneway.test</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; oneway.test(mtcars$mpg~factor(mtcars$gear))</strong>  <strong class="calibre2">  One-way analysis of means (not assuming equal variances)</strong>  <strong class="calibre2">data:  mtcars$mpg and factor(mtcars$gear)</strong> <strong class="calibre2">F = 11.2848, num df = 2.000, denom df = 9.508, p-value = 0.003085</strong> </pre> </div></p><div><ol class="orderedlist"><li class="listitem" value="1">We begin exploring by visualizing the data with a boxplot:<div><pre class="programlisting">
<strong class="calibre2">&gt; boxplot(mtcars$mpg~factor(mtcars$gear),xlab='gear',ylab='mpg')</strong>
</pre></div><div><img src="img/00072.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">除了<a id="id334" class="calibre1"/>到<code class="email">oneway.test</code>之外，一个标准的<a id="id335" class="calibre1"/>函数<code class="email">aov</code>用于方差分析:<div> <pre class="programlisting"> <strong class="calibre2">&gt; mtcars.aov = aov(mtcars$mpg ~ as.factor(mtcars$gear))</strong> <strong class="calibre2">&gt; summary(mtcars.aov)</strong> <strong class="calibre2">                       Df Sum Sq Mean Sq F value   Pr(&gt;F)    </strong> <strong class="calibre2">as.factor(mtcars$gear)  2  483.2  241.62    10.9 0.000295 ***</strong> <strong class="calibre2">Residuals              29  642.8   22.17                     </strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong> </pre> </div></p></div></div><p class="calibre13">由<code class="email">aov</code>函数生成的模型也可以生成一个摘要作为拟合表:<div> <pre class="programlisting"> <strong class="calibre2">&gt; model.tables(mtcars.aov, "means")</strong> <strong class="calibre2">Tables of means</strong> <strong class="calibre2">Grand mean</strong> <strong class="calibre2">         </strong> <strong class="calibre2">20.09062 </strong>  <strong class="calibre2"> as.factor(mtcars$gear) </strong> <strong class="calibre2">        3     4     5</strong> <strong class="calibre2">    16.11 24.53 21.38</strong> <strong class="calibre2">rep 15.00 12.00  5.00</strong> </pre> </div></p></li><li class="listitem" value="2">对于<code class="email">aov</code>模型，可以使用<code class="email">TukeyHSD</code>进行事后比较测试:<div> <pre class="programlisting"> <strong class="calibre2">&gt; mtcars_posthoc =TukeyHSD(mtcars.aov)</strong> <strong class="calibre2">&gt; mtcars_posthoc</strong> <strong class="calibre2">  Tukey multiple comparisons of means</strong> <strong class="calibre2">    95% family-wise confidence level</strong>  <strong class="calibre2">Fit: aov(formula = mtcars$mpg ~ as.factor(mtcars$gear))</strong>  <strong class="calibre2">$`as.factor(mtcars$gear)`</strong> <strong class="calibre2">         diff        lwr       upr     p adj</strong> <strong class="calibre2">4-3  8.426667  3.9234704 12.929863 0.0002088</strong> <strong class="calibre2">5-3  5.273333 -0.7309284 11.277595 0.0937176</strong> <strong class="calibre2">5-4 -3.153333 -9.3423846  3.035718 0.4295874</strong> </pre> </div></li><li class="listitem" value="3">不同齿数组的Tukey均值-差图</li><li class="listitem" value="4">The model generated by the <code class="email">aov</code> function can also generate a summary as a fitted table:<div><pre class="programlisting">
<strong class="calibre2">&gt; model.tables(mtcars.aov, "means")</strong>
<strong class="calibre2">Tables of means</strong>
<strong class="calibre2">Grand mean</strong>
<strong class="calibre2">         </strong>
<strong class="calibre2">20.09062 </strong>

<strong class="calibre2"> as.factor(mtcars$gear) </strong>
<strong class="calibre2">        3     4     5</strong>
<strong class="calibre2">    16.11 24.53 21.38</strong>
<strong class="calibre2">rep 15.00 12.00  5.00</strong>
</pre></div></li><li class="listitem" value="5"><a id="ch03lvl2sec119" class="calibre1"/>工作原理...</li><li class="listitem" value="6">Further, we <a id="id336" class="calibre1"/>can visualize the differences <a id="id337" class="calibre1"/>in mean level with a <code class="email">plot</code> function:<div><img src="img/00073.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">为了了解具有不同前进档数量的汽车在mpg中是否具有不同的均值，我们首先根据前进档数量绘制mpg的箱线图。这提供了一个简单的指示，如果汽车有不同数量的前进档有不同的平均英里数。然后，我们进行最基本形式的方差分析，即单向方差分析，以测试人群是否有不同的均值。</p></div></div><p class="calibre13">在R中，有两个函数执行ANOVA测试:<code class="email">oneway.test</code>和<code class="email">aov</code>。<code class="email">oneway.test</code>的优点是该函数应用韦尔奇校正来解决方差的非均匀性。然而，它提供的信息不如<code class="email">aov</code>多，也不提供事后测试。接下来，我们对自变量<code class="email">gear</code>和因变量<code class="email">mpg</code>执行<code class="email">oneway.test</code>和<code class="email">aov</code>。两个测试结果都显示了一个小的p值，这拒绝了零假设，即具有不同数量前进档的汽车之间的平均值具有相同的<code class="email">mpg</code>平均值。</p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Conducting a one-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">由于方差分析的结果仅表明总体均值存在显著差异，您可能不知道哪两个群体的均值有所不同。因此，我们对ANOVA模型应用了<code class="email">TukeyHSD</code>事后比较测试。<a id="id338" class="calibre1"/>结果显示，有四个前进档<a id="id339" class="calibre1"/>的汽车和有三个前进档的汽车差别最大，因为它们的置信区间在图中最靠右。</h2></div></div></div><p class="calibre7">还有更多...</p><p class="calibre7">方差分析依赖于f分布作为所有概率分布的基础。通过将组间方差除以组内方差获得F分数。如果总体f检验显著，您可以进行事后检验(或多重比较检验)来衡量组间的差异。最常用的事后检验是谢弗法、图基-克雷默法和邦费罗尼校正法。</p><p class="calibre7">为了解释ANOVA的输出，您需要对某些术语有一个基本的了解，包括自由度、平方和、平方组和、平方误差和、均方误差和F统计量。如果你需要更多关于这些术语的信息，你可以参考使用多元统计的<em class="calibre8"/>(Fidell，L. S .，&amp; Tabachnick，B. G. (2006) <em class="calibre8">波士顿:Allyn &amp; Bacon </em>。)，或者<a id="id340" class="calibre1"/>参考方差分析的维基百科词条(<a class="calibre1" href="http://en.wikipedia.org/wiki/Analysis_of_variance#cite_ref-31">http://en . Wikipedia . org/wiki/Analysis _ of _ variance # cite _ ref-31</a>)。</p></div></div></body></html>


<html>
  <head>
    <title>Conducting a one-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl1sec39" class="calibre1"/>进行双向方差分析</h2></div></div></div><p class="calibre7">双向<a id="id341" class="calibre1"/>方差分析可视为单向方差分析的扩展<a id="id342" class="calibre1"/>，因为分析涵盖两个以上的分类变量，而不是一个。在这个食谱中，我们将讨论如何在r。</p><p class="calibre7">做好准备</p></div></div></body></html>


<html>
  <head>
    <title>Performing a two-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">确保<code class="email">mtcars</code>已经加载到R会话内的数据帧中。由于<code class="email">twoway.test</code>、<code class="email">TukeyHSD</code>和<code class="email">interaction.plot</code>功能源自<code class="email">stats</code>包，确保<code class="email">stats</code>库已加载。</h1></div></div></div><p class="calibre7"><a id="ch03lvl2sec122" class="calibre1"/>怎么做...</p></div></body></html>


<html>
  <head>
    <title>Performing a two-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">执行以下步骤:</h2></div></div></div><p class="calibre7">按齿轮组和变速器类型划分的mpg箱线图</p></div></div></body></html>


<html>
  <head>
    <title>Performing a two-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch03lvl2sec122" class="calibre1"/>How to do it...</h2></div></div></div><p class="calibre7">按档位*变速器类型划分的mpg箱线图</p><div><ol class="orderedlist"><li class="listitem" value="1">First<a id="id343" class="calibre1"/> we plot the two boxplots<a id="id344" class="calibre1"/> of factor gears in regard to mpg, with the plot separated from the transmission type:<div><pre class="programlisting">
<strong class="calibre2">&gt; par(mfrow=c(1,2))</strong>
<strong class="calibre2">&gt; boxplot(mtcars$mpg~mtcars$gear,subset=(mtcars$am==0),xlab='gear', ylab = "mpg",main='automatic')</strong>
<strong class="calibre2">&gt; boxplot(mtcars$mpg~mtcars$gear,subset=(mtcars$am==1),xlab='gear', ylab = "mpg", main='manual')</strong>
</pre></div><div><img src="img/00074.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">The boxplots of mpg by the gear group and the transmission type</p></div></div><p class="calibre13">变速器类型和具有主要影响的档位数量之间的相互作用，mpg</p></li><li class="listitem" value="2">Also, you may produce a boxplot of mpg by the number of forward gears <code class="email">*</code> transmission type, with the use of the <code class="email">*</code> operation in the <code class="email">boxplot</code> function:<div><pre class="programlisting">
<strong class="calibre2">&gt; boxplot(mtcars$mpg~factor(mtcars$gear)* factor(mtcars$am),xlab='gear * transmission', ylab = "mpg",main='Boxplot of mpg by gear * transmission')</strong>
</pre></div><div><img src="img/00075.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">然后我们<a id="id347" class="calibre1"/>结合档位和变速器类型因素对mpg进行双向<a id="id348" class="calibre1"/>方差分析:<div> <pre class="programlisting"> <strong class="calibre2">&gt; mpg_anova2 = aov(mtcars$mpg~factor(mtcars$gear)*factor(mtcars$am))</strong> <strong class="calibre2">&gt; summary(mpg_anova2) </strong> <strong class="calibre2">                    Df Sum Sq Mean Sq F value   Pr(&gt;F)    </strong> <strong class="calibre2">factor(mtcars$gear)  2  483.2  241.62  11.869 0.000185 ***</strong> <strong class="calibre2">factor(mtcars$am)    1   72.8   72.80   3.576 0.069001 .  </strong> <strong class="calibre2">Residuals           28  570.0   20.36                     </strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong> </pre> </div></p></div></div><p class="calibre13">类似于单向方差分析，我们可以执行事后比较测试来查看双向方差分析模型的结果:<div> <pre class="programlisting"> <strong class="calibre2">&gt; TukeyHSD(mpg_anova2)</strong> <strong class="calibre2">  Tukey multiple comparisons of means</strong> <strong class="calibre2">    95% family-wise confidence level</strong>  <strong class="calibre2">Fit: aov(formula = mtcars$mpg ~ factor(mtcars$gear) * factor(mtcars$am))</strong>  <strong class="calibre2">$`factor(mtcars$gear)`</strong> <strong class="calibre2">         diff        lwr       upr     p adj</strong> <strong class="calibre2">4-3  8.426667  4.1028616 12.750472 0.0001301</strong> <strong class="calibre2">5-3  5.273333 -0.4917401 11.038407 0.0779791</strong> <strong class="calibre2">5-4 -3.153333 -9.0958350  2.789168 0.3999532</strong>  <strong class="calibre2">$`factor(mtcars$am)`</strong> <strong class="calibre2">        diff       lwr     upr     p adj</strong> <strong class="calibre2">1-0 1.805128 -1.521483 5.13174 0.2757926</strong> </pre> </div></p></li><li class="listitem" value="3">Next, we <a id="id345" class="calibre1"/>use an interaction plot to <a id="id346" class="calibre1"/>characterize the relationship between variables:<div><pre class="programlisting">
<strong class="calibre2">&gt; interaction.plot(mtcars$gear, mtcars$am, mtcars$mpg, type="b", col=c(1:3),leg.bty="o", leg.bg="beige", lwd=2, pch=c(18,24,22), xlab="Number of Gears", ylab="Mean Miles Per Gallon", main="Interaction Plot")</strong>
</pre></div><div><img src="img/00076.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">变速器类型和档位数量的平均水平差异对比图</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="4"><a id="ch03lvl2sec123" class="calibre1"/>工作原理...</li><li class="listitem" value="5">在这个食谱中，我们执行双向ANOVA来检查自变量<code class="email">gear</code>和<code class="email">am</code>对因变量<code class="email">mpg</code>的影响。在第一步中，我们使用箱线图通过档位数量和变速器类型来检查mpg的平均值。其次，我们应用一个交互图，通过不同的<a id="id351" class="calibre1"/>挡位数量以及由变速器类型分隔的<a id="id352" class="calibre1"/>线来直观显示mpg的变化。</li><li class="listitem" value="6">We <a id="id349" class="calibre1"/>then visualize the differences<a id="id350" class="calibre1"/> in mean levels with the <code class="email">plot</code> function:<div><pre class="programlisting">
<strong class="calibre2">&gt; par(mfrow=c(1,2))</strong>
<strong class="calibre2">&gt; plot(TukeyHSD(mpg_anova2))</strong>
</pre></div><div><img src="img/00077.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">结果图显示，档位数量确实对mpg的平均值有影响，但也没有显示出正相关关系。第三，我们用<code class="email">aov</code>函数进行双向方差分析。输出显示，<code class="email">gear</code>因子的p值拒绝零假设，而<code class="email">transmission type</code>因子不拒绝零假设。换句话说，不同挡位的车更有可能有不同的mpg手段。最后，为了检查哪两个群体的差异最大，我们进行了事后分析，结果显示四档和三档的汽车分别具有最大的平均mpg差异。</p></div></div><p class="calibre13"><a id="ch03lvl2sec124" class="calibre1"/>参见</p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Performing a two-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">对于多元方差分析，函数<code class="email">manova</code>可用于检查多个自变量对多个因变量的影响。关于MANOVA的更多信息包含在R: <div> <pre class="programlisting"> <strong class="calibre2">&gt; ?MANOVA</strong> </pre> </div>中的<code class="email">help</code>功能中</h2></div></div></div><p class="calibre7">In this recipe, we perform a two-way ANOVA to examine the influences of the independent variables, <code class="email">gear</code> and <code class="email">am</code>, on the dependent variable, <code class="email">mpg</code>. In the first step, we use a boxplot to examine the mean of mpg by the number of gears and the transmission type. Secondly, we apply an interaction plot to visualize the change in mpg through the different<a id="id351" class="calibre1"/> numbers of gears with lines separated <a id="id352" class="calibre1"/>by the transmission type.</p><p class="calibre7">The resulting plot shows that the number of gears does have an effect on the mean of mpg, but does not show a positive relationship either. Thirdly, we perform a two-way ANOVA with the <code class="email">aov</code> function. The output shows that the p-value of the <code class="email">gear</code> factor rejects the null hypothesis, while the factor, <code class="email">transmission type</code>, does not reject the null hypothesis. In other words, cars with different numbers of gears are more likely to have different means of mpg. Finally, in order to examine which two populations have the largest differences, we perform a post hoc analysis, which reveals that cars with four gears and three gears, respectively, have the largest difference in terms of the mean, mpg.</p></div></div></body></html>


<html>
  <head>
    <title>Performing a two-way ANOVA</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch03lvl2sec124" class="calibre1"/>See also</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">For multivariate analysis of variances, the function, <code class="email">manova</code>, can be used to examine the effect of multiple independent variables on multiple dependent variables. Further information about MANOVA is included within the <code class="email">help</code> function in R:<div><pre class="programlisting">
<strong class="calibre2">&gt; ?MANOVA</strong>
</pre></div></li></ul></div></div></div></body></html>
</body></html>