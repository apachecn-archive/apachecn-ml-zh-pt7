<html><head/><body>
<html>
  <head>
    <title>Chapter 4. Understanding Regression Analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch04" class="calibre1"/>第四章。了解回归分析</h1></div></div></div><p class="calibre7">在本章中，我们将介绍以下配方:</p><div><ul class="itemizedlist"><li class="listitem">用lm拟合线性回归模型</li><li class="listitem">总结线性模型拟合</li><li class="listitem">使用线性回归预测未知值</li><li class="listitem">生成拟合模型的诊断图</li><li class="listitem">用lm拟合多项式回归模型</li><li class="listitem">用rlm拟合稳健线性回归模型</li><li class="listitem">滑动数据线性回归案例研究</li><li class="listitem">应用高斯模型进行广义线性回归</li><li class="listitem">应用泊松模型进行广义线性回归</li><li class="listitem">应用二项式模型进行广义线性回归</li><li class="listitem">用广义加性模型拟合数据</li><li class="listitem">可视化广义加性模型</li><li class="listitem">诊断广义加性模型</li></ul></div></div></body></html>


<html>
  <head>
    <title>Chapter 4. Understanding Regression Analysis</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h1 class="title" id="calibre_pb_1"><a id="ch04lvl1sec40" class="calibre1"/>简介</h1></div></div></div><p class="calibre7">回归是一种<a id="id353" class="calibre1"/>监督学习方法，用于建模和分析因变量(响应变量)和一个或多个自变量(预测变量)之间的关系。可以使用回归来建立预测模型，该预测模型可以首先用于找到拟合值的最小平方误差的最佳拟合模型。然后，拟合的模型可以进一步应用于连续值预测的数据。</p><p class="calibre7">回归有很多种。如果只有一个预测变量，并且响应变量和独立变量之间的关系<a id="id354" class="calibre1"/>是线性的，我们可以应用线性模型。然而，如果有一个以上的预测变量，应使用多元线性回归方法。当关系是非线性时，可以使用非线性模型来模拟预测变量和响应变量之间的关系。</p><p class="calibre7">在本章中，我们将介绍如何使用<code class="email">lm</code>函数将线性模型拟合到数据中。接下来，对于非正态高斯模型中的分布(例如，泊松或二项式)，我们使用具有与数据分布相对应的适当链接函数的<code class="email">glm</code>函数。最后，我们将介绍如何使用<code class="email">gam</code>函数将广义加性模型拟合到数据中。</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a linear regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec41" class="calibre1"/>用lm拟合线性回归模型</h1></div></div></div><p class="calibre7">回归中最简单的模型是线性回归，当只有一个<a id="id355" class="calibre1"/>预测变量，且响应变量与自变量之间的关系为线性时，最好使用线性回归。在R中，我们<a id="id356" class="calibre1"/>可以用<code class="email">lm</code>函数将线性模型拟合到数据。</p></div></body></html>


<html>
  <head>
    <title>Fitting a linear regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">准备就绪</h2></div></div></div><p class="calibre7">我们需要用一个预测变量和一个响应变量来准备数据，并且这两个变量之间具有线性关系。</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a linear regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec126" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤，用<code class="email">lm</code>进行线性回归:</p><div><ol class="orderedlist"><li class="listitem" value="1">你应该安装<code class="email">car</code>包并加载它的库:<div> <pre class="programlisting"> <strong class="calibre2">&gt; install.packages("car")</strong> <strong class="calibre2">&gt; library(car)</strong> </pre> </div></li><li class="listitem" value="2">从这个包中，你可以加载<code class="email">Quartet</code>数据集:<div> <pre class="programlisting"> <strong class="calibre2">&gt; data(Quartet)</strong> </pre> </div></li><li class="listitem" value="3">您可以使用<code class="email">str</code>函数来显示<code class="email">Quartet</code>数据集的结构:<div> <pre class="programlisting"> <strong class="calibre2">&gt; str(Quartet)</strong> <strong class="calibre2">'data.frame':   11 obs. of  6 variables:</strong> <strong class="calibre2"> $ x : int  10 8 13 9 11 14 6 4 12 7 ...</strong> <strong class="calibre2"> $ y1: num  8.04 6.95 7.58 8.81 8.33 ...</strong> <strong class="calibre2"> $ y2: num  9.14 8.14 8.74 8.77 9.26 8.1 6.13 3.1 9.13 7.26 ...</strong> <strong class="calibre2"> $ y3: num  7.46 6.77 12.74 7.11 7.81 ...</strong> <strong class="calibre2"> $ x4: int  8 8 8 8 8 8 8 19 8 8 ...</strong> <strong class="calibre2"> $ y4: num  6.58 5.76 7.71 8.84 8.47 7.04 5.25 12.5 5.56 7.91 ...</strong> </pre> </div></li><li class="listitem" value="4">Draw<a id="id357" class="calibre1"/> a scatter plot of the <a id="id358" class="calibre1"/>x and y variables with <code class="email">plot</code>, and append a fitted line through the <code class="email">lm</code> and <code class="email">abline</code> function:<div><pre class="programlisting">
<strong class="calibre2">&gt; plot(Quartet$x, Quartet$y1)</strong>
<strong class="calibre2">&gt; lmfit = lm(y1~x, Quartet) </strong>
<strong class="calibre2">&gt; abline(lmfit, col="red")  </strong>
</pre></div><div><img src="img/00078.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">用lm拟合的简单回归图</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="5">要查看拟合模型，执行以下命令:<div> <pre class="programlisting"> <strong class="calibre2">&gt; lmfit</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">lm(formula = y1 ~ x, data = Quartet)</strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">(Intercept)            x  </strong> <strong class="calibre2">     3.0001       0.5001 </strong> </pre> </div></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Fitting a linear regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch04lvl2sec127" class="calibre1"/>工作原理...</h2></div></div></div><p class="calibre7"><a id="id359" class="calibre1"/>回归模型具有<code class="email">response ~ terms</code>形式，其中<code class="email">response</code>是响应向量，<code class="email">terms</code>是指定预测值的一系列<a id="id360" class="calibre1"/>项。我们可以用公式<em class="calibre8"> y=α+βx </em>来说明一个简单的回归模型，其中<em class="calibre8"> α </em>是截距，而斜率<em class="calibre8"> β </em>描述了当<em class="calibre8"> x </em>变化时<em class="calibre8"> y </em>的变化。利用最小二乘法，我们可以估计出<img src="img/00079.jpeg" alt="How it works..." class="calibre24"/>和<img src="img/00080.jpeg" alt="How it works..." class="calibre24"/>(其中<img src="img/00081.jpeg" alt="How it works..." class="calibre24"/>表示<em class="calibre8"> y </em>的平均值，<img src="img/00082.jpeg" alt="How it works..." class="calibre24"/>表示<em class="calibre8"> x </em>的平均值)。</p><p class="calibre7">为了执行线性回归，我们首先准备在预测变量和响应变量之间具有线性关系的数据。在这个例子中，我们从package car加载Anscombe的四重奏数据集。在数据集中，<em class="calibre8"> x </em>和<em class="calibre8"> y1 </em>变量具有线性关系，我们准备了这些变量的散点图。为了生成回归线，我们使用lm函数来生成两个变量的模型。此外，我们使用<code class="email">abline</code>在图上画一条回归线。根据之前的截图，回归线说明了<em class="calibre8"> x </em>和<em class="calibre8"> y1 </em>变量的线性关系。我们可以看到，拟合模型的系数显示截距等于3.0001，系数等于0.5001。因此，我们可以使用截距和系数来推断响应值。比如我们可以推断出在3处的<em class="calibre8"> x </em>等于<em class="calibre8">4.5103(3 * 0.5001+3.0001)</em>时的响应值。</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a linear regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">还有更多...</h2></div></div></div><p class="calibre7">除了<code class="email">lm</code>函数，您还可以使用<code class="email">lsfit</code>函数来执行简单的线性回归。例如:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; plot(Quartet$x, Quartet$y1)</strong>
<strong class="calibre2">&gt; lmfit2 = lsfit(Quartet$x,Quartet$y1)</strong>
<strong class="calibre2">&gt; abline(lmfit2, col="red")</strong>
</pre></div><div><img src="img/00083.jpeg" alt="There's more..." class="calibre9"/><div><p class="calibre12">由lsfit函数拟合的简单回归。</p></div></div><p class="calibre10"> </p></div></div></body></html>


<html>
  <head>
    <title>Summarizing linear model fits</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec42" class="calibre1"/>总结线性模型拟合</h1></div></div></div><p class="calibre7"><code class="email">summary</code>功能可用于获取拟合模型的格式化系数、标准误差、自由度<a id="id361" class="calibre1"/>和其他汇总信息。该食谱介绍了<a id="id362" class="calibre1"/>如何通过使用<code class="email">summary</code>功能获得一个模型的全部信息。</p></div></body></html>


<html>
  <head>
    <title>Summarizing linear model fits</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">做好准备</h2></div></div></div><p class="calibre7">您需要通过计算来自四元组的<em class="calibre8"> x </em>和<em class="calibre8"> y1 </em>变量的线性模型来完成之前的配方，并将拟合的模型分配给<code class="email">lmfit</code>变量。</p></div></div></body></html>


<html>
  <head>
    <title>Summarizing linear model fits</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec130" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤来总结线性模型拟合:</p><div><ol class="orderedlist"><li class="listitem" value="1">计算拟合模型的详细概要:<div> <pre class="programlisting"> <strong class="calibre2">&gt; summary(lmfit)</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">lm(formula = y1 ~ x)</strong>  <strong class="calibre2">Residuals:</strong> <strong class="calibre2">     Min       1Q   Median       3Q      Max </strong> <strong class="calibre2">-1.92127 -0.45577 -0.04136  0.70941  1.83882 </strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">            Estimate Std. Error t value Pr(&gt;|t|)   </strong> <strong class="calibre2">(Intercept)   3.0001     1.1247   2.667  0.02573 * </strong> <strong class="calibre2">Quartet$x     0.5001     0.1179   4.241  0.00217 **</strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">Residual standard error: 1.237 on 9 degrees of freedom</strong> <strong class="calibre2">Multiple R-squared:  0.6665,    Adjusted R-squared:  0.6295 </strong> <strong class="calibre2">F-statistic: 17.99 on 1 and 9 DF,  p-value: 0.00217</strong> </pre> </div></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Summarizing linear model fits</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch04lvl2sec131" class="calibre1"/>工作原理...</h2></div></div></div><p class="calibre7"><code class="email">summary</code>函数是一个通用函数，用于生成汇总统计数据。在这种情况下，它<a id="id363" class="calibre1"/>计算并返回拟合线性模型的汇总统计列表。在这里，它将输出诸如残差、系数标准差R平方、f统计量和自由度等信息。在<code class="email">Call</code>部分，显示调用生成拟合<a id="id364" class="calibre1"/>模型的函数。在<code class="email">Residuals</code>部分，它提供了分布的快速总结(最小值、1Q值、中值、3Q、最大值)。</p><p class="calibre7">在<code class="email">Coefficients</code>部分，每个系数都是一个高斯随机变量。在本节中，<code class="email">Estimate</code>代表变量的平均分布；<code class="email">Std.Error</code>显示变量的标准误差；<code class="email">t</code>值是<code class="email">Estimate</code>除以<code class="email">Std.Error</code>，<code class="email">p</code>值表示获得大于<code class="email">t</code>值的值的概率。在本例中，截距(0.002573)和x (0.00217)的<code class="email">p</code>值都有95%的置信度。</p><p class="calibre7">残差标准差输出残差的标准差，而自由度表示训练样本中的观察值与模型中使用的数量之间的差异。通过除以平方和得到多个R平方。人们可以使用R平方来衡量数据与回归线的拟合程度。通常，R平方越高，模型就越符合您的数据。然而，它不一定表明回归模型是否足够。这意味着您可能会得到一个R平方较低的好模型，也可能会得到一个R平方较高的坏模型。由于多个R平方忽略了一个自由度，因此计算出的分数是有偏差的。为了使计算公平，调整后的R平方(0.6295)使用无偏估计值，并且将略小于R平方的倍数(0.6665)。通过对模型执行f检验来检索f统计量。等于0.00217 ( &lt; 0.05)的<code class="email">p</code>值拒绝零假设(变量之间没有线性相关性)，并表明观察到的<code class="email">F</code>大于临界<code class="email">F</code>值。换句话说，结果显示变量之间存在显著的正线性相关性。</p></div></div></body></html>


<html>
  <head>
    <title>Summarizing linear model fits</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch04lvl2sec132" class="calibre1"/>参见</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">关于用于获取拟合模型摘要的参数的更多信息，您可以使用<code class="email">help</code>功能或<code class="email">?</code>查看帮助<a id="id366" class="calibre1"/>页面:<div> <pre class="programlisting"> <strong class="calibre2">&gt; ?summary.lm</strong> </pre> </div></li><li class="listitem">或者，您可以使用以下函数来显示模型的属性:<div> <pre class="programlisting"> <strong class="calibre2">&gt;  coefficients(lmfit) # Extract model coefficients</strong> <strong class="calibre2">&gt;  confint(lmfit, level=0.95)  # Computes confidence intervals for model parameters.</strong> <strong class="calibre2">&gt;  fitted(lmfit) # Extract model fitted values</strong> <strong class="calibre2">&gt;  residuals(lmfit) # Extract model residuals </strong> <strong class="calibre2">&gt;  anova(lmfit) # Compute analysis of variance tables for fitted model object</strong> <strong class="calibre2">&gt;  vcov(lmfit) # Calculate variance-covariance matrix for a fitted model object</strong> <strong class="calibre2">&gt;  influence(lmfit) # Diagnose quality of regression fits</strong> </pre> </div></li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Using linear regression to predict unknown values</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec43" class="calibre1"/>使用线性回归预测未知值</h1></div></div></div><p class="calibre7">使用<a id="id367" class="calibre1"/>拟合的回归模型，我们可以应用该模型预测未知值。对于回归模型，我们可以用预测区间和置信区间来表示预测的精度。在下面的食谱中，我们介绍如何在这两种测量下预测未知值。</p></div></body></html>


<html>
  <head>
    <title>Using linear regression to predict unknown values</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">做好准备</h2></div></div></div><p class="calibre7">您需要通过从<code class="email">quartet</code>数据集计算x和y1变量的线性模型来完成之前的配方。</p></div></div></body></html>


<html>
  <head>
    <title>Using linear regression to predict unknown values</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec134" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤，使用线性回归来预测值:</p><div><ol class="orderedlist"><li class="listitem" value="1">用<code class="email">x</code>和<code class="email">y1</code>变量拟合线性模型:<div> <pre class="programlisting"> <strong class="calibre2">&gt; lmfit = lm(y1~x, Quartet)</strong> </pre> </div></li><li class="listitem" value="2">将需要预测的<a id="id368" class="calibre1"/>值赋值到<code class="email">newdata</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; newdata = data.frame(x = c(3,6,15))</strong> </pre> </div></li><li class="listitem" value="3">使用<code class="email">level</code>设置为<code class="email">0.95</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; predict(lmfit, newdata, interval="confidence", level=0.95)</strong> <strong class="calibre2">        fit      lwr       upr</strong> <strong class="calibre2">1  4.500364 2.691375  6.309352</strong> <strong class="calibre2">2  6.000636 4.838027  7.163245</strong> <strong class="calibre2">3 10.501455 8.692466 12.310443</strong> </pre> </div>的置信区间计算预测结果</li><li class="listitem" value="4">使用此预测区间计算预测结果:<div> <pre class="programlisting"> <strong class="calibre2">&gt; predict(lmfit, newdata, interval="predict")</strong> <strong class="calibre2">        fit      lwr       upr</strong> <strong class="calibre2">1  4.500364 1.169022  7.831705</strong> <strong class="calibre2">2  6.000636 2.971271  9.030002</strong> <strong class="calibre2">3 10.501455 7.170113 13.832796</strong> </pre> </div></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Using linear regression to predict unknown values</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><a id="ch04lvl2sec135" class="calibre1"/>工作原理...</h2></div></div></div><p class="calibre7">我们首先用<code class="email">x</code>和<code class="email">y1</code>变量建立一个线性拟合模型。接下来，我们将要预测的值分配到数据帧中，<code class="email">newdata</code>。需要注意的是，生成的模型是<code class="email">y1 ~ x</code>的形式。</p><p class="calibre7">接下来，我们通过在自变量区间中指定<code class="email">confidence</code>来使用置信区间计算预测结果。从第1行的输出中，我们得到了符合<code class="email">x=3</code>输入的<code class="email">y1</code>，它等于<code class="email">4.500364</code>，并且<code class="email">x=3</code>的<code class="email">y1</code>平均值的95%置信区间(在<code class="email">level</code>参数中设置为0.95)在<code class="email">2.691375</code>和<code class="email">6.309352</code>之间。除此之外，第2行和第3行给出了输入为<code class="email">x=6</code>和<code class="email">x=15</code>的<code class="email">y1</code>的预测结果。</p><p class="calibre7">接下来，我们通过在自变量区间中指定<code class="email">prediction</code>来使用预测区间计算预测结果。从第1行的输出中，我们可以看到<code class="email">x=3</code>输入的拟合<code class="email">y1</code>等于<code class="email">4.500364</code>，并且<code class="email">x=3</code>的<code class="email">y1</code>的95%预测区间在<code class="email">1.169022</code>和<code class="email">7.831705</code>之间。第2行和第3行用输入<code class="email">x=6</code>和<code class="email">x=15</code>输出<code class="email">y1</code>的预测结果。</p></div></div></body></html>


<html>
  <head>
    <title>Using linear regression to predict unknown values</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch04lvl2sec136" class="calibre1"/>参见</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">对于<a id="id369" class="calibre1"/>那些对预测区间和置信区间的区别感兴趣的<a id="id370" class="calibre1"/>，可以参考<a class="calibre1" href="http://en.wikipedia.org/wiki/Prediction_interval#Contrast_with_confidence_intervals">http://en . Wikipedia . org/wiki/Prediction _ interval # Contrast _ with _ confidence _ intervals</a>的维基百科词条<em class="calibre8"> contrast with置信区间</em>。</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Generating a diagnostic plot of a fitted model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec44" class="calibre1"/>生成拟合模型的诊断图</h1></div></div></div><p class="calibre7">诊断是评估回归假设的方法，可用于确定<a id="id371" class="calibre1"/>拟合模型是否充分代表数据。在下面的食谱中，我们将介绍如何通过使用诊断图来诊断回归模型。</p></div></body></html>


<html>
  <head>
    <title>Generating a diagnostic plot of a fitted model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1"><a id="ch04lvl2sec137" class="calibre1"/>做好准备</h2></div></div></div><p class="calibre7">您需要通过计算来自四元组的x和y1变量的线性模型来完成之前的配方，并将该模型分配给<code class="email">lmfit</code>变量。</p></div></div></body></html>


<html>
  <head>
    <title>Generating a diagnostic plot of a fitted model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec138" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤，生成拟合模型的诊断图:</p><div><ol class="orderedlist"><li class="listitem" value="1">Plot the diagnostic plot of the regression model:<div><pre class="programlisting">
<strong class="calibre2">&gt; par(mfrow=c(2,2))</strong>
<strong class="calibre2">&gt; plot(lmfit)</strong>
</pre></div><div><img src="img/00084.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">回归模型的诊断图</p></div></div><p class="calibre13"> </p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Generating a diagnostic plot of a fitted model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">它是如何工作的...</h2></div></div></div><p class="calibre7">绘图功能<a id="id372" class="calibre1"/>生成回归模型的四个诊断图:</p><div><ul class="itemizedlist"><li class="listitem">左上图显示了残差与拟合值的关系。在图中，残差表示从点到回归线的垂直距离。如果所有点都正好落在回归线上，则所有残差都将正好落在灰色虚线上。图中的红线是关于残差的平滑曲线，如果所有的点都正好落在回归线上，红线的位置应该正好与灰色虚线匹配。</li><li class="listitem">右上角的<a id="id373" class="calibre1"/>显示残差的法线。该图验证了残差呈正态分布的假设。因此，如果残差呈正态分布，它们应该正好位于灰色虚线上。</li><li class="listitem">左下角的<strong class="calibre2">刻度位置</strong>图用于测量<a id="id374" class="calibre1"/>标准化残差相对于拟合值的平方根。因此，如果所有的点都位于回归线上，则<em class="calibre8"> y </em>的值应该接近零。由于假设残差的方差基本不改变分布，如果假设正确，红线应该是相对平坦的。</li><li class="listitem">右下角的图显示了标准化残差与杠杆率的关系。杠杆是每个数据点如何影响回归的度量。它是对回归形心的距离和隔离级别的度量(通过是否有邻居来衡量)。还有，你可以找到库克距离的等高线，这个等高线受高杠杆和大残差的影响。如果删除一个点，您可以使用它来测量回归将如何变化。关于标准化残差，红线是平滑的。对于完美拟合回归，红线应该接近虚线，在库克距离中没有超过0.5的点。</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Generating a diagnostic plot of a fitted model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><a id="ch04lvl2sec140" class="calibre1"/>还有更多...</h2></div></div></div><p class="calibre7">要查看更多诊断绘图功能，您可以使用<code class="email">help</code>功能访问更多信息:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; ?plot.lm</strong>
</pre></div><p class="calibre7">为了发现是否存在库克距离大的点，可以使用<code class="email">cooks.distance</code>函数计算每个点的库克距离，并通过可视化分析距离的分布:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; plot(cooks.distance(lmfit))</strong>
</pre></div><div><img src="img/00085.jpeg" alt="There's more..." class="calibre9"/><div><p class="calibre12">库克的距离图</p></div></div><p class="calibre10"> </p><p class="calibre7">在这种<a id="id375" class="calibre1"/>情况下，索引3上的点显示出比其他点更大的库克距离，可以调查该点是否可能是异常值。</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a polynomial regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec45" class="calibre1"/>用lm拟合多项式回归模型</h1></div></div></div><p class="calibre7">一些<a id="id376" class="calibre1"/>预测变量和<a id="id377" class="calibre1"/>响应变量可能具有非线性关系，它们的关系可以建模为一个<em class="calibre8">n次</em>多项式。在这个配方中，我们介绍如何使用<code class="email">lm</code>和<code class="email">poly</code>函数处理多项式回归。</p></div></body></html>


<html>
  <head>
    <title>Fitting a polynomial regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">做好准备</h2></div></div></div><p class="calibre7">准备包含预测值和响应变量之间关系的数据集，该关系可以建模为一个<em class="calibre8">n次</em>多项式。在这个菜谱中，我们将继续使用来自<code class="email">car</code>包的<code class="email">Quartet</code>数据集。</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a polynomial regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec142" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤，用<code class="email">lm</code>拟合多项式回归模型:</p><div><ol class="orderedlist"><li class="listitem" value="1">First, we make a scatter plot of the <code class="email">x</code> and <code class="email">y2</code> variables:<div><pre class="programlisting">
<strong class="calibre2">&gt; plot(Quartet$x, Quartet$y2)</strong>
</pre></div><div><img src="img/00086.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">变量x和y2的散点图</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="2">You<a id="id379" class="calibre1"/> can apply the <code class="email">poly</code> function<a id="id380" class="calibre1"/> by specifying <code class="email">2</code> in the argument:<div><pre class="programlisting">
<strong class="calibre2">&gt; lmfit = lm(Quartet$y2~poly(Quartet$x,2))</strong>
<strong class="calibre2">&gt; lines(sort(Quartet$x), lmfit$fit[order(Quartet$x)], col = "red")</strong>
</pre></div><div><img src="img/00087.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">变量x和y2的回归图的二次拟合示例</p></div></div><p class="calibre13"> </p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Fitting a polynomial regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">它是如何工作的</h2></div></div></div><p class="calibre7">我们<a id="id381" class="calibre1"/>可以在公式<img src="img/00088.jpeg" alt="How it works" class="calibre24"/>中说明二阶<a id="id382" class="calibre1"/>多项式回归模型，其中<em class="calibre8"> α </em>是截距，而<em class="calibre8"> β </em>说明回归系数。</p><p class="calibre7">在前面的截图(步骤1)中，<code class="email">x</code>和<code class="email">y2</code>变量的散点图不符合线性关系，而是显示一条向下凹的曲线(或向上凸的曲线),转折点在x=11。为了对非线性关系建模，我们应用自变量为2的<code class="email">poly</code>函数来拟合自变量<code class="email">x</code>和因变量<code class="email">y2</code>。截图中的红线显示模型与数据完美吻合。</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a polynomial regression model with lm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">还有更多...</h2></div></div></div><p class="calibre7">您还可以拟合一个二阶多项式模型，其独立变量等于一阶<code class="email">x</code>变量和二阶<code class="email">x</code>变量的组合公式:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; plot(Quartet$x, Quartet$y2)</strong>
<strong class="calibre2">&gt; lmfit = lm(Quartet$y2~ I(Quartet$x)+I(Quartet$x^2))</strong>
</pre></div></div></div></body></html>


<html>
  <head>
    <title>Fitting a robust linear regression model with rlm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><a id="ch04lvl1sec46" class="calibre1"/>用rlm拟合稳健线性回归模型</h1></div></div></div><p class="calibre7">数据集<a id="id384" class="calibre1"/>中的<a id="id383" class="calibre1"/>异常值将使回归线远离主流。除了移除它，我们还可以应用稳健的线性回归来拟合包含异常值的数据集。在这份食谱中，我们介绍了如何应用<code class="email">rlm</code>对包含异常值的数据集执行稳健的线性回归。</p></div></body></html>


<html>
  <head>
    <title>Fitting a robust linear regression model with rlm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">做好准备</h2></div></div></div><p class="calibre7">准备包含异常值的数据集，该异常值可能会使回归线偏离主流。这里，我们使用从之前的配方加载的<code class="email">Quartet</code>数据集。</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a robust linear regression model with rlm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2"><a id="ch04lvl2sec146" class="calibre1"/>怎么做...</h2></div></div></div><p class="calibre7">执行以下步骤，用<code class="email">rlm</code>拟合稳健线性回归模型:</p><div><ol class="orderedlist"><li class="listitem" value="1">Generate a scatter plot of the <code class="email">x</code> variable against <code class="email">y3</code>:<div><pre class="programlisting">
<strong class="calibre2">&gt; plot(Quartet$x, Quartet$y3)</strong>
</pre></div><div><img src="img/00089.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">变量x和y3的散点图</p></div></div><p class="calibre13"> </p></li><li class="listitem" value="2">Next, you should import the <code class="email">MASS</code> library first. Then, you can apply the <code class="email">rlm</code> function to fit the model, and visualize the fitted line with the <code class="email">abline</code> function:<div><pre class="programlisting">
<strong class="calibre2">&gt; library(MASS)</strong>
<strong class="calibre2">&gt; lmfit = rlm(Quartet$y3~Quartet$x)</strong>
<strong class="calibre2">&gt; abline(lmfit, col="red")</strong>
</pre></div><div><img src="img/00090.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">变量x和y3的稳健线性回归</p></div></div><p class="calibre13"> </p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Fitting a robust linear regression model with rlm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">它是如何工作的</h2></div></div></div><p class="calibre7">根据前面的截图(步骤1)，您可能会遇到包含主流之外的离群值的数据集。为了消除异常值的影响，我们演示了如何应用稳健的线性<a id="id386" class="calibre1"/>回归(<code class="email">rlm</code>)来拟合数据。在第二个屏幕截图(步骤2)中，稳健回归线忽略了异常值，与主流相匹配。</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a robust linear regression model with rlm</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">还有更多...</h2></div></div></div><p class="calibre7">要查看异常值如何使回归线远离主流的影响，您可以将本配方中使用的<code class="email">rlm</code>函数替换为<code class="email">lm</code>，并重新绘制图表:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; plot(Quartet$x, Quartet$y3)</strong>
<strong class="calibre2">&gt; lmfit = lm(Quartet$y3~Quartet$x)</strong>
<strong class="calibre2">&gt; abline(lmfit, col="red")</strong>
</pre></div><div><img src="img/00091.jpeg" alt="There's more..." class="calibre9"/><div><p class="calibre12">变量x和y3的线性回归</p></div></div><p class="calibre10">很明显，离群值(x=13)使回归线远离主流。</p><p class="calibre7"><a id="ch04lvl1sec47" class="calibre1"/>研究滑动数据的线性回归案例</p></div></div></body></html>


<html>
  <head>
    <title>Studying a case of linear regression on SLID data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">为了<a id="id389" class="calibre1"/>总结上一节的内容，我们<a id="id390" class="calibre1"/>用线性回归探索更复杂的数据。在本食谱中，我们演示了如何应用线性回归来分析<strong class="calibre2">劳动力和收入动态调查</strong> ( <strong class="calibre2">滑动</strong>)数据集。</h1></div></div></div><p class="calibre7">准备就绪</p></div></body></html>


<html>
  <head>
    <title>Studying a case of linear regression on SLID data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">检查是否安装并加载了<code class="email">car</code>库，因为需要它来访问滑动的数据集。</h2></div></div></div><p class="calibre7"><a id="ch04lvl2sec150" class="calibre1"/>怎么做...</p></div></div></body></html>


<html>
  <head>
    <title>Studying a case of linear regression on SLID data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">按照以下步骤对滑动数据执行线性回归:</h2></div></div></div><p class="calibre7">您可以使用<code class="email">str</code>功能来获得数据的概览:<div> <pre class="programlisting"> <strong class="calibre2">&gt; str(SLID)</strong> <strong class="calibre2">'data.frame':  7425 obs. of  5 variables:</strong> <strong class="calibre2"> $ wages    : num  10.6 11 NA 17.8 NA ...</strong> <strong class="calibre2"> $ education: num  15 13.2 16 14 8 16 12 14.5 15 10 ...</strong> <strong class="calibre2"> $ age      : int  40 19 49 46 71 50 70 42 31 56 ...</strong> <strong class="calibre2"> $ sex      : Factor w/ 2 levels "Female","Male": 2 2 2 2 2 1 1 1 2 1 ...</strong> <strong class="calibre2"> $ language : Factor w/ 3 levels "English","French",..: 1 1 3 3 1 1 1 1 1 1 ..</strong> </pre> </div></p><div><ol class="orderedlist"><li class="listitem" value="1">多个组合的工资图</li><li class="listitem" value="2">First, we<a id="id391" class="calibre1"/> visualize the variable wages against language, age, education, and sex:<div><pre class="programlisting">
<strong class="calibre2">&gt; par(mfrow=c(2,2))</strong>
<strong class="calibre2">&gt; plot(SLID$wages ~ SLID$language)</strong>
<strong class="calibre2">&gt; plot(SLID$wages ~ SLID$age)</strong>
<strong class="calibre2">&gt; plot(SLID$wages ~ SLID$education)</strong>
<strong class="calibre2">&gt; plot(SLID$wages ~ SLID$sex)</strong>
</pre></div><div><img src="img/00092.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">Plot of wages against multiple combinations</p></div></div><p class="calibre13">然后，我们可以用<code class="email">lm</code>来拟合模型:<div> <pre class="programlisting"> <strong class="calibre2">&gt; lmfit = lm(wages ~ ., data = SLID)</strong> </pre> </div></p></li><li class="listitem" value="3">您可以通过<code class="email">summary</code>功能查看拟合模型的汇总:<div> <pre class="programlisting"> <strong class="calibre2">&gt; summary(lmfit)</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">lm(formula = wages ~ ., data = SLID)</strong>  <strong class="calibre2">Residuals:</strong> <strong class="calibre2">    Min      1Q  Median      3Q     Max </strong> <strong class="calibre2">-26.062  -4.347  -0.797   3.237  35.908 </strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">                Estimate Std. Error t value Pr(&gt;|t|)    </strong> <strong class="calibre2">(Intercept)    -7.888779   0.612263 -12.885   &lt;2e-16 ***</strong> <strong class="calibre2">education       0.916614   0.034762  26.368   &lt;2e-16 ***</strong> <strong class="calibre2">age             0.255137   0.008714  29.278   &lt;2e-16 ***</strong> <strong class="calibre2">sexMale         3.455411   0.209195  16.518   &lt;2e-16 ***</strong> <strong class="calibre2">languageFrench -0.015223   0.426732  -0.036    0.972    </strong> <strong class="calibre2">languageOther   0.142605   0.325058   0.439    0.661    </strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">Residual standard error: 6.6 on 3981 degrees of freedom</strong> <strong class="calibre2">  (3438 observations deleted due to missingness)</strong> <strong class="calibre2">Multiple R-squared:  0.2973,	Adjusted R-squared:  0.2964 </strong> <strong class="calibre2">F-statistic: 336.8 on 5 and 3981 DF,  p-value: &lt; 2.2e-16</strong> </pre> </div></li><li class="listitem" value="4">去掉<code class="email">language</code>属性<a id="id392" class="calibre1"/>，用<code class="email">lm</code>功能改装模型:<div> <pre class="programlisting"> <strong class="calibre2">&gt; lmfit = lm(wages ~ age + sex + education, data = SLID)</strong> <strong class="calibre2">&gt; summary(lmfit)</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">lm(formula = wages ~ age + sex + education, data = SLID)</strong>  <strong class="calibre2">Residuals:</strong> <strong class="calibre2">    Min      1Q  Median      3Q     Max </strong> <strong class="calibre2">-26.111  -4.328  -0.792   3.243  35.892 </strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">             Estimate Std. Error t value Pr(&gt;|t|)    </strong> <strong class="calibre2">(Intercept) -7.905243   0.607771  -13.01   &lt;2e-16 ***</strong> <strong class="calibre2">age          0.255101   0.008634   29.55   &lt;2e-16 ***</strong> <strong class="calibre2">sexMale      3.465251   0.208494   16.62   &lt;2e-16 ***</strong> <strong class="calibre2">education    0.918735   0.034514   26.62   &lt;2e-16 ***</strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">Residual standard error: 6.602 on 4010 degrees of freedom</strong> <strong class="calibre2">  (3411 observations deleted due to missingness)</strong> <strong class="calibre2">Multiple R-squared:  0.2972,	Adjusted R-squared:  0.2967 </strong> <strong class="calibre2">F-statistic: 565.3 on 3 and 4010 DF,  p-value: &lt; 2.2e-16</strong> </pre> </div></li><li class="listitem" value="5">拟合模型的诊断图</li><li class="listitem" value="6">We <a id="id393" class="calibre1"/>can then draw a diagnostic plot of <code class="email">lmfit</code>:<div><pre class="programlisting">
<strong class="calibre2">&gt; par(mfrow=c(2,2))</strong>
<strong class="calibre2">&gt; plot(lmfit)</strong>
</pre></div><div><img src="img/00093.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">Diagnostic plot of fitted model</p></div></div><p class="calibre13">调整拟合模型的诊断图</p></li><li class="listitem" value="7">Next, we<a id="id394" class="calibre1"/> take the log of wages and replot the diagnostic plot:<div><pre class="programlisting">
<strong class="calibre2">&gt; lmfit = lm(log(wages) ~ age + sex + education, data = SLID)</strong>
<strong class="calibre2">&gt; plot(lmfit)</strong>
</pre></div><div><img src="img/00094.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">Diagnostic plot of adjusted fitted model</p></div></div><p class="calibre13">接下来，您可以使用<code class="email">vif</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; vif(lmfit)</strong> <strong class="calibre2">      age       sex education </strong> <strong class="calibre2"> 1.011613  1.000834  1.012179 </strong> <strong class="calibre2">&gt; sqrt(vif(lmfit)) &gt; 2</strong> <strong class="calibre2">      age       sex education </strong> <strong class="calibre2">    FALSE     FALSE     FALSE</strong> </pre> </div>来诊断回归模型的多重共线性</p></li><li class="listitem" value="8">然后你<a id="id395" class="calibre1"/>可以安装加载<code class="email">lmtest</code>包，用<code class="email">bptest</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; install.packages("lmtest")</strong> <strong class="calibre2">&gt; library(lmtest)</strong> <strong class="calibre2">&gt; bptest(lmfit)</strong>  <strong class="calibre2">  studentized Breusch-Pagan test</strong>  <strong class="calibre2">data:  lmfit</strong> <strong class="calibre2">BP = 29.0311, df = 3, p-value = 2.206e-06</strong> </pre> </div>诊断回归模型的异方差性</li><li class="listitem" value="9">最后，您可以安装并加载<code class="email">rms</code>包。然后，可以用<code class="email">robcov</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; install.packages("rms")</strong> <strong class="calibre2">&gt; library(rms)</strong> <strong class="calibre2">&gt; olsfit = ols(log(wages) ~ age + sex + education, data= SLID, x= TRUE, y= TRUE)</strong> <strong class="calibre2">&gt; robcov(olsfit)</strong>  <strong class="calibre2">Linear Regression Model</strong>  <strong class="calibre2">ols(formula = log(wages) ~ age + sex + education, data = SLID, </strong> <strong class="calibre2">    x = TRUE, y = TRUE)</strong>  <strong class="calibre2">Frequencies of Missing Values Due to Each Variable</strong> <strong class="calibre2">log(wages)        age        sex  education </strong> <strong class="calibre2">      3278          0          0        249 </strong>   <strong class="calibre2">                Model Likelihood     Discrimination    </strong> <strong class="calibre2">                   Ratio Test           Indexes        </strong> <strong class="calibre2">Obs     4014    LR chi2   1486.08    R2       0.309    </strong> <strong class="calibre2">sigma 0.4187    d.f.            3    R2 adj   0.309    </strong> <strong class="calibre2">d.f.    4010    Pr(&gt; chi2) 0.0000    g        0.315    </strong>  <strong class="calibre2">Residuals</strong>  <strong class="calibre2">     Min       1Q   Median       3Q      Max </strong> <strong class="calibre2">-2.36252 -0.27716  0.01428  0.28625  1.56588 </strong>  <strong class="calibre2">          Coef   S.E.   t     Pr(&gt;|t|)</strong> <strong class="calibre2">Intercept 1.1169 0.0387 28.90 &lt;0.0001 </strong> <strong class="calibre2">age       0.0176 0.0006 30.15 &lt;0.0001 </strong> <strong class="calibre2">sex=Male  0.2244 0.0132 16.96 &lt;0.0001 </strong> <strong class="calibre2">education 0.0552 0.0022 24.82 &lt;0.0001</strong> </pre> </div>修正标准误差</li><li class="listitem" value="10"><a id="ch04lvl2sec151" class="calibre1"/>工作原理...</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Studying a case of linear regression on SLID data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">这个<a id="id396" class="calibre1"/>配方演示了如何对SLID数据集进行线性回归分析。首先，我们通过使用<code class="email">str</code>函数加载滑动数据并显示其结构。从数据的结构中，我们知道有四个自变量会影响因变量的工资。</h2></div></div></div><p class="calibre7">接下来，我们通过可视化探索每个自变量与因变量<code class="email">wages</code>的关系；可视化结果显示在前面的屏幕截图中(步骤2)。在这张截图的左上方，可以找到三种不同语言对工资的方框图；语言和工资之间的相关性并不明显。截图的右上部分显示年龄似乎与因变量<code class="email">wages</code>成正相关。在截图的左下方，显示了教育似乎也与工资呈正相关。最后，截图右下部分的方框图显示，男性的工资略高于女性。</p><p class="calibre7">接下来，我们将除了<code class="email">wages</code>之外的所有属性作为预测变量拟合到模型中。通过总结该模型，表明教育、年龄和性别表现出显著性(<em class="calibre8"> p值&lt; 0.05 </em>)。因此，我们删除了无关紧要的<code class="email">language</code>属性(其p值大于0.05)，并根据线性模型中的因变量(<code class="email">wages</code>)拟合了三个自变量(教育、性别和年龄)。这相应地将f统计值从336.8提高到565.3。</p><p class="calibre7">接下来，我们生成拟合模型的诊断图。在诊断图中，所有四个图都表明回归模型遵循回归假设。然而，从残差与拟合值和比例位置图来看，较小拟合值的残差偏向回归模型。由于工资的范围跨越几个数量级，为了引起对称性，我们对工资进行了对数变换，并将数据重新调整为回归模型。残差与拟合值图的红线和比例位置图现在更靠近灰色虚线。</p><p class="calibre7">接下来，我们<a id="id397" class="calibre1"/>想要测试模型中是否存在多重共线性。当一个预测因子与其他预测因子高度相关时，就会出现多重共线性。如果模型中存在多重共线性，您可能会看到一些变量具有较高的R平方值，但显示为无关紧要的变量。为了检测多重共线性，我们可以使用<code class="email">vif</code>函数计算线性和广义线性模型的方差膨胀和广义方差膨胀因子。如果存在多重共线性，我们应该找到方差膨胀因子的平方根大于2的预测因子。然后，我们可以移除多余的预测因子，或者使用主成分分析将预测因子转换为一个较小的不相关成分集。</p><p class="calibre7">最后，我们要<a id="id398" class="calibre1"/>检验<strong class="calibre2">异方差</strong>是否存在于模型中。在讨论异方差的定义之前，我们首先要知道，在经典的假设中，普通的回归模型假设误差的方差是恒定的或者跨观测值是齐次的。相反，异方差意味着不同观测值之间的方差不相等。因此，异方差可能偏向于我们估计的标准误差，从而误导假设的检验。为了检测和测试异方差性，我们<a id="id399" class="calibre1"/>可以使用<code class="email">lmtest</code>包中的<code class="email">bptest</code>函数执行<strong class="calibre2"> Breusch-Pagan </strong>异方差性测试。在这种情况下，p值显示为2.206e-06 ( &lt; 0.5)，拒绝了同异方差(无异方差)的零假设。这里，它意味着参数估计的标准误差是不正确的。但是，我们可以使用稳健的标准误差来校正标准误差(不要移除异方差)，并使用<code class="email">rms</code>包中的<code class="email">robcov</code>来增加真正重要参数的重要性。然而，由于它只接受来自<code class="email">rms</code>系列的拟合模型作为输入，我们必须事先拟合普通的最小二乘模型。</p><p class="calibre7"><a id="ch04lvl2sec152" class="calibre1"/>亦见</p></div></div></body></html>


<html>
  <head>
    <title>Studying a case of linear regression on SLID data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">有关SLID数据集的更多信息，您可以使用<code class="email">help</code>功能查看相关文档:<div> <pre class="programlisting"> <strong class="calibre2">&gt;  ?SLID</strong> </pre> </div></h2></div></div></div><div><ul class="itemizedlist"><li class="listitem"><a id="ch04lvl1sec48" class="calibre1"/>应用高斯模型进行广义线性回归</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Applying the Gaussian model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><strong class="calibre2">广义线性模型</strong> ( <strong class="calibre2"> GLM </strong>)是<a id="id400" class="calibre1"/>线性回归的一种推广，它可以包含一个链接函数来<a id="id401" class="calibre1"/>进行线性预测。作为默认设置，<code class="email">glm</code>的族对象是高斯，这使得<code class="email">glm</code>功能与<code class="email">lm</code>完全相同地执行<a id="id402" class="calibre1"/>。在这个配方中，我们首先演示如何使用<code class="email">glm</code>函数将模型拟合到数据中，然后展示使用高斯模型的<code class="email">glm</code>与<code class="email">lm</code>的性能完全相同。</h1></div></div></div><p class="calibre7"><a id="ch04lvl2sec153" class="calibre1"/>准备就绪</p></div></body></html>


<html>
  <head>
    <title>Applying the Gaussian model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">检查<a id="id403" class="calibre1"/>是否安装并加载了<code class="email">car</code>库，因为我们需要该包中的SLID数据集。</h2></div></div></div><p class="calibre7"><a id="ch04lvl2sec154" class="calibre1"/>怎么做...</p></div></div></body></html>


<html>
  <head>
    <title>Applying the Gaussian model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">执行以下步骤，用高斯模型拟合广义线性回归模型:</h2></div></div></div><p class="calibre7">将自变量<code class="email">age</code>、<code class="email">sex</code>、<code class="email">education</code>，因变量工资拟合为<code class="email">glm</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; lmfit1 = glm(wages ~ age + sex + education, data = SLID, family=gaussian)</strong> <strong class="calibre2">&gt; summary(lmfit1)</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">glm(formula = wages ~ age + sex + education, family = gaussian, </strong> <strong class="calibre2">    data = SLID)</strong>  <strong class="calibre2">Deviance Residuals: </strong> <strong class="calibre2">    Min       1Q   Median       3Q      Max  </strong> <strong class="calibre2">-26.111   -4.328   -0.792    3.243   35.892  </strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">             Estimate Std. Error t value Pr(&gt;|t|)    </strong> <strong class="calibre2">(Intercept) -7.905243   0.607771  -13.01   &lt;2e-16 ***</strong> <strong class="calibre2">age          0.255101   0.008634   29.55   &lt;2e-16 ***</strong> <strong class="calibre2">sexMale      3.465251   0.208494   16.62   &lt;2e-16 ***</strong> <strong class="calibre2">education    0.918735   0.034514   26.62   &lt;2e-16 ***</strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">(Dispersion parameter for Gaussian family taken to be 43.58492)</strong>  <strong class="calibre2">    Null deviance: 248686  on 4013  degrees of freedom</strong> <strong class="calibre2">Residual deviance: 174776  on 4010  degrees of freedom</strong> <strong class="calibre2">  (3411 observations deleted due to missingness)</strong> <strong class="calibre2">AIC: 26549</strong>  <strong class="calibre2">Number of Fisher Scoring iterations: 2</strong> </pre> </div></p><div><ol class="orderedlist"><li class="listitem" value="1">将<a id="id404" class="calibre1"/>自变量、<code class="email">age</code>、<code class="email">sex</code>、<code class="email">education</code>，因变量工资拟合为<code class="email">lm</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; lmfit2 = lm(wages ~ age + sex + education, data = SLID)</strong> <strong class="calibre2">&gt; summary(lmfit2)</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">lm(formula = wages ~ age + sex + education, data = SLID)</strong>  <strong class="calibre2">Residuals:</strong> <strong class="calibre2">    Min      1Q  Median      3Q     Max </strong> <strong class="calibre2">-26.111  -4.328  -0.792   3.243  35.892 </strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">             Estimate Std. Error t value Pr(&gt;|t|)    </strong> <strong class="calibre2">(Intercept) -7.905243   0.607771  -13.01   &lt;2e-16 ***</strong> <strong class="calibre2">age          0.255101   0.008634   29.55   &lt;2e-16 ***</strong> <strong class="calibre2">sexMale      3.465251   0.208494   16.62   &lt;2e-16 ***</strong> <strong class="calibre2">education    0.918735   0.034514   26.62   &lt;2e-16 ***</strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">Residual standard error: 6.602 on 4010 degrees of freedom</strong> <strong class="calibre2">  (3411 observations deleted due to missingness)</strong> <strong class="calibre2">Multiple R-squared:  0.2972,	Adjusted R-squared:  0.2967 </strong> <strong class="calibre2">F-statistic: 565.3 on 3 and 4010 DF,  p-value: &lt; 2.2e-16</strong> </pre> </div></li><li class="listitem" value="2">使用<code class="email">anova</code>比较两个拟合模型:<div> <pre class="programlisting"> <strong class="calibre2">&gt; anova(lmfit1, lmfit2)</strong> <strong class="calibre2">Analysis of Deviance Table</strong>  <strong class="calibre2">Model: gaussian, link: identity</strong>  <strong class="calibre2">Response: wages</strong>  <strong class="calibre2">Terms added sequentially (first to last)</strong>   <strong class="calibre2">          Df Deviance Resid. Df Resid. Dev</strong> <strong class="calibre2">NULL                       4013     248686</strong> <strong class="calibre2">age        1    31953      4012     216733</strong> <strong class="calibre2">sex        1    11074      4011     205659</strong> <strong class="calibre2">education  1    30883      4010     174776</strong> </pre> </div></li><li class="listitem" value="3"><a id="ch04lvl2sec155" class="calibre1"/>工作原理...</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Applying the Gaussian model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><code class="email">glm</code>函数以类似于<code class="email">lm</code>函数的方式将模型拟合到数据中。唯一的区别是<a id="id405" class="calibre1"/>你可以在参数<code class="email">family</code>中指定不同的链接函数(你可以在控制台中使用<code class="email">?family</code>来查找不同类型的链接函数)。在这个配方中，我们首先将自变量<code class="email">age</code>、<code class="email">sex</code>和<code class="email">education</code>以及因变量<code class="email">wages</code>输入到<code class="email">glm</code>函数中，并将构建的模型分配给<code class="email">lmfit1</code>。您可以使用构建的模型进行进一步预测。</h2></div></div></div><p class="calibre7">接下来，为了确定具有高斯模型的<code class="email">glm</code>是否与<code class="email">lm</code>完全相同，我们将自变量<code class="email">age</code>、<code class="email">sex</code>和<code class="email">education</code>以及因变量<code class="email">wages</code>拟合到<code class="email">lm</code>模型。通过将<code class="email">summary</code>函数应用于两个不同的模型，揭示了两个输出汇总的残差和系数完全相同。</p><p class="calibre7">最后，我们用<code class="email">anova</code>函数<a id="id406" class="calibre1"/>进一步比较两个拟合模型。<code class="email">anova</code>函数的结果显示两个<a id="id407" class="calibre1"/>模型相似，具有相同的<strong class="calibre2">剩余自由度</strong> ( <strong class="calibre2"> Res.DF </strong>)和<strong class="calibre2">剩余平方和</strong> ( <strong class="calibre2"> RSS Df </strong>)。</p><p class="calibre7"><a id="ch04lvl2sec156" class="calibre1"/>参见</p></div></div></body></html>


<html>
  <head>
    <title>Applying the Gaussian model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">关于广义线性模型与线性模型的比较，可以参考<em class="calibre8">维纳布尔斯，W. N .，&amp;里普利，B. D. (2002)。现代应用统计学与S. Springer </em>。</h2></div></div></div><div><ul class="itemizedlist"><li class="listitem"><a id="ch04lvl1sec49" class="calibre1"/>应用泊松模型进行广义线性回归</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Applying the Poisson model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">广义线性模型允许响应变量具有不同于<a id="id408" class="calibre1"/>正态分布(高斯)的误差分布模型。在本食谱中，我们<a id="id409" class="calibre1"/>展示了如何在<code class="email">glm</code>中将泊松作为系列对象应用于计数数据。</h1></div></div></div><p class="calibre7">准备就绪</p></div></body></html>


<html>
  <head>
    <title>Applying the Poisson model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">此任务的先决条件是准备计数数据，所有输入数据值都是整数。</h2></div></div></div><p class="calibre7"><a id="ch04lvl2sec158" class="calibre1"/>怎么做...</p></div></div></body></html>


<html>
  <head>
    <title>Applying the Poisson model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">执行以下步骤，用泊松模型拟合广义线性回归模型:</h2></div></div></div><p class="calibre7">加载<code class="email">warpbreaks</code>数据，使用<code class="email">head</code>查看前几行:<div> <pre class="programlisting"> <strong class="calibre2">&gt; data(warpbreaks)</strong> <strong class="calibre2">&gt; head(warpbreaks)</strong> <strong class="calibre2">  breaks wool tension</strong> <strong class="calibre2">1     26    A       L</strong> <strong class="calibre2">2     30    A       L</strong> <strong class="calibre2">3     54    A       L</strong> <strong class="calibre2">4     25    A       L</strong> <strong class="calibre2">5     70    A       L</strong> <strong class="calibre2">6     52    A       L</strong> </pre> </div></p><div><ol class="orderedlist"><li class="listitem" value="1">我们将泊松应用为自变量<code class="email">tension</code>和因变量<code class="email">breaks</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; rs1 = glm(breaks ~ tension, data=warpbreaks, family="poisson")</strong> <strong class="calibre2">&gt; summary(rs1)</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">glm(formula = breaks ~ tension, family = "poisson", data = warpbreaks)</strong>  <strong class="calibre2">Deviance Residuals: </strong> <strong class="calibre2">    Min       1Q   Median       3Q      Max  </strong> <strong class="calibre2">-4.2464  -1.6031  -0.5872   1.2813   4.9366  </strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">            Estimate Std. Error z value Pr(&gt;|z|)    </strong> <strong class="calibre2">(Intercept)  3.59426    0.03907  91.988  &lt; 2e-16 ***</strong> <strong class="calibre2">tensionM    -0.32132    0.06027  -5.332 9.73e-08 ***</strong> <strong class="calibre2">tensionH    -0.51849    0.06396  -8.107 5.21e-16 ***</strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">(Dispersion parameter for Poisson family taken to be 1)</strong>  <strong class="calibre2">    Null deviance: 297.37  on 53  degrees of freedom</strong> <strong class="calibre2">Residual deviance: 226.43  on 51  degrees of freedom</strong> <strong class="calibre2">AIC: 507.09</strong>  <strong class="calibre2">Number of Fisher Scoring iterations: 4</strong> </pre> </div>的族对象</li><li class="listitem" value="2"><a id="ch04lvl2sec159" class="calibre1"/>工作原理...</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Applying the Poisson model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">在泊松分布的<a id="id410" class="calibre1"/>假设下，计数<a id="id411" class="calibre1"/>数据可以符合对数线性模型。在这个配方中，我们首先从<code class="email">warpbreaks</code>数据集中加载一个样本计数数据，它包含关于每台织机经纱断头数的数据。接下来，我们应用了<code class="email">glm</code>函数，将breaks作为因变量，<code class="email">tension</code>作为自变量，Poisson作为族对象。最后，我们用总结函数来观察拟合的对数线性模型。</h2></div></div></div><p class="calibre7"><a id="ch04lvl2sec160" class="calibre1"/>参见</p></div></div></body></html>


<html>
  <head>
    <title>Applying the Poisson model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">要了解泊松模型如何与计数数据相关的更多信息，您可以参考<em class="calibre8"> Cameron，A. C .，&amp; Trivedi，P. K. (2013)。计数数据的回归分析(第53期)。剑桥大学出版社。</em></h2></div></div></div><div><ul class="itemizedlist"><li class="listitem"><a id="ch04lvl1sec50" class="calibre1"/>应用二项式模型进行广义线性回归</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Applying the Binomial model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">对于二元<a id="id412" class="calibre1"/>因变量，可以应用<a id="id413" class="calibre1"/>二项式模型作为<code class="email">glm</code>函数中的族对象。</h1></div></div></div><p class="calibre7">准备就绪</p></div></body></html>


<html>
  <head>
    <title>Applying the Binomial model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">这项任务的先决条件是准备一个二元因变量。这里我们用<code class="email">vs</code>变量(V型发动机或直列发动机)作为因变量。</h2></div></div></div><p class="calibre7"><a id="ch04lvl2sec162" class="calibre1"/>怎么做...</p></div></div></body></html>


<html>
  <head>
    <title>Applying the Binomial model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">执行以下步骤，用二项式模型拟合广义线性回归模型:</h2></div></div></div><p class="calibre7">首先，我们考察<code class="email">mtcars</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; head(mtcars$vs)</strong> <strong class="calibre2">[1] 0 0 1 1 0 1</strong> </pre> </div>内<code class="email">vs</code>的前六个要素</p><div><ol class="orderedlist"><li class="listitem" value="1">我们使用<code class="email">binomial</code>作为家庭对象来应用<code class="email">glm</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; lm1 = glm(vs ~ hp+mpg+gear,data=mtcars, family=binomial)</strong> <strong class="calibre2">&gt; summary(lm1)</strong>  <strong class="calibre2">Call:</strong> <strong class="calibre2">glm(formula = vs ~ hp + mpg + gear, family = binomial, data = mtcars)</strong>  <strong class="calibre2">Deviance Residuals: </strong> <strong class="calibre2">     Min        1Q    Median        3Q       Max  </strong> <strong class="calibre2">-1.68166  -0.23743  -0.00945   0.30884   1.55688  </strong>  <strong class="calibre2">Coefficients:</strong> <strong class="calibre2">            Estimate Std. Error z value Pr(&gt;|z|)  </strong> <strong class="calibre2">(Intercept) 11.95183    8.00322   1.493   0.1353  </strong> <strong class="calibre2">hp          -0.07322    0.03440  -2.129   0.0333 *</strong> <strong class="calibre2">mpg          0.16051    0.27538   0.583   0.5600  </strong> <strong class="calibre2">gear        -1.66526    1.76407  -0.944   0.3452  </strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">(Dispersion parameter for binomial family taken to be 1)</strong>  <strong class="calibre2">    Null deviance: 43.860  on 31  degrees of freedom</strong> <strong class="calibre2">Residual deviance: 15.651  on 28  degrees of freedom</strong> <strong class="calibre2">AIC: 23.651</strong>  <strong class="calibre2">Number of Fisher Scoring iterations: 7</strong> </pre> </div></li><li class="listitem" value="2">它是如何工作的...</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Applying the Binomial model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">在<a id="id414" class="calibre1"/>二进制数据中，<a id="id415" class="calibre1"/>响应值的每个观察值被编码为<code class="email">0</code>或<code class="email">1</code>。拟合二元数据的回归模型需要二项式分布函数。在这个例子中，我们首先从<code class="email">mtcars</code>数据集中加载二元因变量<code class="email">vs</code>。<code class="email">vs</code>适合二项式模型，因为它包含二进制数据。接下来，我们通过将<code class="email">binomial</code>指定为family对象，使用<code class="email">glm</code>函数将模型拟合到二进制数据中。最后，通过参考概要，我们可以获得拟合模型的描述。</h2></div></div></div><p class="calibre7"><a id="ch04lvl2sec164" class="calibre1"/>参见</p></div></div></body></html>


<html>
  <head>
    <title>Applying the Binomial model for generalized linear regression</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">如果仅在参数中指定族对象，将使用默认链接来拟合模型。但是，要使用替代的link函数，可以添加link参数。例如:<div> <pre class="programlisting"> <strong class="calibre2">&gt; lm1 = glm(vs ~ hp+mpg+gear,data=mtcars, family=binomial(link="probit"))</strong> </pre> </div></h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">如果您想知道您可以使用多少个替代链接，请通过帮助功能参考系列文档:<div> <pre class="programlisting"> <strong class="calibre2"> &gt; ?family</strong> </pre> </div></li><li class="listitem"><a id="ch04lvl1sec51" class="calibre1"/>对数据拟合广义可加模型</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Fitting a generalized additive model to data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0"><strong class="calibre2">广义可加模型</strong> ( <strong class="calibre2"> GAM </strong>)，用于拟合广义可加模型，可以<a id="id416" class="calibre1"/>看作是GLM的半参数推广。GLM假设因变量和自变量之间存在线性关系，而GAM则根据数据的局部行为来拟合模型。因此，GAM有能力处理因变量和自变量之间的高度非线性关系。在下面的食谱中，我们将介绍如何使用广义加法模型来拟合回归。</h1></div></div></div><p class="calibre7">做好准备</p></div></body></html>


<html>
  <head>
    <title>Fitting a generalized additive model to data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">我们需要准备一个包含变量的数据框架，其中一个变量是响应变量，其他变量可能是预测变量。</h2></div></div></div><p class="calibre7">如何做到这一点...</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a generalized additive model to data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">执行以下步骤将广义加性模型拟合到数据中:</h2></div></div></div><p class="calibre7">首先加载<code class="email">mgcv</code>包，里面包含<code class="email">gam</code>函数:<div> <pre class="programlisting"> <strong class="calibre2">&gt; install.packages("mgcv")</strong> <strong class="calibre2">&gt; library(mgcv)</strong> </pre> </div></p><div><ol class="orderedlist"><li class="listitem" value="1">然后，安装<code class="email">MASS</code>包，加载<code class="email">Boston</code>数据集:<div> <pre class="programlisting"> <strong class="calibre2">&gt; install.packages("MASS")</strong> <strong class="calibre2">&gt; library(MASS)</strong> <strong class="calibre2">&gt; attach(Boston)</strong> <strong class="calibre2">&gt; str(Boston)</strong> </pre> </div></li><li class="listitem" value="2">使用<code class="email">gam</code> : <div> <pre class="programlisting"> <strong class="calibre2">&gt; fit = gam(dis ~ s(nox))</strong> </pre> </div>拟合回归</li><li class="listitem" value="3">获取拟合模型的汇总信息:<div> <pre class="programlisting"> <strong class="calibre2">&gt; summary(fit)</strong> <strong class="calibre2">Family: gaussian </strong> <strong class="calibre2">Link function: identity </strong>  <strong class="calibre2">Formula:</strong> <strong class="calibre2">dis ~ s(nox)</strong>  <strong class="calibre2">Parametric coefficients:</strong> <strong class="calibre2">            Estimate Std. Error t value Pr(&gt;|t|)    </strong> <strong class="calibre2">(Intercept)  3.79504    0.04507   84.21   &lt;2e-16 ***</strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">Approximate significance of smooth terms:</strong> <strong class="calibre2">         edf Ref.df   F p-value    </strong> <strong class="calibre2">s(nox) 8.434  8.893 189  &lt;2e-16 ***</strong> <strong class="calibre2">---</strong> <strong class="calibre2">Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</strong>  <strong class="calibre2">R-sq.(adj) =  0.768   Deviance explained = 77.2%</strong> <strong class="calibre2">GCV = 1.0472  Scale est. = 1.0277    n = 506</strong> </pre> </div></li><li class="listitem" value="4"><a id="ch04lvl2sec167" class="calibre1"/>工作原理</li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Fitting a generalized additive model to data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">GAM<a id="id419" class="calibre1"/>旨在通过估计预测器的非参数函数来最大化来自各种分布的因变量<code class="email">y</code>的预测，预测器通过链接函数链接到因变量。GAM的概念是<img src="img/00095.jpeg" alt="How it works" class="calibre24"/>，其中为<em class="calibre8"> y </em>指定了一个指数族<em class="calibre8"> E </em>，以及<code class="email">g</code>链接函数；<code class="email">f</code>表示预测值的链接函数。</h2></div></div></div><p class="calibre7"><code class="email">gam</code>函数包含在<code class="email">mgcv</code>包中，所以，首先安装这个包，并将其加载到R会话中。接下来，从<code class="email">MASS</code>包中加载波士顿数据集(<em class="calibre8">波士顿</em>郊区的房价)。从数据集中，我们使用<code class="email">dis</code>(到五个波士顿就业中心的距离的加权平均值)作为因变量，<code class="email">nox</code>(氮氧化物浓度)作为自变量，然后将它们输入到<code class="email">gam</code>函数中，以生成拟合模型。</p><p class="calibre7">与<code class="email">glm</code>类似，<code class="email">gam</code>允许用户总结<code class="email">gam</code>的适合度。从概要中，可以找到参数参数、平滑项的重要性以及其他有用的信息。</p><p class="calibre7"><a id="ch04lvl2sec168" class="calibre1"/>亦见</p></div></div></body></html>


<html>
  <head>
    <title>Fitting a generalized additive model to data</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">除了<code class="email">gam</code>之外，<code class="email">mgcv</code>包为大型数据集提供了另一个通用的附加模型<code class="email">bam</code>。<a id="id420" class="calibre1"/> <code class="email">bam</code>包与<code class="email">gam</code>非常相似，但使用的内存更少，效率相对更高。请使用<code class="email">help</code>功能了解该型号的更多信息:<div> <pre class="programlisting"> <strong class="calibre2"> &gt; ? bam</strong> </pre> </div></h2></div></div></div><div><ul class="itemizedlist"><li class="listitem">有关R中广义加性模型的更多信息，请参考<em class="calibre8"> Wood，S. (2006)。广义可加模型:与R. CRC出版社的介绍</em>。</li><li class="listitem"><a id="ch04lvl1sec52" class="calibre1"/>可视化广义加法模型</li></ul></div></div></div></body></html>


<html>
  <head>
    <title>Visualizing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">在本食谱中，我们演示了如何将<code class="email">gam</code>拟合回归线添加到散点图中。此外，我们使用<code class="email">plot</code>函数<a id="id421" class="calibre1"/>可视化gam拟合。</h1></div></div></div><p class="calibre7">准备就绪</p></div></body></html>


<html>
  <head>
    <title>Visualizing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">通过给<code class="email">fit</code>变量分配一个<code class="email">gam</code>适合的模型来完成之前的配方。</h2></div></div></div><p class="calibre7"><a id="ch04lvl2sec170" class="calibre1"/>怎么做...</p></div></div></body></html>


<html>
  <head>
    <title>Visualizing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">执行以下步骤来可视化广义加法模型:</h2></div></div></div><p class="calibre7">可变nox与dis的散点图</p><div><ol class="orderedlist"><li class="listitem" value="1">Generate a scatter plot using the <code class="email">nox</code> and <code class="email">dis</code> variables:<div><pre class="programlisting">
<strong class="calibre2">&gt; plot(nox, dis)</strong>
</pre></div><div><img src="img/00096.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">Scatter plot of variable nox against dis</p></div></div><p class="calibre13">散点图上gam的拟合回归</p></li><li class="listitem" value="2">Add the regression to the scatter plot:<div><pre class="programlisting">
<strong class="calibre2">&gt; x = seq(0, 1, length = 500)</strong>
<strong class="calibre2">&gt; y = predict(fit, data.frame(nox = x))</strong>
<strong class="calibre2">&gt; lines(x, y, col = "red", lwd = 2)</strong>
</pre></div><div><img src="img/00097.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">Fitted regression of gam on a scatter plot</p></div></div><p class="calibre13">拟合gam图</p></li><li class="listitem" value="3">Alternatively, you <a id="id422" class="calibre1"/>can plot the fitted model using the <code class="email">plot</code> function:<div><pre class="programlisting">
<strong class="calibre2">&gt; plot(fit)</strong>
</pre></div><div><img src="img/00098.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">Plot of fitted gam</p></div></div><p class="calibre13"><a id="ch04lvl2sec171" class="calibre1"/>工作原理...</p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Visualizing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3">为了<a id="id423" class="calibre1"/>可视化拟合回归，我们首先使用<code class="email">dis</code>和<code class="email">nox</code>变量生成一个散点图。然后，我们生成<em class="calibre8">x</em>-轴的序列，并通过使用拟合模型<code class="email">fit</code>上的<code class="email">predict</code>函数来响应<em class="calibre8"> y </em>。最后，我们使用<code class="email">lines</code>函数向散点图添加回归线。</h2></div></div></div><p class="calibre7">除了使用这些线在散点图上添加拟合回归线，<code class="email">gam</code>还有一个<code class="email">plot</code>功能来可视化包含置信区域的拟合回归线。为了给置信区域加阴影，我们在函数中赋值<code class="email">shade = TRUE</code>。</p><p class="calibre7">还有更多...</p></div></div></body></html>


<html>
  <head>
    <title>Visualizing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4"><code class="email">vis.gam</code>功能用于产生<code class="email">gam</code>模型预测的透视图或等高线图。观察反应变量如何与两个预测变量相互作用是有帮助的。以下是<code class="email">Boston</code>数据集的等高线图示例:</h2></div></div></div><p class="calibre7">由vis.gam生成的等高线图示例</p><div><pre class="programlisting">
<strong class="calibre2">&gt; fit2=gam(medv~crim+zn+crim:zn, data=Boston)</strong>
<strong class="calibre2">&gt; vis.gam(fit2)</strong>
</pre></div><div><img src="img/00099.jpeg" alt="There's more..." class="calibre9"/><div><p class="calibre12">A sample contour plot produced by vis.gam</p></div></div><p class="calibre10"><a id="ch04lvl1sec53" class="calibre1"/>诊断广义加性模型</p></div></div></body></html>


<html>
  <head>
    <title>Diagnosing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div/><div><div><div><div><h1 class="title" id="calibre_pb_0">GAM还<a id="id424" class="calibre1"/>提供关于广义加性模型的拟合程序和结果的诊断信息。在本配方中，我们演示如何通过<code class="email">gam.check</code>功能绘制诊断图。</h1></div></div></div><p class="calibre7">做好准备</p></div></body></html>


<html>
  <head>
    <title>Diagnosing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_1">确保前一个配方已完成，并将<code class="email">gam</code>适合的模型分配给<code class="email">fit</code>变量。</h2></div></div></div><p class="calibre7"><a id="ch04lvl2sec174" class="calibre1"/>怎么做...</p></div></div></body></html>


<html>
  <head>
    <title>Diagnosing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_2">执行<a id="id425" class="calibre1"/>以下步骤诊断广义加性模型:</h2></div></div></div><p class="calibre7">拟合gam的诊断图</p><div><ol class="orderedlist"><li class="listitem" value="1">Generate the diagnostic plot using <code class="email">gam.check</code> on the fitted model:<div><pre class="programlisting">
<strong class="calibre2">&gt; gam.check(fit)</strong>

<strong class="calibre2">Method: GCV   Optimizer: magic</strong>
<strong class="calibre2">Smoothing parameter selection converged after 7 iterations.</strong>
<strong class="calibre2">The RMS GCV score gradient at convergence was 8.79622e-06 .</strong>
<strong class="calibre2">The Hessian was positive definite.</strong>
<strong class="calibre2">The estimated model rank was 10 (maximum possible: 10)</strong>
<strong class="calibre2">Model rank =  10 / 10 </strong>

<strong class="calibre2">Basis dimension (k) checking results. Low p-value (k-index&lt;1) may</strong>
<strong class="calibre2">indicate that k is too low, especially if edf is close to k'.</strong>

<strong class="calibre2">          k'   edf k-index p-value</strong>
<strong class="calibre2">s(nox) 9.000 8.434   0.397       0</strong>
</pre></div><div><img src="img/00100.jpeg" alt="How to do it..." class="calibre9"/><div><p class="calibre12">Diagnostic plot of fitted gam</p></div></div><p class="calibre13">它是如何工作的...</p></li></ol><div/></div></div></div></body></html>


<html>
  <head>
    <title>Diagnosing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_3"><code class="email">gam.check</code>功能首先产生平滑参数估计收敛信息。在<a id="id426" class="calibre1"/>这个例子中，平滑参数，<strong class="calibre2"> GCV/UBRE </strong> ( <strong class="calibre2">广义交叉验证/无偏风险估计器</strong>)分数在七次迭代后收敛<a id="id427" class="calibre1"/>。GCV/UBRE函数的平均<a id="id428" class="calibre1"/>绝对梯度最小值为8.79622e-06，估计秩为<code class="email">10</code>。尺寸检查是为了测试平滑函数的基本尺寸是否足够。在这个例子中，低p值表示k设置得太低。用户可以通过将<code class="email">gam</code>与数据拟合来指定参数k，从而调整平滑的尺寸选择。</h2></div></div></div><p class="calibre7">除了提供关于平滑参数估计收敛的信息，该函数还返回四个诊断图。截屏图的左上部分显示了一个<strong class="calibre2">分位数比较</strong>图。该图有助于识别异常值<a id="id429" class="calibre1"/>和重尾。图的右上部分显示了残差与线性预测值的关系，这在查找非恒定误差方差时非常有用。图的左下部分显示了残差的直方图，这有助于检测非正态性。右下部分显示了响应与拟合值的对比。</p><p class="calibre7"><a id="ch04lvl2sec176" class="calibre1"/>还有更多...</p></div></div></body></html>


<html>
  <head>
    <title>Diagnosing a generalized additive model</title>
    <meta name="generator" content="DocBook XSL Stylesheets V1.75.2"/>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
  

</head>
  <body id="page" class="calibre">
<div><div><div><div><div><h2 class="title1" id="calibre_pb_4">关于<code class="email">gam.check</code>的更多信息，您可以访问<code class="email">help</code>功能。特别是，这包括平滑参数估计收敛的详细说明和四个返回图:</h2></div></div></div><p class="calibre7">此外，<code class="email">choose.k</code>的更多<a id="id430" class="calibre1"/>信息可通过以下命令访问:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; ?gam.check</strong>
</pre></div><p class="calibre7">In addition, more<a id="id430" class="calibre1"/> information for <code class="email">choose.k</code> can be accessed by the following command:</p><div><pre class="programlisting">
<strong class="calibre2">&gt; ?choose.k</strong>
</pre></div></div></div></body></html>
</body></html>