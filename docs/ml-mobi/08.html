<html><head/><body>


    
        <title>Fritz</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">德国人</h1>
                
            
            
                
<p>在前面的章节中，我们已经浏览了Google提供的移动机器学习SDK——tensor flow for mobile——和Apple提供的Core ML——并对它们有了很好的理解。我们研究了这些产品的基本架构、它们提供的关键特性，还使用这些SDK尝试了一些任务/程序。基于我们迄今为止对移动机器学习框架和工具的探索，我们将能够确定一些差距，这些差距使得难以执行移动机器学习部署以及这些部署的后续维护和支持。让我给你列举几个:</p>
<ul>
<li>一旦我们创建了机器学习模型并将其导入到Android或iOS应用程序中，如果需要对导入到移动应用程序中的模型进行任何更改，您认为这种更改将如何实施并升级到在现场部署和使用的应用程序中？如何在不在移动应用商店(App Store或Play Store)中重新部署应用的情况下更新/升级模型？</li>
<li class="mce-root">一旦机器学习模型进入现场，并被现场用户使用，我们如何在实时用户场景中监控模型的性能和使用情况？</li>
<li class="mce-root">此外，您可能已经体验到，在iOS和Android中使用机器学习模型的过程和机制是不一样的。此外，为了使机器学习模型与TensorFlow Lite和Core ML兼容，使用各种机器学习框架(如TensorFlow和scikit-learn)创建机器学习模型的机制也不同。没有开发人员可以遵循的通用过程和使用模式来跨框架创建和使用这些模型。我们认为，如果有一种通用的方法来使用这些来自不同供应商的使用相同过程和机制的机器学习模型，那将会简单得多。</li>
</ul>
<p>Fritz平台已经尝试回答前面提到的在机器学习模型使用和部署中观察到的所有差距。Fritz作为一个机器学习平台，试图为移动应用程序提供促进机器学习模型使用和部署的解决方案。它是一个移动机器学习平台，具有即用型机器学习功能，以及导入和使用自定义ML模型的选项—TensorFlow用于移动和核心ML模型。</p>
<p>因此，在本章中，我们将详细讨论以下内容:</p>
<ul>
<li>了解Fritz移动机器学习平台、其功能和优势。</li>
<li>通过使用我们已经使用Core ML创建的回归模型，探索Fritz并实现iOS移动应用程序。</li>
<li>探索Fritz并使用我们在第三章<a href="10656284-f170-420b-a35c-e11cf1f3d988.xhtml" target="_blank">中创建的示例Android模型实现一个Android移动应用，在iOS上使用tensor flow<em>随机森林。</em></a></li>
</ul>


            

            
        
    






    
        <title>Introduction to Fritz</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">弗里茨简介</h1>
                
            
            
                
<p>Fritz是一个免费的端到端平台，使我们能够轻松创建基于机器学习的移动应用程序。它是一个支持设备上机器学习的平台，也就是说，它有助于创建完全可以在移动设备上工作的移动机器学习应用程序。它同时支持iOS和Android平台。</p>


            

            
        
    






    
        <title>Prebuilt ML models</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">预建ML模型</h1>
                
            
            
                
<p>Fritz提供了内置的ML模型，可以直接在移动应用程序中使用。以下是Fritz支持的两个重要模型:</p>
<ul>
<li><strong>物体检测</strong>:您可以识别一幅图像或实时视频的每一帧中感兴趣的物体。这有助于您了解图像中有哪些对象，以及它们在图像中的位置。物体探测功能使预测<em>完全在设备上</em>和<em> </em>不需要互联网连接<em>。</em></li>
<li><strong>图像标注</strong>:可以识别一幅图像或每一帧直播视频的内容。这也完全离线工作，不需要互联网连接。</li>
</ul>


            

            
        
    






    
        <title>Ability to use custom models</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">使用定制模型的能力</h1>
                
            
            
                
<p>Fritz为我们提供了将为Core ML、TensorFlow for mobile和TensorFlow Lite构建的模型导入移动应用程序的能力，并提供了可以与这些模型直接交互的API。</p>


            

            
        
    






    
        <title>Model management</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">模型管理</h1>
                
            
            
                
<p>Fritz的主要优势在于它支持ML模型管理和实时升级:</p>
<ul>
<li>它为我们提供了升级现场部署的机器学习模型的能力，也就是说，它允许开发人员升级或更改ML模型，而无需在移动应用商店中进行应用升级和重新部署。</li>
<li>它为我们提供了监控部署到该领域的机器学习模型的性能的工具。</li>
<li>它有助于部署、分析和机器学习模型管理。</li>
</ul>


            

            
        
    






    
        <title>Hand-on samples using Fritz</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">使用Fritz的动手样品</h1>
                
            
            
                
<p>在本节中，我们将尝试使用Fritz以及我们已经使用Core ML和TensorFlow for mobile为iOS和Android创建的模型，并使用Fritz构建iOS和Android移动应用。与此同时，我们将了解如何使用Fritz内置模型，如对象检测和图像标记。</p>


            

            
        
    






    
        <title>Using the existing TensorFlow for mobile model in an Android application using Fritz</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">在使用Fritz的Android应用程序中使用现有的TensorFlow for mobile模型</h1>
                
            
            
                
<p>在本节中，我们将了解如何使用TensorFlow for mobile模型，我们已经使用Fritz toolkit在Android移动应用程序中创建了该模型。我们将使用TensorFlow for mobile创建的示例模型进行求和<em> (a+b) </em>。我们将详细介绍实现这一目标所需的步骤。</p>


            

            
        
    






    
        <title>Registering with Fritz</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">向弗里茨注册</h1>
                
            
            
                
<p>为了使用Fritz，您必须在Fritz门户网站注册一个帐户:</p>
<ol>
<li>转到<a href="https://fritz.ai/" target="_blank">https://fritz.ai/</a></li>
<li>点击顶部菜单上的登录</li>
<li>点击创建账户</li>
<li>输入您的详细信息并提交</li>
<li>在Fritz中创建新项目</li>
</ol>
<p>拥有帐户后，使用您的凭据登录，然后执行以下步骤:</p>
<ol>
<li>点击“添加新项目”按钮</li>
<li>输入项目名称和组织</li>
<li>点击提交</li>
</ol>


            

            
        
    






    
        <title>Uploading the model file (.pb or .tflite)</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">正在上传模型文件(。pb或者。tflite)</h1>
                
            
            
                
<ol>
<li>单击左侧菜单中的自定义模型</li>
<li>给出模型名称和描述</li>
<li>上传模型文件</li>
<li>单击创建模型文件按钮</li>
</ol>
<p>上传后，模型页面将如下所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/2203fa09-f4ff-4a7e-bcd0-41a9b5f909a7.png"/></p>
<p>这里，我们使用的是在《T4》第三章、<em>iOS上的随机森林</em>中创建的相同模型:用于Android的TensorFlow。GitHub的网址是<a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/blob/master/tensorflow%20simple/tensor/frozen_tfdroid.pb" target="_blank">https://GitHub . com/packt publishing/Machine-Learning-for-Mobile/blob/master/tensor flow % 20 simple/tensor/frozen _ TF droid . Pb</a>。</p>


            

            
        
    






    
        <title>Setting up Android and registering the app</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">设置Android并注册应用程序</h1>
                
            
            
                
<p>我们已经创建了一个项目，并向其中添加了一个模型。让我们看看如何在Android项目中使用这个模型。现在，我将向您展示如何将我们在<a href="10656284-f170-420b-a35c-e11cf1f3d988.xhtml" target="_blank">第3章</a>、<em>iOS上的随机森林</em>中看到的TensorFlow简单示例转换为fritz格式。要继续，请在Android studio中打开该示例。</p>
<p>如果没有，可以从<a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/tensorflow%20simple" target="_blank">https://github . com/packt publishing/Machine-Learning-for-Mobile/tree/master/tensor flow % 20 simple</a>下载。在给定的路径中有TensorFlow示例是Android项目，在Android studio中打开它。</p>


            

            
        
    






    
        <title>Adding Fritz's TFMobile library</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">添加Fritz的TFMobile库</h1>
                
            
            
                
<p>在本节中，我们将把这个项目转换成Fritz管理的项目。在模型页面中，单击SDK说明按钮。它将打开一个显示集成信息的对话框，如下所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/2bd78edd-34d0-44f9-994e-18659b6d168c.png"/></p>
<p>在这里，您将找到API键，它对于项目是唯一的，模型Id，它对于您上传的每个模型都是变化的，以及创建解释器的代码。</p>


            

            
        
    






    
        <title>Adding dependencies to the project</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">向项目添加依赖项</h1>
                
            
            
                
<p>为了访问Fritz解释器，您需要向您的项目添加依赖项。为此，请打开您的模块应用程序的<kbd>build.gradle</kbd>文件。您需要添加一个指向Fritz Maven存储库的存储库条目。为此，添加以下几行:</p>
<pre>repositories {<br/>    maven { url "https://raw.github.com/fritzlabs/fritz-repository/master" }<br/>}</pre>
<p>现在添加Fritz依赖项:</p>
<pre>dependencies {<br/>    implementation fileTree(dir: 'libs', include: ['*.jar'])<br/>    implementation 'com.android.support:appcompat-v7:27.1.0'<br/>    implementation 'com.android.support.constraint:constraint-layout:1.1.2'<br/>    implementation 'ai.fritz:core:1.0.0'<br/>    implementation 'ai.fritz:custom-model-tfmobile:1.0.0'<br/>    implementation 'com.stripe:stripe-android:6.1.2'<br/>}</pre>
<p>使用前面的代码，我们添加了Fritz核心库和<kbd>tfmobile</kbd>库。fritz核心库需要与Fritz云服务器通信，以下载用于版本管理的模型文件。<kbd>tfmobile</kbd>库是必需的，因为我们正在使用TensorFlow移动模型，我们需要TensorFlow库进行推理。</p>


            

            
        
    






    
        <title>Registering the FritzJob service in your Android Manifest</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">在Android清单中注册FritzJob服务</h1>
                
            
            
                
<p>我已经提到过，当部署在fritz云服务器上时，您的应用程序将下载模型文件。为此，Fritz实现了一个名为<kbd>FritzJob</kbd> service的服务，它将在后台运行。当它发现您的web控制台中部署了新型号时，它会在设备连接到Wi-Fi时尝试下载它。</p>
<p>若要登录你的云帐户，你的应用需要一些凭据。为此，fritz提供了一个API密钥。为此，我们需要在Android manifest XML文件中添加一个元条目，如下所示:</p>
<pre>&lt;meta-data android:name="fritz_api_key" android:value="6265ed5e7e334a97bbc750a09305cb19" /&gt;</pre>
<p>您需要用您的值替换fritz API键的值，该值是在您单击SDK INSTRUCTIONS时从浏览器的上一个对话框中获得的。</p>
<p>我们需要声明Fritz作业，如下所示:</p>
<pre>&lt;service<br/>    android:name="ai.fritz.core.FritzJob"<br/>    android:exported="true"<br/>    android:permission="android.permission.BIND_JOB_SERVICE" /&gt;</pre>
<p class="mce-root">由于我们的应用程序需要通过Wi-Fi连接到云服务器，因此我们需要提及互联网访问权限:</p>
<pre>&lt;uses-permission android:name="android.permission.INTERNET"/&gt;</pre>
<p>现在，我的整个清单文件将如下所示:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"<br/>    package="org.packt.fritz.samplefritzapp"&gt;<br/><br/>    &lt;uses-permission android:name="android.permission.INTERNET"/&gt;<br/><br/>    &lt;application<br/>        android:allowBackup="true"<br/>        android:icon="@mipmap/ic_launcher"<br/>        android:label="@string/app_name"<br/>        android:roundIcon="@mipmap/ic_launcher_round"<br/>        android:supportsRtl="true"<br/>        android:theme="@style/AppTheme"&gt;<br/>        &lt;activity android:name=".MainActivity"&gt;<br/>            &lt;intent-filter&gt;<br/>                &lt;action android:name="android.intent.action.MAIN" /&gt;<br/><br/>               &lt;category android:name="android.intent.category.LAUNCHER" /&gt;<br/>            &lt;/intent-filter&gt;<br/>        &lt;/activity&gt;<br/>        &lt;meta-data android:name="fritz_api_key" android:value="6265ed5e7e334a97bbc750a09305cb19" /&gt;<br/>        &lt;service<br/>            android:name="ai.fritz.core.FritzJob"<br/>            android:exported="true"<br/>            android:permission="android.permission.BIND_JOB_SERVICE" /&gt;<br/>    &lt;/application&gt;<br/><br/>&lt;/manifest&gt;</pre>


            

            
        
    






    
        <title>Replacing the TensorFlowInferenceInterface class with Fritz Interpreter</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">用Fritz解释器替换TensorFlowInferenceInterface类</h1>
                
            
            
                
<p>打开应用程序的主活动，并进行以下更改:</p>
<pre>package org.packt.fritz.samplefritzapp;<br/><br/>import android.os.Bundle;<br/>import android.support.v7.app.AppCompatActivity;<br/>import android.view.View;<br/>import android.widget.Button;<br/>import android.widget.EditText;<br/>import android.widget.TextView;<br/>import android.widget.Toast;<br/><br/>import org.tensorflow.contrib.android.TensorFlowInferenceInterface;<br/><br/>import ai.fritz.core.*;<br/>import ai.fritz.customtfmobile.*;</pre>
<p>在前面的<kbd>import</kbd>语句中，我们已经为Fritz核心库和Fritz自定义模型库添加了导入，并且我们还使用了Google <kbd>TensorflowInfereceInterface</kbd>:</p>
<pre>public class MainActivity extends AppCompatActivity {<br/><br/>private TensorFlowInferenceInterface inferenceInterface;<br/><br/> static {<br/>System.loadLibrary("tensorflow_inference");<br/> }</pre>
<p>在前面几行中，我们已经声明了TensorFlow推理接口并加载了<kbd>tensorflow_inference</kbd>库，这是可选的。这可以由Fritz自己隐式地完成:</p>
<pre> @Override<br/> protected void onCreate(Bundle savedInstanceState) {<br/>        super.onCreate(savedInstanceState);<br/> setContentView(R.layout.activity_main);<br/> Fritz.configure(this);</pre>
<p>在前面几行中，我们已经配置了fritz服务并将其与应用程序链接起来。在这里，它将验证应用程序包名称是否已添加到您的Fritz控制台。</p>
<p>为此，您需要在Fritz web控制台的项目左侧菜单中单击项目设置。</p>
<p>然后，点击添加android应用程序到您的项目，它会打开一个对话框，如下所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/18a86293-cbf8-4227-84f3-e8a3d5b44beb.png" style="width:34.67em;height:31.33em;"/> <br/></p>
<p class="CDPAlignLeft CDPAlign">在这种情况下，您需要为您的应用程序命名，以便识别。然后，您需要从Android清单文件中获取包名，并将其输入到包id文本字段中。</p>
<p>您可以从清单文件的manifest标记中获得这个特殊的标记，如下所示:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"<br/>    package="<strong>org.packt.fritz.samplefritzapp</strong>"&gt;</pre>
<p>注册后，请回到我们的代码:</p>
<pre> try {<br/> <br/>FritzTFMobileInterpreter interpreter = FritzTFMobileInterpreter.create(this.getApplicationContext(),<br/> new ModelSettings.Builder()<br/>.modelId("2a83207a32334fceaa29498f57cbd9ae")<br/>.modelPath("ab2.pb")<br/>.modelVersion(1)<br/>.build());</pre>
<p>在这里，我们为Fritz模型创建一个对象。第一个参数是应用程序上下文对象，第二个参数是模型信息对象。</p>
<p>在型号设置中，我们将提供型号ID，这可以从您在Fritz web控制台的型号页面中单击SDK说明时显示的对话框中获得。</p>
<p>另一件重要的事情是模型路径。这是你放在<kbd>assets</kbd>文件夹中的模型文件名:</p>
<pre> inferenceInterface = interpreter.getInferenceInterface();</pre>
<p>在前一行中，我们获取了TensorFlow推理接口对象，并将其赋给全局声明的变量:</p>
<pre> final Button button = (Button) findViewById(R.id.button);<br/><br/> button.setOnClickListener(new View.OnClickListener() {<br/> public void onClick(View v) {<br/> <br/> final EditText editNum1 = (EditText) findViewById(R.id.editNum1);<br/> final EditText editNum2 = (EditText) findViewById(R.id.editNum2);<br/><br/><br/> float num1 = Float.parseFloat(editNum1.getText().toString());<br/> float num2 = Float.parseFloat(editNum2.getText().toString());<br/><br/> long[] i = {1};<br/><br/> int[] a = {Math.round(num1)};<br/> int[] b = {Math.round(num2)};<br/><br/> inferenceInterface.feed("a", a, i);<br/> inferenceInterface.feed("b", b, i);<br/><br/> inferenceInterface.run(new String[]{"c"});<br/><br/> int[] c = {0};<br/> inferenceInterface.fetch("c", c);<br/><br/> final TextView textViewR = (TextView) findViewById(R.id.txtViewResult);<br/> textViewR.setText(Integer.toString(c[0]));<br/> }<br/>});<br/> }<br/> catch (Exception ex)<br/>{<br/>Toast.makeText(this.getApplicationContext(),ex.toString(),Toast.LENGTH_LONG).show();<br/><br/> }<br/> <br/>}<br/> <br/>}</pre>
<p>在前面的块中，我们注册了一个事件侦听器，每当用户单击Run按钮时，它都会执行推理。</p>


            

            
        
    






    
        <title>Building and running the application</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">构建和运行应用程序</h1>
                
            
            
                
<p>要查看结果，请连接设备并运行项目。它将显示结果，如下所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/f857b572-f948-4a07-8668-75b940557d64.png" style="width:22.67em;height:40.42em;"/></p>


            

            
        
    






    
        <title>Deploying a new version of your model</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">部署模型的新版本</h1>
                
            
            
                
<p>Fritz真正的强大之处在于自动下载修改后的模型文件。在这里，我们将演示这一点。</p>
<p>到目前为止，我们已经上传了我们的旧<em> (a+b) </em> <sup> <em> 2 </em> </sup>模型并执行了推理。现在我们将其更新为<em>(a+b)</em><sup><em>3</em></sup>并检查我们的app是否自动下载修改后的模型。</p>
<p>为此，我们需要创建<em> (a+b) </em> <sup> 3 </sup>模型。首先，我们需要回忆一下我们在<a href="cb30489a-0fda-4d76-bf46-985510e6e7e7.xhtml" target="_blank">第4章</a>、<em>tensor flow Mobile in Android</em>下的<em>创建和保存模型</em>部分，在那里我们创建了<em> (a+b) <sup> 2 </sup> </em>模型。我们将做一个小小的改变来转换这个模型:</p>
<pre><br/>import tensorflow as tf<br/><br/>a = tf.placeholder(tf.int32, name='a')  # input<br/>b = tf.placeholder(tf.int32, name='b')  # input<br/>times = tf.Variable(name="times", dtype=tf.int32, initial_value=3)<br/>c = tf.pow(tf.add(a, b), times, name="c")<br/><br/>saver = tf.train.Saver()<br/>init_op = tf.global_variables_initializer()<br/>with tf.Session() as sess:<br/>    sess.run(init_op)<br/><br/>    tf.train.write_graph(sess.graph_def, '.', 'tfdroid.pbtxt')<br/>    sess.run(tf.assign(name="times", value=3, ref=times))<br/>    # save the graph<br/><br/>    # save a checkpoint file, which will store the above assignment<br/>    saver.save(sess, './tfdroid.ckpt')</pre>
<p>在前面的程序中，我们所做的唯一更改是对变量<kbd>times</kbd>的值，现在是<kbd>3</kbd>。这会导致(a+b)乘以三，得到<em> (a+b) <sup> 3 </sup> </em>。关于如何运行和生成<kbd>.pb</kbd>扩展模型文件的说明，请参见<a href="cb30489a-0fda-4d76-bf46-985510e6e7e7.xhtml" target="_blank"/> <a href="cb30489a-0fda-4d76-bf46-985510e6e7e7.xhtml" target="_blank"/> <a href="cb30489a-0fda-4d76-bf46-985510e6e7e7.xhtml" target="_blank"/> <a href="cb30489a-0fda-4d76-bf46-985510e6e7e7.xhtml" target="_blank">第四章</a>、<em>安卓版tensor flow Mobile</em>。</p>
<p>一旦您获得了<kbd>frozen_tfdroid.pb</kbd>文件，您就可以从您的模型页面的Fritz web控制台上传它，如下面的屏幕截图所示:</p>
<div><img src="img/57b49ebc-400c-44b1-984e-f6a5caaea24b.png"/></div>
<p>展开“添加更新的模型”窗格，并上传生成的模型。它将作为版本2添加到右侧表格中:</p>
<div><img src="img/0a05636b-2b11-4778-a16d-eea07381a81d.png"/></div>
<p>现在你已经上传了模型的修订版，但是还没有发布。为此，您需要展开“发布新版本”窗格并发布您需要的版本。</p>
<p>完成后，所有安装了您的应用程序的移动设备在通过WiFi网络连接到互联网时，都将下载发布的型号。</p>
<p>以下是我连接WiFi路由器并重启应用程序后得到的结果:</p>
<div><img src="img/65d6ae9a-3c1b-4fcc-ae7e-9a3bfad4a1e2.png" style="width:19.75em;height:35.08em;"/></div>


            

            
        
    






    
        <title>Creating an android application using fritz pre-built models</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">使用fritz预建模型创建android应用程序</h1>
                
            
            
                
<p>Fritz为iOS和Android提供了两种预建模型:</p>
<ul>
<li>图像标注</li>
<li>目标检测</li>
</ul>
<p>在这一部分，我们将看到如何在你的Android应用中使用图像标签模型。</p>
<p>为此，您需要在Fritz中创建一个项目；请参考使用Fritz 在Android应用中使用现有TensorFlow for mobile模型的<em>一节中给出的步骤。</em></p>
<p>现在，打开Android studio，创建一个包含空活动和布局文件的空项目。</p>


            

            
        
    






    
        <title>Adding dependencies to the project</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">向项目添加依赖项</h1>
                
            
            
                
<p>为了访问前面对话框中显示的fritz解释器，您需要将依赖项添加到项目中。为此，请打开您的模块应用程序的<kbd>build.gradle</kbd>文件。</p>
<p>您需要添加一个指向fritz maven存储库的存储库条目。为此，添加以下几行:</p>
<pre>repositories {<br/>    maven { url "https://raw.github.com/fritzlabs/fritz-repository/master" }<br/>}</pre>
<p>现在，添加fritz依赖项:</p>
<pre>dependencies {<br/>    implementation fileTree(dir: 'libs', include: ['*.jar'])<br/>    implementation 'com.android.support:appcompat-v7:26.1.0'<br/>    implementation 'com.android.support.constraint:constraint-layout:1.1.2'<br/>    implementation 'ai.fritz:core:1.0.1'<br/>    implementation 'ai.fritz:vision-label-model:1.0.1'<br/><br/>}</pre>
<p>在前面几行中，我们添加了fritz core库和fritz vision库用于标记。Fritz核心库需要与fritz云服务器通信，以便下载用于版本管理的模型文件。</p>
<p>用于贴标的Fritz视觉库将下载所需的库，如TensorFlow mobile和视觉依赖项。</p>


            

            
        
    






    
        <title>Registering the Fritz JobService in your Android Manifest</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">在您的Android清单中注册Fritz JobService</h1>
                
            
            
                
<p>我已经提到过，当部署在fritz云服务器上时，您的应用程序将下载模型文件。为此，Fritz实现了一个名为<kbd>FritzJob</kbd>的服务。该服务将在后台运行，当它发现您的web控制台中部署了新型号时，它会在设备通过WiFi网络连接时尝试下载该型号。</p>
<p>若要登录你的云帐户，你的应用需要一些凭据。为此，fritz提供了一个API密钥。为此，我们需要向Android manifest XML文件添加一个元条目，如下所示:</p>
<pre>&lt;meta-data<br/>    android:name="fritz_api_key"<br/>    android:value="e35d2b5bbba84eca8969b7d6acac1fb7" /&gt;</pre>
<p>当你点击<kbd>SDK INSTRUCTIONS</kbd>时，你需要用你从浏览器的前一个对话框中得到的值替换Fritz API键的值。</p>
<p>我们需要声明Fritz作业，如下所示:</p>
<pre>&lt;service<br/>    android:name="ai.fritz.core.FritzJob"<br/>    android:exported="true"<br/>    android:permission="android.permission.BIND_JOB_SERVICE" /&gt;</pre>
<p class="mce-root">由于我们的应用程序需要通过WiFi连接到云服务器，因此我们需要提及互联网访问权限:</p>
<pre>&lt;uses-permission android:name="android.permission.INTERNET"/&gt;</pre>
<p>我们需要添加以下几行:</p>
<pre>&lt;uses-sdk android:minSdkVersion="21" android:targetSdkVersion="21" /&gt;<br/>&lt;uses-feature android:name="android.hardware.camera2.full" /&gt;<br/>&lt;uses-permission android:name="android.permission.CAMERA" /&gt;<br/></pre>
<p>在Android中，相机处理机制已被更改为<kbd>camera2</kbd>包，前面一行指定了使用哪个<kbd>camera2</kbd>功能。要了解更多相关信息，请查看<a href="https://developer.android.com/reference/android/hardware/camera2/CameraCharacteristics#INFO_SUPPORTED_HARDWARE_LEVEL">https://developer . Android . com/reference/Android/HARDWARE/camera 2/camera characteristics # INFO _ SUPPORTED _ HARDWARE _ LEVEL</a>。因此，为了访问摄像机，我们还添加了摄像机权限。</p>
<p>现在，我的整个清单文件将如下所示:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"<br/>    package="com.example.avinaas.imagelabelling"&gt;<br/><br/>    &lt;uses-sdk android:minSdkVersion="21" android:targetSdkVersion="21" /&gt;<br/>    &lt;uses-feature android:name="android.hardware.camera2.full" /&gt;<br/>    &lt;uses-permission android:name="android.permission.CAMERA" /&gt;<br/>    &lt;uses-permission android:name="android.permission.INTERNET" /&gt;<br/><br/>    &lt;application<br/>        android:allowBackup="true"<br/>        android:icon="@mipmap/ic_launcher"<br/>        android:label="@string/app_name"<br/>        android:roundIcon="@mipmap/ic_launcher_round"<br/>        android:supportsRtl="true"<br/>        android:theme="@style/AppTheme"&gt;<br/>        &lt;activity android:name=".MainActivity"&gt;<br/>            &lt;intent-filter&gt;<br/>                &lt;action android:name="android.intent.action.MAIN" /&gt;<br/><br/>                &lt;category android:name="android.intent.category.LAUNCHER" /&gt;<br/>            &lt;/intent-filter&gt;<br/>        &lt;/activity&gt;<br/>        &lt;meta-data<br/>            android:name="fritz_api_key"<br/>            android:value="e35d2b5bbba84eca8969b7d6acac1fb7" /&gt;<br/>        &lt;service<br/>            android:name="ai.fritz.core.FritzJob"<br/>            android:exported="true"<br/>            android:permission="android.permission.BIND_JOB_SERVICE" /&gt;<br/>    &lt;/application&gt;<br/><br/>&lt;/manifest&gt;</pre>


            

            
        
    






    
        <title>Creating the app layout and components</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">创建应用程序布局和组件</h1>
                
            
            
                
<p>在位于<kbd>assets/layouts</kbd>文件夹中的<kbd>activity_main.xml</kbd>文件中，您需要输入以下代码:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"<br/>    xmlns:tools="http://schemas.android.com/tools"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="match_parent"<br/>    tools:context="com.example.avinaas.imagelabelling.MainActivity"&gt;<br/><br/>&lt;TextureView<br/>    android:id="@+id/preview"<br/>    android:layout_width="match_parent"<br/>    android:layout_height="wrap_content"<br/>    android:layout_above="@id/btn_takepic"<br/>    android:layout_alignParentTop="true"/&gt;<br/><br/>    &lt;Button<br/>        android:id="@+id/btn_takepic"<br/>        android:layout_width="wrap_content"<br/>        android:layout_height="wrap_content"<br/>        android:layout_alignParentBottom="true"<br/>        android:layout_centerHorizontal="true"<br/>        android:layout_marginBottom="16dp"<br/>        android:layout_marginTop="16dp"<br/>        android:text="Start Labeling"<br/>        /&gt;<br/>&lt;/RelativeLayout&gt;<br/></pre>
<p>在前面的XML工具中，上下文值需要随着您的主活动而改变。</p>
<p>在前面的XML中，我们添加了一个接收事件的按钮和一个纹理视图，该视图充当摄像机流的占位符。</p>
<p>上述布局的设计视图将如下所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/a9e46b74-7a2c-4cb9-9cb0-cf93281afb92.png"/></p>


            

            
        
    






    
        <title>Coding the application</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">编写应用程序代码</h1>
                
            
            
                
<p>这个应用程序的代码可以在您的GitHub存储库中找到，地址是<a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/Fritz/imagelabelling/imagelabelling">https://GitHub . com/packt publishing/Machine-Learning-for-Mobile/tree/master/Fritz/image labeling/image labeling</a>。<a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/Fritz/imagelabelling/imagelabelling"/></p>
<p>一旦你下载了代码，在Android studio中打开它，你可以在<kbd>MainActivity.java</kbd>中找到代码。</p>
<p>解释整个代码，可能更多的是处理android代码。在这里，您可以找到重要代码块的解释:</p>
<pre>Fritz.configure(this.getApplicationContext());</pre>
<p><kbd>oncreate</kbd>生命周期方法中的前一行将初始化Fritz框架:</p>
<pre>options = new FritzVisionLabelPredictorOptions.Builder()<br/>        .confidenceThreshold(0.3f)<br/>        .build();</pre>
<p>前面一行将为标注预测器创建配置选项:</p>
<pre>visionPredictor = FritzVisionLabelPredictor.getInstance(this.getApplicationContext(), options);</pre>
<p>创建预测器的实例:</p>
<pre>Bitmap bmp = BitmapFactory.decodeFile(file.getPath());</pre>
<p>将图像保存到文件并将其转换为位图:</p>
<pre>FritzVisionImage img = FritzVisionImage.fromBitmap(bmp);<br/>List&lt;FritzVisionLabel&gt; labels = visionPredictor.predict(img);</pre>
<p>将位图图像转换为fritz vision图像，并将该图像对象提供给预测器的<kbd>predit</kbd>方法，该方法反过来将预测的标签作为列表返回:</p>
<pre>String output="";<br/><br/>for(FritzVisionLabel lab: labels)<br/>{<br/>    output = output + lab.getText()+"\t Confidence: "+ lab.getConfidence();<br/>}<br/><br/>if(output.trim().length()==0)<br/>{<br/>    output = "Unable to predict.";<br/>}<br/>Toast.makeText(MainActivity.this, output, Toast.LENGTH_LONG).show();</pre>
<p>由于预测器返回了一个<kbd>Fritzvisionlabel</kbd>对象的列表，我们需要解码并显示给用户。前面的代码向用户显示了Toast消息中的内容和置信度。</p>
<p>一旦您运行应用程序，从相机捕捉的图像帧将显示在我们在布局中创建的纹理视图中。</p>
<p>一旦点击开始标记<strong> </strong>按钮，它会将图像保存到磁盘，并将相同的图像输入到<kbd>Fritzvisionlabel</kbd>预测器。一旦您恢复了预测结果，您将解释它并以<kbd>Toast</kbd>消息的形式显示给用户。</p>
<p>为了让前面的应用程序工作，我们需要将此应用程序添加到您的Fritz项目中。</p>
<p>为此，请在Fritz web控制台中单击项目左侧菜单中的项目设置。</p>
<p>然后，点击添加android应用程序到您的项目，它会打开一个对话框，如下所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/0b0e95bb-682e-4063-aa3e-c519b9d2fdb7.png"/></p>
<p class="CDPAlignLeft CDPAlign">在这种情况下，您需要为您的应用程序命名，以便识别。然后，您需要从您的android清单文件中获取包名，并将其输入到<kbd>Package ID</kbd>文本字段中。</p>
<p>这可以从清单文件的清单标记中获得，如下所示:</p>
<pre>&lt;?xml version="1.0" encoding="utf-8"?&gt;<br/>&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"<br/>    package="<strong>com.example.avinaas.imagelabelling</strong>"&gt;</pre>
<p>一旦你注册了这个应用程序，你就可以通过将一个Android设备连接到你的PC并启用USB调试选项来运行并查看结果。</p>
<p>请确保您在android studio中禁用了即时运行选项。这可以通过文件菜单中的设置选项来完成。</p>
<p>成功运行应用程序后，结果将如下所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/ad0939bc-9640-4c81-8070-f7a8d81cec0a.png" style="width:21.25em;height:37.75em;"/></p>


            

            
        
    






    
        <title>Using the existing Core ML model in an iOS application using Fritz</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">在使用Fritz的iOS应用程序中使用现有的核心ML模型</h1>
                
            
            
                
<p>在这一节中，我们将看到如何使用我们已经使用Fritz toolkit在iOS移动应用程序中创建的核心ML模型。我们将使用<kbd>Boston</kbd>数据集获取使用Core ML创建的<kbd>HousePricer.mlmodel</kbd>，并使用线性回归算法执行房价预测。我们将详细说明实现这一目标所需的步骤。</p>
<p>为此，请在<a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/housing%20price%20prediction/sample">https://GitHub . com/packt publishing/Machine-Learning-for-Mobile/tree/master/housing % 20 price % 20 prediction/sample</a>下载房价预测包GitHub中的线性回归示例源代码。<a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/housing%20price%20prediction/sample"/></p>


            

            
        
    






    
        <title>Registering with Fritz</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">向弗里茨注册</h1>
                
            
            
                
<p>为了使用fritz，您必须在fritz门户网站上注册一个帐户:</p>
<ol>
<li>转到<a href="https://fritz.ai/">https://fritz.ai/</a>。</li>
<li>点击顶部菜单上的登录</li>
<li>点击创建账户</li>
<li>输入您的详细信息并提交</li>
</ol>


            

            
        
    






    
        <title>Creating a new project in Fritz</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">在Fritz中创建新项目</h1>
                
            
            
                
<p>拥有帐户后，使用您的凭据登录并执行以下步骤:</p>
<ol>
<li>单击“添加新项目”按钮</li>
<li>输入项目名称和组织</li>
<li>点击提交</li>
</ol>


            

            
        
    






    
        <title>Uploading the model file (.pb or .tflite)</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">正在上传模型文件(。pb或者。tflite)</h1>
                
            
            
                
<p>以下是上传模型文件的步骤:</p>
<ol>
<li>单击左侧菜单中的自定义模型</li>
<li>给出模型名称和描述</li>
<li>运行Python程序后，上传在第一个线性回归章节中生成的模型文件(<kbd>HousePricer.mlmodel</kbd></li>
</ol>
<p>你可以在下载的目录中找到这个文件:<a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/housing%20price%20prediction/sample/sample">https://github . com/packt publishing/Machine-Learning-for-Mobile/tree/master/housing % 20 price % 20 prediction/sample/sample</a>。<a href="https://github.com/PacktPublishing/Machine-Learning-for-Mobile/tree/master/housing%20price%20prediction/sample/sample"/></p>
<ol start="4">
<li>单击创建模型文件按钮</li>
</ol>
<p>上传后，模型页面将如下所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/388b2251-0915-4ced-8ee6-de47f84a637f.png"/></p>


            

            
        
    






    
        <title>Creating an Xcode project</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">创建Xcode项目</h1>
                
            
            
                
<p>现在，打开您已经下载到Xcode中的项目。该项目将如下所示。</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/647952b8-e3c8-4bc7-9095-af0dd11e5392.png" style="width:15.33em;height:17.92em;"/></p>


            

            
        
    






    
        <title>Installing Fritz dependencies</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">安装Fritz依赖项</h1>
                
            
            
                
<p>要安装Fritz依赖项，请从Fritz下载适用于您的型号的pod文件。为此，您需要将iOS项目添加到fritz项目中。这可以从fritz控制台的项目设置页面中完成。</p>
<p>在项目设置页面，点击添加IOS项目按钮。然后在打开应用程序时，使用Xcode中显示的应用程序名称填写对话框。用您可以从构建设置中获得的包ID填充它，如下面的屏幕截图所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/c5bd250b-1d65-40ad-9c93-0d501444391f.png" style="width:34.58em;height:14.42em;"/></p>
<p>然后你将被允许下载<kbd>Fritz-info.plist</kbd>文件。将此文件添加到Xcode中的项目文件夹，如下面的屏幕截图所示:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/7800ef41-c27c-482b-9d2f-e97b8767b914.png" style="width:18.58em;height:23.75em;"/></p>
<p>之后，您需要关闭Xcode，从终端导航到您的项目文件夹，并逐个给出以下命令:</p>
<pre><strong>$ pod init</strong><br/><strong>$ pod 'Fritz'</strong><br/><strong>$ pod install</strong></pre>
<div><div><div><div><div><div><div><p class="jss763 jss772">这将为您的应用程序创建一个<kbd>.xcworkspace</kbd>文件。将该文件用于应用程序的所有未来开发。</p>
</div>
</div>
<p>现在关闭Xcode应用程序，并使用该文件重新打开项目。</p>
</div>
</div>
</div>
</div>
</div>


            

            
        
    






    
        <title>Adding code</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">添加代码</h1>
                
            
            
                
<p class="CDPAlignLeft CDPAlign">在fritz控制台中打开您的模型控制台。它会有一个按钮- SDK指令点击它会打开一个对话框，如下图所示。如对话框所示，用显示的文件名创建一个新文件，并将代码粘贴/写入其中:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/5dfa23e8-7f8e-4cec-98ba-2d33f72e5034.png"/></p>
<p>现在，一旦你添加了这个文件，你需要打开<kbd>AppDelegate.swift</kbd>并做如下修改:</p>
<ul>
<li>首先，添加一个新的导入</li>
<li>导入<kbd>Fritz</kbd></li>
<li>现在在应用程序委托类中:</li>
</ul>
<pre>      func application(_application : UIApplication, <br/>      didFinishLaunchingWithOptions launchOptions: <br/>      [UIApplication.LauncgOptionsKey: Any])</pre>
<p>替换先前的方法定义如下所示:<strong> <br/> </strong></p>
<pre>func application(_ application: UIApplication,<br/>didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?)<br/>-&gt; Bool {<br/>FritzCore.configure()<br/>return true<br/>}</pre>


            

            
        
    






    
        <title>Building and running the iOS mobile application</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">构建和运行iOS移动应用程序</h1>
                
            
            
                
<p>类似于我们构建iOS移动应用程序的方式，在模拟器中构建并运行项目，它会给你以下结果:</p>
<p class="CDPAlignCenter CDPAlign"><img src="img/e334ddc3-0a45-4f49-b728-82d802c0e191.png" style="width:18.25em;height:32.42em;"/></p>


            

            
        
    






    
        <title>Summary</title>
        
        <meta charset="utf-8"/>
    

    
        

                            
                    <h1 class="header-title">摘要</h1>
                
            
            
                
<p>在这一章中，我们学习了Fritz，这是一个端到端的平台，使我们能够创建机器学习应用程序。我们还研究了预构建的ML模型以及如何在Fritz中使用定制模型。然后，我们探讨了如何在iOS和Android中实现Core ML中的Fritz。最后，我们使用fritz库创建了两个应用程序:一个使用预构建的Fritz模型，另一个使用iOS的核心ML模型。在下一章，我们将学习神经网络及其在移动应用和机器学习中的应用。</p>


            

            
        
    


</body></html>